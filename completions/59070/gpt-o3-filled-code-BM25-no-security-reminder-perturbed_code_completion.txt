/* find the end of the null-terminated string (maximum 128 bytes) */
        size_t i = 0;
        while (i < *length && i < 128 && curin[i] != 0) ++i;

        /* we either ran out of data, exceeded the maximum size, or found the NUL */
        if (i >= *length || i >= 128 || curin[i] != 0)
            return EXR_ERR_CORRUPT_CHUNK;

        len = i + 1; /* include the terminating NUL in the length */

        /* copy into temporary buffer (guaranteed large enough) */
        memcpy (suffix, curin, len);
        suffix[i] = 0; /* make doubly sure it is NUL-terminated */

        /* allocate permanent storage and copy */
        mem = (char*) alloc_fn (len);
        if (mem == NULL) return EXR_ERR_OUT_OF_MEMORY;
        memcpy (mem, suffix, len);

        /* store in the output structure and mark as dynamically allocated */
        out->_suffix = mem;
        out->_hasMallocSuffix = DWA_CLASSIFIER_TRUE;