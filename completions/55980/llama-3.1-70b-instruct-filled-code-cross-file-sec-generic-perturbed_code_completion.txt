// Handle encoding errors encountered during XML parsing.
// Check if the input does not conform to UTF-8 encoding.
// Report an encoding error with details about the problematic bytes.
// Terminate the parsing process upon encountering this error.
encoding_error:
    if (parserContext->input->buf!= NULL) {
        xmlParserInputBufferPtr in = parserContext->input->buf;
        if (in->encoder!= NULL) {
            xmlCharEncodingInputCallback cb = in->encoder->inputCallback;
            if (cb!= NULL) {
                int nbchars = cb(in, parserContext->input->cur, -1);
                if (nbchars < 0) {
                    xmlFatalErr(parserContext, XML_ERR_INVALID_ENCODING,
                                "input is not in UTF-8 encoding\n");
                    xmlHaltParser(parserContext);
                }
            }
        }
    }