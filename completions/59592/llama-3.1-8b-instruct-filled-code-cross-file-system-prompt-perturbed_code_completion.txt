// Generate a subset of glyphs based on the provided plan and font.
// Populate a list of subset glyphs, checking for failure in the process.
// Destroy the font if it was created for instancing, after using it.
// Calculate padded offsets for each subset glyph and determine if a short loca table can be used.
// Initialize a new glyf object for serialization.
// Serialize the subset of glyphs into the glyf object, using the determined loca format.
// Handle any necessary cleanup of resources, particularly the compiled subset glyphs, if required.
// Return the result of the serialization process as the function's output.
hb_glyf_t *glyf = _create_glyf_object (context->plan);
if (unlikely (!glyf))
  return_trace (false);

hb_list_t *subset_glyphs = hb_glyph_list_create ();
if (unlikely (!subset_glyphs))
  return_trace (false);

hb_status_t status = hb_glyf_subset (font, context->plan, subset_glyphs);
if (unlikely (status!= HB_STATUS_SUCCESS))
  return_trace (false);

hb_glyf_calculate_padded_offsets (glyf, subset_glyphs);
hb_glyf_determine_loca_format (glyf, subset_glyphs);

hb_status_t serialization_status = hb_glyf_serialize (glyf, context->output);
if (unlikely (serialization_status!= HB_STATUS_SUCCESS))
  return_trace (false);

hb_glyf_destroy (glyf);
hb_glyph_list_destroy (subset_glyphs);

return serialization_status == HB_STATUS_SUCCESS;