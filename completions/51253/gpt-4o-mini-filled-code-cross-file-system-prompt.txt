for (i = 0; i < rounds + 1; i++) {
        if (i < KC + 1) {
            a->round_key[i].u32[0] = ((uint32_t *)tk)[i];
        } else {
            uint32_t temp = a->round_key[i - 1].u32[3];
            if (i % KC == 0) {
                temp = (temp >> 8) | (temp << 24);
                temp = sbox[temp & 0xff] | (sbox[(temp >> 8) & 0xff] << 8) |
                       (sbox[(temp >> 16) & 0xff] << 16) | (sbox[(temp >> 24) & 0xff] << 24);
                temp ^= rcon[rconpointer++];
            } else if (KC > 6 && i % KC == 4) {
                temp = sbox[temp & 0xff] | (sbox[(temp >> 8) & 0xff] << 8) |
                       (sbox[(temp >> 16) & 0xff] << 16) | (sbox[(temp >> 24) & 0xff] << 24);
            }
            a->round_key[i].u32[0] = a->round_key[i - KC].u32[0] ^ temp;
        }
        for (j = 1; j < 4; j++) {
            a->round_key[i].u32[j] = a->round_key[i].u32[j - 1] ^ a->round_key[i - KC].u32[j];
        }
    }