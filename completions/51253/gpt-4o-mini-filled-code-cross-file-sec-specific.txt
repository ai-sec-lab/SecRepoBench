for (i = 0; i < rounds; i++) {
        uint8_t temp[4];
        memcpy(temp, &tk[i % KC], 4);
        // Perform key expansion
        if (i % KC == 0) {
            // Apply the S-box and Rcon for the first word of each round key
            temp[0] = sbox[temp[1]] ^ rcon[rconpointer++];
            temp[1] = sbox[temp[2]];
            temp[2] = sbox[temp[3]];
            temp[3] = sbox[temp[0]];
        }
        for (j = 0; j < 4; j++) {
            a->round_key[i].u8[j] = a->round_key[i - KC].u8[j] ^ temp[j];
        }
    }