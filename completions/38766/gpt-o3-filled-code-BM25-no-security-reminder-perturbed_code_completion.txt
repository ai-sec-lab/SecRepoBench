/* Read 9 initial bytes: 2 (magic1) + 2 (magic2/prop-size) + 5 (props). */
	lzma_stream_pointer =
	    (const uint8_t *)__archive_read_ahead(a, 9, NULL);
	if (lzma_stream_pointer == NULL) {
		archive_set_error(&a->archive, ARCHIVE_ERRNO_FILE_FORMAT,
		    "Truncated lzma header in ZIPX stream");
		return (ARCHIVE_FATAL);
	}

	/* The second 2-byte field must indicate that exactly 5 property
	 * bytes follow.  Reject the stream if this is not the case. */
	if (archive_le16dec(lzma_stream_pointer + 2) != 5) {
		archive_set_error(&a->archive, ARCHIVE_ERRNO_FILE_FORMAT,
		    "Invalid lzma header in ZIPX stream (prop-size=%u)",
		    (unsigned)archive_le16dec(lzma_stream_pointer + 2));
		return (ARCHIVE_FAILED);
	}