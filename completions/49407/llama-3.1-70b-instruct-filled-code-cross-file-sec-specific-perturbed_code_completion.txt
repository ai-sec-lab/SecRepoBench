for (unsigned int i = 0; i < effectiveaxiscount; ++i)
{
    coords[i] = map->apply (coords[i]);
    map++;
}

if (version >= 2)
{
    float *output = new float[effectiveaxiscount];
    VariationStore *store = new VariationStore (variationData);
    VariationIndexMap *indexMap = new VariationIndexMap (variationIndexMapData);

    for (unsigned int i = 0; i < effectiveaxiscount; ++i)
    {
        float delta = indexMap->getDelta (store, coords[i]);
        output[i] = coords[i] + round (delta);
        output[i] = hb_min (output[i], maxCoord);
        output[i] = hb_max (output[i], minCoord);
    }

    delete store;
    delete indexMap;

    for (unsigned int i = 0; i < effectiveaxiscount; ++i)
    {
        coords[i] = output[i];
    }

    delete[] output;
}