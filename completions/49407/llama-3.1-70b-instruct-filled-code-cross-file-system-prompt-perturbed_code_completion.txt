for (unsigned int i = 0; i < effectiveaxiscount; ++i)
{
  coords[i] = map->apply (coords[i]);
  map++;
}

if (version >= 2)
{
  float *output = new float[coords_length];
  VariationStore *store = new VariationStore (this);
  for (unsigned int i = 0; i < coords_length; ++i)
  {
    float delta = store->getDelta (coords[i], variationIndexMap);
    output[i] = hb_clamp (coords[i] + round (delta), min, max);
  }
  delete store;
  for (unsigned int i = 0; i < coords_length; ++i)
  {
    coords[i] = output[i];
  }
  delete[] output;
}