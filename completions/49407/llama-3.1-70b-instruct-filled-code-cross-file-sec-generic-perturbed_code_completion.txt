for (unsigned int i = 0; i < effectiveaxiscount; ++i)
{
    coords[i] = map->apply (coords[i]);
    map++;
}

if (version >= 2)
{
    float *output = new float[coords_length];
    VariationStore *store = new VariationStore (this);
    VariationIndexMap *indexMap = &firstAxisVariationIndexMaps;

    for (unsigned int i = 0; i < coords_length; ++i)
    {
        float delta = indexMap->apply (coords[i], store);
        output[i] = coords[i] + roundf (delta);
        output[i] = hb_clamp (output[i], min, max);
        indexMap++;
    }

    delete store;
    for (unsigned int i = 0; i < coords_length; ++i)
    {
        coords[i] = output[i];
    }
    delete[] output;
}