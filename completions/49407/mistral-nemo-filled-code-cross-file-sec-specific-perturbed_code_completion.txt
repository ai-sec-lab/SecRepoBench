for (unsigned int i = 0; i < effectiveaxiscount; ++i) {
  coords[i] = map->apply(coords[i]);
  map++;
}

if (version >= 2) {
  std::vector<int> output(coords_length);
  VariationStoreCache variationStoreCache = getVariationStoreCache();

  for (unsigned int i = 0; i < effectiveaxiscount; ++i) {
    int variationIndex = variationStoreCache.getVariationIndex(i);
    int delta = variationStoreCache.getVariationData(variationIndex);
    int transformed = coords[i] + round(delta);
    transformed = std::max(std::min(transformed, maxValue), minValue);
    output[i] = transformed;
  }

  coords_length = output.size();
  coords = output.data();
  delete variationStoreCache;
}