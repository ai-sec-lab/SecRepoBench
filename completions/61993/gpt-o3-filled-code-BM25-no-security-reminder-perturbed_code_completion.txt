size_t new_len;
				char *new_buf;

				/* If we don't have a stream (e.g. str_getcsv()) we can't
				 * fetch more data – treat this as an unterminated enclosure
				 * and finish processing the current buffer. */
				if (csv_stream == NULL) {
					/* Force end-of-data for the current line */
					bptr   = limit;
					inc_len = 0;
					goto quit_loop_2;
				}

				/* Try to grab the next line from the stream so we can
				 * continue parsing the (so far) unterminated enclosure.  */
				new_buf = php_stream_get_line(csv_stream, NULL, 0, &new_len);

				/* If we failed to read a new line we reached EOF while still
				 * inside an enclosure – treat this as an unterminated
				 * enclosure and stop parsing. */
				if (new_buf == NULL) {
					bptr   = limit;
					inc_len = 0;
					goto quit_loop_2;
				}