const char *s0 = xs;
  const char *t0 = ys;
  bitint a, b, x, y;

  if (m > n) return -1;

  /* preprocess */
  x = *s0;
  y = 1;
  {
    int i;
    for (i=1; i<m; i++) {
      x |= (bitint)*(s0+i) << i*8;
      y |= (bitint)1 << i*8;
    }
  }

  /* search */
  int i = 0;
  bitint mask = (bitint)((long long)MASK1 << (m - 1) * 8);
  for (; i < n - m + 1; ++i, ++t0) {
    a = *(bitint*)t0 ^ x;
    b = a & MASK2;
    b += b >> 7;
    b &= MASK1;
    if (b == 0) {
      return i;
    }
  }