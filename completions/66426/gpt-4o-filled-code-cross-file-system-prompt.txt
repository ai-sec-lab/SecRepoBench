const char *s0 = ys;
  const char *s1 = xs;
  bitint v, eq, diff;
  long i;

  if (m > n) return -1;
  if (m == 0) return 0;

  v = *(const bitint*)s1;
  v = (v & MASK2) + MASK1;
  for (i = 0; i <= n - m; i++) {
    eq = *(const bitint*)(s0 + i) ^ v;
    diff = (eq - MASK1) & ~eq & MASK3;
    if (diff == 0) {
      if (memcmp(s0 + i + sizeof(bitint), s1 + sizeof(bitint), m - sizeof(bitint)) == 0) {
        return i;
      }
    }
  }