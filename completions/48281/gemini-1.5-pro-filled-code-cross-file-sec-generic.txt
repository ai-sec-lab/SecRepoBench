int second_field_offset, ret;

    if (buf_size < 4) {
        return AVERROR_INVALIDDATA;
    }
    if (avctx->width <= 0 || avctx->height <= 0) {
        return AVERROR_INVALIDDATA;
    }

    quality = buf[0];