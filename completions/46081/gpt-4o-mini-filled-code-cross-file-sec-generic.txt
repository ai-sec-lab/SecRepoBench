// Calculate the size of the quantum pixel buffer based on the image dimensions,
  // number of pixel channels, and quantum depth. The computation determines the
  // `quantum` variable by considering the number of pixel channels, padding, and
  // quantum depth, accounting for byte alignment. The `extent` is then calculated
  // as the product of the maximum of the image's columns and rows, and the 
  // `quantum` to ensure sufficient memory allocation for the pixel buffer.

  // Determine the number of channels based on the image's colorspace
  size_t channels = GetPixelChannels(image);
  
  // Calculate quantum size based on depth and channels
  quantum = (quantum_info->depth * channels + 7) / 8; // Round up to nearest byte

  // Calculate the extent of the pixel buffer
  extent = MagickMax(image->columns, image->rows) * quantum;

  // Ensure that extent is not zero to avoid division by zero later
  if (extent == 0) {
    extent = 1; // Set to 1 to avoid division by zero
  }