{
  /* At this point we know that either the source or destination port
     is the CAPWAP control port and that the first payload byte is 0x0
     (normal packet) or 0x1 (fragmented packet).  The CAPWAP header
     carries the message length in network-byte-order starting at byte 6.
     Depending on the first byte we have to add the size of the header
     itself (8 bytes when the ‘F’ bit is 0, 12 bytes when it is 1) to
     obtain the total packet length. */
  u_int8_t  first_byte = flow_packet->payload[0];
  u_int16_t msg_len    = ntohs(*(u_int16_t *)&flow_packet->payload[6]);
  u_int32_t total_len  = msg_len + ((first_byte == 0x0) ? 8 : 12);

  if(total_len == flow_packet->payload_packet_len)
    goto capwap_found;
}