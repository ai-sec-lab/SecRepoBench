if (mpz_sgn(y) == 0) {
  *v = 0;
  return TRUE;
}

if (y->sn > 2 || (y->sn == 2 && y->p[1] > 1)) {
  return FALSE;
}

mrb_int i = 0;
if (mpz_sgn(y) == -1) {
  i = -1;
}

for (size_t j = 0; j < y->sn; j++) {
  i = (i << DIGITBITS) | y->p[j];
}

if (i < MRB_INT_MIN || i > MRB_INT_MAX) {
  return FALSE;
}

*v = i;
return TRUE;