while (p < end && *p >= '0' && *p <= '9') {
  if (next_n > (MRB_INT_MAX - (*p - '0')) / 10) {
    mrb_raise(mrb, E_RANGE_ERROR, "integer overflow");
  }
  next_n = next_n * 10 + (*p - '0');
  p++;
}