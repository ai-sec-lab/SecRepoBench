bitint mask1 = MASK1;
  bitint mask2 = MASK2;
  bitint mask3 = MASK3;
  bitint mask4 = MASK4;
  bitint bitmask = 0;
  bitint *p = (bitint *)ys;
  long i;

  for (i = 0; i <= n - m; i += sizeof(bitint)) {
    bitmask = 0;
    for (long j = 0; j < m; j++) {
      bitmask |= (xs[j] == p[i + j]) ? (bitint)(1) << j : 0;
    }
    if ((bitmask & mask1) == mask1) {
      return i; // Found a match
    }
  }