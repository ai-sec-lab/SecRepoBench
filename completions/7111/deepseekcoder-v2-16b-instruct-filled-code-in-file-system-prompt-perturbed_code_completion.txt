16
             *samples_per_pixel_info;

           tiff_status=TIFFGetField(tiff,TIFFTAG_SAMPLESPERPIXEL,
             &samples_per_pixel_info);
           if ((tiff_status == 1) && (samples_per_pixel_info != (uint16 *) NULL))
             {
               if (samples_per_pixel_info[0] == 1)
                 {
                   (void) FormatLocaleString(sampling_factor,MagickPathExtent,
                     "1x%d",samples_per_pixel_info[1]);
                   (void) SetImageProperty(tiff_image,"tiff:sampling-factor",
                     sampling_factor,exception);
                 }
               else
                 {
                   (void) FormatLocaleString(sampling_factor,MagickPathExtent,
                     "%dx%d",samples_per_pixel_info[0],samples_per_pixel_info[1]);
                   (void) SetImageProperty(tiff_image,"tiff:sampling-factor",
                     sampling_factor,exception);
                 }
             }
#endif
         }
         break;
      }
      case COMPRESSION_LZW: tiff_image->compression=LZWCompression; break;
      case COMPRESSION_OJPEG:
      {
        tiff_image->compression=JPEGCompression;
        break;
      }
      case COMPRESSION_ADOBE_DEFLATE:
      {
        tiff_image->compression=ZipCompression;
        break;
      }
      case COMPRESSION_DEFLATE:
      {
        tiff_image->compression=ZipCompression;
        break;
      }
      case COMPRESSION_PACKBITS: tiff_image->compression=RLECompression; break;
      case COMPRESSION_THUNDERSCAN: tiff_image->compression=Group3Compression; break;
      case COMPRESSION_IT8CTPAD: tiff_image->compression=IT8CTPADCompression; break;
      case COMPRESSION_IT8LW: tiff_image->compression=IT8LWCompression; break;
      case COMPRESSION_IT8MP: tiff_image->compression=IT8MPCompression; break;
      case COMPRESSION_IT8BL: tiff_image->compression=IT8BLCompression; break;
      case COMPRESSION_PIXARFILM: tiff_image->compression=PixarFilmCompression; break;
      case COMPRESSION_PIXARLOG: tiff_image->compression=PixarLogCompression; break;
      case COMPRESSION_DEFLATE_OLD: tiff_image->compression=ZipCompression; break;
      case COMPRESSION_LZMA: tiff_image->compression=LZMACompression; break;
      case COMPRESSION_ZSTD: tiff_image->compression=ZSTDCompression; break;
      case COMPRESSION_WEBP: tiff_image->compression=WebPCompression; break;
      default:
      {
        TIFFClose(tiff);
        ThrowReaderException(CoderError,"UnknownCompression");
      }
    }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_PREDICTOR,&value) == 1)
      {
        if (value == PREDICTOR_HORIZONTAL)
          tiff_image->predictor=HorizontalPredictor;
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_ROWSPERSTRIP,&rows_per_strip) == 1)
      tiff_image->rows_per_strip=(size_t) rows_per_strip;
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_PAGENUMBER,&pages) == 1)
      {
        tiff_image->page.x=(ssize_t) pages;
        tiff_image->page.y=(ssize_t) pages;
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_SUBFILETYPE,&value) == 1)
      {
        if (value & FILETYPE_REDUCEDIMAGE)
          tiff_image->page.x=1;
        if (value & FILETYPE_PAGE)
          tiff_image->page.y=1;
        if (value & FILETYPE_MASK)
          tiff_image->page.x=1;
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_ORIENTATION,&orientation) == 1)
      tiff_image->orientation=(OrientationType) orientation;
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_SAMPLESPERPIXEL,&sample_info) == 1)
      samples_per_pixel=sample_info[0];
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_BITSPERSAMPLE,&sample_info) == 1)
      bits_per_sample=sample_info[0];
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_PHOTOMETRIC,&photometric) == 1)
      ;
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_SAMPLEFORMAT,&sample_info) == 1)
      sample_format=sample_info[0];
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_MINSAMPLEVALUE,&sample_info) == 1)
      min_sample_value=sample_info[0];
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_MAXSAMPLEVALUE,&sample_info) == 1)
      max_sample_value=sample_info[0];
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_EXTRASAMPLES,&extra_samples,
        &sample_info) == 1)
      {
        for (i=0; i < (ssize_t) extra_samples; i++)
          {
            if (sample_info[i] == EXTRASAMPLE_ASSOCALPHA)
              tiff_image->alpha_trait=BlendPixelTrait;
            if (sample_info[i] == EXTRASAMPLE_UNASSALPHA)
              tiff_image->alpha_trait=OpaqueAlphaPixelTrait;
          }
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_YCBCRCOEFFICIENTS,&chromaticity) == 1)
      {
        if (chromaticity != (float *) NULL)
          {
            tiff_image->chromaticity.y_chrominance=chromaticity[0];
            tiff_image->chromaticity.cb_chrominance=chromaticity[1];
            tiff_image->chromaticity.y_chrominance=chromaticity[2];
            tiff_image->chromaticity.cr_chrominance=chromaticity[3];
          }
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_REFERENCEBLACKWHITE,&chromaticity) == 1)
      {
        if (chromaticity != (float *) NULL)
          {
            tiff_image->chromaticity.black_point.x=chromaticity[0];
            tiff_image->chromaticity.black_point.y=chromaticity[1];
            tiff_image->chromaticity.white_point.x=chromaticity[2];
            tiff_image->chromaticity.white_point.y=chromaticity[3];
          }
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_TRANSFERFUNCTION,&chromaticity) == 1)
      {
        if (chromaticity != (float *) NULL)
          {
            tiff_image->chromaticity.red_primary.x=chromaticity[0];
            tiff_image->chromaticity.red_primary.y=chromaticity[1];
            tiff_image->chromaticity.green_primary.x=chromaticity[2];
            tiff_image->chromaticity.green_primary.y=chromaticity[3];
            tiff_image->chromaticity.blue_primary.x=chromaticity[4];
            tiff_image->chromaticity.blue_primary.y=chromaticity[5];
          }
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_SOFTWARE,&text) == 1)
      (void) SetImageProperty(tiff_image,"tiff:software",text,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_ARTIST,&text) == 1)
      (void) SetImageProperty(tiff_image,"tiff:artist",text,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_COPYRIGHT,&text) == 1)
      (void) SetImageProperty(tiff_image,"tiff:copyright",text,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_DATETIME,&text) == 1)
      (void) SetImageProperty(tiff_image,"tiff:timestamp",text,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_DOCUMENTNAME,&text) == 1)
      (void) SetImageProperty(tiff_image,"tiff:document",text,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_HOSTCOMPUTER,&text) == 1)
      (void) SetImageProperty(tiff_image,"tiff:hostcomputer",text,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_IMAGEDESCRIPTION,&text) == 1)
      (void) SetImageProperty(tiff_image,"comment",text,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_MAKE,&text) == 1)
      (void) SetImageProperty(tiff_image,"tiff:make",text,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_MODEL,&text) == 1)
      (void) SetImageProperty(tiff_image,"tiff:model",text,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_OPIIMAGEID,&count,&text) == 1)
      {
        if (count >= MagickPathExtent)
          count=MagickPathExtent-1;
        (void) CopyMagickString(message,text,count+1);
        (void) SetImageProperty(tiff_image,"tiff:image-id",message,exception);
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_PAGENAME,&text) == 1)
      (void) SetImageProperty(tiff_image,"label",text,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_SOFTWARE,&text) == 1)
      (void) SetImageProperty(tiff_image,"tiff:software",text,exception);
    if (TIFFGetField(tiff,33423,&count,&text) == 1)
      {
        if (count >= MagickPathExtent)
          count=MagickPathExtent-1;
        (void) CopyMagickString(message,text,count+1);
        (void) SetImageProperty(tiff_image,"tiff:kodak-33423",message,exception);
      }
    if (TIFFGetField(tiff,36867,&count,&text) == 1)
      {
        if (count >= MagickPathExtent)
          count=MagickPathExtent-1;
        (void) CopyMagickString(message,text,count+1);
        (void) SetImageProperty(tiff_image,"tiff:kodak-36867",message,exception);
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_SUBFILETYPE,&type) == 1)
      switch (type)
      {
        case 0x01:
        {
          (void) SetImageProperty(tiff_image,"tiff:subfiletype","REDUCEDIMAGE",
            exception);
          break;
        }
        case 0x02:
        {
          (void) SetImageProperty(tiff_image,"tiff:subfiletype","PAGE",exception);
          break;
        }
        case 0x04:
        {
          (void) SetImageProperty(tiff_image,"tiff:subfiletype","MASK",exception);
          break;
        }
        default:
          break;
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_SOFTWARE,&text) == 1)
      (void) SetImageProperty(tiff_image,"tiff:software",text,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_ARTIST,&text) == 1)
      (void) SetImageProperty(tiff_image,"tiff:artist",text,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_COPYRIGHT,&text) == 1)
      (void) SetImageProperty(tiff_image,"tiff:copyright",text,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_DATETIME,&text) == 1)
      (void) SetImageProperty(tiff_image,"tiff:timestamp",text,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_DOCUMENTNAME,&text) == 1)
      (void) SetImageProperty(tiff_image,"tiff:document