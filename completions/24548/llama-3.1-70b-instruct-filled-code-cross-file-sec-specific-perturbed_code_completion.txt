unsigned tail_length = c->length () - initial_table_position;
unsigned record_len = src_tbl->record.len;
unsigned offset = 0;

for (int i = 0; i < record_len; i++)
{
  unsigned record_offset = obj_indices[i].first;
  if (record_offset > tail_length)
    break;
  c->set_uint16_at_offset (offset, record_offset);
  offset += 2;
}

c->set_uint16_at_offset (initial_table_position + 2, record_len);
c->set_uint16_at_offset (initial_table_position + 4, tail_length);