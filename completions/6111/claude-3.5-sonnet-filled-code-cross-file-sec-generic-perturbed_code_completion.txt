MagickBooleanType
  status;

unsigned char
  *pixels;

unsigned int
  columns,
  rows;

ssize_t
  i;

size_t
  length;

image=AcquireImage(image_info,exception);
if (image == (Image *) NULL)
  return((Image *) NULL);
if ((image->columns == 0) || (image->rows == 0))
  ThrowReaderException(ImageError,"NegativeOrZeroImageSize");
status=OpenBlob(image_info,image,ReadBinaryBlobMode,exception);
if (status == MagickFalse)
  return(DestroyImageList(image));
/*
  Read Postscript image.
*/
read_info=CloneImageInfo(image_info);
SetImageInfoBlob(read_info,(void *) NULL,0);
(void) CopyMagickString(read_info->magick,"PS",MagickPathExtent);
postscript_image=ReadImage(read_info,exception);
read_info=DestroyImageInfo(read_info);
if (postscript_image == (Image *) NULL)
  return(DestroyImageList(image));
(void) CloseBlob(image);
AppendImageToList(&image,postscript_image);
length=0;
columns=0;
rows=0;
for (c=ReadBlobByte(image); c != EOF; c=ReadBlobByte(image))
{
  if (isdigit((int) ((unsigned char) c)) == 0)
    continue;
  if (length >= MagickPathExtent)
    ThrowReaderException(CoderError,"InputLineTooLong");
  command[length++]=(char) c;
  if (length < 3)
    continue;
  if (LocaleNCompare(command,"%%BoundingBox:",14) == 0)
    {
      (void) sscanf(command,"%%%%BoundingBox: %d %d %u %u",&bounding_box.x,
        &bounding_box.y,&columns,&rows);
      break;
    }
}
if ((columns == 0) || (rows == 0))
  ThrowReaderException(CorruptImageError,"ImproperImageHeader");
image->columns=columns;
image->rows=rows;
pixels=(unsigned char *) AcquireQuantumMemory(image->columns,4*
  sizeof(*pixels));
if (pixels == (unsigned char *) NULL)
  ThrowReaderException(ResourceLimitError,"MemoryAllocationFailed");
for (i=0; i < (ssize_t) image->rows; i++)
{
  ssize_t
    count;

  count=ReadBlob(image,4*image->columns,pixels);
  if (count != (ssize_t) (4*image->columns))
    break;
  (void) ImportQuantumPixels(image,(CacheView *) NULL,quantum_info,
    RGBAQuantum,pixels,exception);
  if (SyncAuthenticPixels(image,exception) == MagickFalse)
    break;
}
pixels=(unsigned char *) RelinquishMagickMemory(pixels);
if (i < (ssize_t) image->rows)
  ThrowReaderException(CorruptImageError,"UnableToReadImageData");