image=AcquireImage(image_info,exception);
if (image == (Image *) NULL)
  return((Image *) NULL);
(void) CopyMagickString(image->filename,image_info->filename,MagickPathExtent);
(void) SetImageInfo(image_info,0,exception);
if (*image_info->magick == '\0')
  (void) CopyMagickString(image->magick,PostscriptDelegateDefault,MagickPathExtent);
else
  (void) CopyMagickString(image->magick,image_info->magick,MagickPathExtent);
(void) CopyMagickString(filename,image_info->filename,MagickPathExtent);
(void) CopyMagickString(postscript_filename,image_info->filename,MagickPathExtent);
if (LocaleCompare(image_info->magick,"EPT") == 0)
  {
    (void) CopyMagickString(postscript_filename,EightBimToPostscript,MagickPathExtent);
    image_info->adjoin=MagickFalse;
  }
if ((LocaleCompare(image_info->magick,"EPI") == 0) ||
    (LocaleCompare(image_info->magick,"EPS") == 0) ||
    (LocaleCompare(image_info->magick,"EPSI") == 0) ||
    (LocaleCompare(image_info->magick,"PS") == 0))
  {
    (void) CopyMagickString(postscript_filename,PSDelegate,MagickPathExtent);
    if (LocaleCompare(image_info->magick,"PS") == 0)
      (void) CopyMagickString(image->magick,"PS",MagickPathExtent);
  }
/*
  Create temporary files for PS input and output.
*/
file=AcquireUniqueFileResource(input_filename);
if (file == -1)
  {
    ThrowFileException(exception,FileOpenError,"UnableToCreateTemporaryFile",
      image_info->filename);
    image=DestroyImage(image);
    return((Image *) NULL);
  }
(void) close(file);
(void) CopyMagickString(filename,image_info->filename,MagickPathExtent);
(void) AcquireUniqueFilename(postscript_filename);
delegate_info=GetDelegateInfo(postscript_filename,"*",&image->exception);
if (delegate_info == (const DelegateInfo *) NULL)
  {
    (void) RelinquishUniqueFileResource(input_filename);
    (void) RelinquishUniqueFileResource(postscript_filename);
    ThrowFileException(exception,DelegateError,"NoPostscriptDelegate",
      image_info->filename);
    image=DestroyImage(image);
    return((Image *) NULL);
  }
/*
  Open image file.
*/
(void) AcquireUniqueFilename(filename);
(void) CopyMagickString(image->filename,filename,MagickPathExtent);
unique_file=AcquireUniqueFileResource(filename);
if (unique_file == -1)
  {
    ThrowFileException(exception,FileOpenError,"UnableToCreateTemporaryFile",
      image->filename);
    image=DestroyImage(image);
    return((Image *) NULL);
  }