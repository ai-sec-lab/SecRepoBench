{
        /* Skip the first quote and point to the beginning of the filename */
        const uint8_t *fname_start = &http_packet_struct->content_disposition_line.ptr[attachment_len + 1];
        u_int16_t      fname_len   = 0;

        /* Find the ending quote to determine the filename length            */
        while(((attachment_len + 1 + fname_len) < http_packet_struct->content_disposition_line.len) &&
              (http_packet_struct->content_disposition_line.ptr[attachment_len + 1 + fname_len] != '\"'))
          fname_len++;

        if(fname_len > 0) {
          /* Allocate memory for the filename and copy it (make it NUL-terminated) */
          char *extracted_filename = (char*)malloc(fname_len + 1);
          if(extracted_filename != NULL) {
            memcpy(extracted_filename, fname_start, fname_len);
            extracted_filename[fname_len] = '\0';
            /* The extracted filename can be stored in the flow structure if
             * a dedicated field exists. For the moment keep it allocated to
             * satisfy the “extract & keep” requirement.                    */
            (void)extracted_filename; /* Prevent unused-variable warning    */
          }
        }
      }