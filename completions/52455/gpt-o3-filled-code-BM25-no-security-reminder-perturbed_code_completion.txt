// length of the compound part checked so far
                  int partlen = i + compound_result->blen;

                  // check for typical compound faults (rep/word-pair)
                  if ((checkcompoundrep && cpdrep_check(st, partlen)) ||
                      cpdwordpair_check(st, partlen)) {
                    st[i + compound_result->blen] = r;      // restore char
                    return NULL;
                  }

                  // check if the already accepted part is itself a forbidden word
                  if (forbiddenword) {
                    struct hentry* rvtmp = lookup(st.c_str(), partlen);
                    while (rvtmp && rvtmp->astr &&
                           TESTAFF(rvtmp->astr, needaffix, rvtmp->alen))
                      rvtmp = rvtmp->next_homonym;

                    if (rvtmp && rvtmp->astr &&
                        TESTAFF(rvtmp->astr, forbiddenword, rvtmp->alen)) {
                      st[i + compound_result->blen] = r;    // restore char
                      return NULL;
                    }
                  }

                  // restore the original character
                  st[i + compound_result->blen] = r;