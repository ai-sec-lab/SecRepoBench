/* Retrieve the rest of the fixedâ€“size fields in the header
     converting them from big-endian (as stored in the frame) to the
     host byte order.  Only convert fields whose destination pointer
     is not NULL so that the caller can request just the information
     it is interested in. */

  if (frame_len != NULL) {
    from_big(frame_len, frame_pointer + FRAME_LEN, sizeof(*frame_len));
  }
  if (nbytes != NULL) {
    from_big(nbytes, frame_pointer + FRAME_NBYTES, sizeof(*nbytes));
  }
  if (cbytes != NULL) {
    from_big(cbytes, frame_pointer + FRAME_CBYTES, sizeof(*cbytes));
  }
  if (blocksize != NULL) {
    from_big(blocksize, frame_pointer + FRAME_BLOCKSIZE, sizeof(*blocksize));
  }
  if (chunksize != NULL) {
    from_big(chunksize, frame_pointer + FRAME_CHUNKSIZE, sizeof(*chunksize));
  }
  if (typesize != NULL) {
    from_big(typesize, frame_pointer + FRAME_TYPESIZE, sizeof(*typesize));
  }

  /* Sanity checks */
  if (*header_len < FRAME_HEADER_MINLEN) {
    BLOSC_TRACE_ERROR("Header length smaller than the minimum allowed.");
    return BLOSC2_ERROR_INVALID_HEADER;
  }

  if (frame->cframe != NULL && frame->len > 0 && *header_len > frame->len) {
    BLOSC_TRACE_ERROR("Header length exceeds frame size.");
    return BLOSC2_ERROR_INVALID_HEADER;
  }

  if (frame_len != NULL && *frame_len < 0) {
    BLOSC_TRACE_ERROR("Invalid (negative) frame length.");
    return BLOSC2_ERROR_INVALID_HEADER;
  }
  if (nbytes != NULL && *nbytes < 0) {
    BLOSC_TRACE_ERROR("Invalid (negative) uncompressed size in header.");
    return BLOSC2_ERROR_INVALID_HEADER;
  }
  if (cbytes != NULL && *cbytes < 0) {
    BLOSC_TRACE_ERROR("Invalid (negative) compressed size in header.");
    return BLOSC2_ERROR_INVALID_HEADER;
  }
  if (blocksize != NULL && *blocksize <= 0) {
    BLOSC_TRACE_ERROR("Invalid block size in header.");
    return BLOSC2_ERROR_INVALID_HEADER;
  }
  if (chunksize != NULL && *chunksize <= 0) {
    BLOSC_TRACE_ERROR("Invalid chunk size in header.");
    return BLOSC2_ERROR_INVALID_HEADER;
  }
  if (typesize != NULL && *typesize <= 0) {
    BLOSC_TRACE_ERROR("Invalid type size in header.");
    return BLOSC2_ERROR_INVALID_HEADER;
  }