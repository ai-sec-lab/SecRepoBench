/* Try to extract a USER name (if present) and mark clear-text credentials */
        if(packet->payload_packet_len > 5 && memcmp(packet->payload, "USER ", 5) == 0) {
          char irc_username[64];
          u_int16_t uname_len = 0;
          const u_int8_t *usr_ptr = (const u_int8_t *)&packet->payload[5];

          /* Copy the username until we meet a space or line terminator */
          while((5 + uname_len) < packet->payload_packet_len &&
                uname_len < (sizeof(irc_username) - 1) &&
                usr_ptr[uname_len] != ' '  &&
                usr_ptr[uname_len] != '\r' &&
                usr_ptr[uname_len] != '\n') {
            irc_username[uname_len] = usr_ptr[uname_len];
            uname_len++;
          }
          irc_username[uname_len] = '\0';

          if(uname_len > 0) {
            NDPI_LOG_INFO(detection_module, "IRC USER detected: %s", irc_username);
            /* Clear-text credentials observed */
            ndpi_risk_add_event(detection_module, flow, NDPI_CLEAR_TEXT_CREDENTIALS);
          }
        }

        NDPI_LOG_DBG2(detection_module, "IRC keyword (USER/NICK/PASS/NOTICE/PRIVMSG) detected at least once.");