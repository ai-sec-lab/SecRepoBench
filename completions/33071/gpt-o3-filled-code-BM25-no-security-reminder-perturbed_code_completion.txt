// The marker for the metalayer content must indicate a 32-bit length blob.
    // Accept both MsgPack BIN32 (0xc6) and STR32 (0xdb) just in case.
    if ((*content_marker != 0xc6u) && (*content_marker != 0xdbu)) {
      return BLOSC2_ERROR_DATA;         // Unknown or unexpected marker
    }

    // Read the content length (big-endian uint32 right after the marker)
    uint32_t content_len;
    from_big(&content_len, content_marker + 1, sizeof(content_len));

    // Bounds check: marker (1 byte) + len (4 bytes) + payload
    if (offset + 1 + 4 + (int64_t)content_len > trailer_len) {
      return BLOSC2_ERROR_READ_BUFFER;
    }

    layer_metadata->content_len = (int32_t)content_len;

    // Allocate space for the payload and copy it