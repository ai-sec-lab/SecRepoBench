// Validate the 'size' field to ensure it is not less than 8
        if (size < 8) {
            return 0; // Invalid size, return failure
        }

        // Check if the buffer has enough data as indicated by 'size'
        if (i + size > p->buf_size) {
            return 0; // Not enough data in the buffer, return failure
        }

        // Increment the index 'i' by 8 to move past the header
        i += 8;