/* the chunk header must contain at least the 8-byte tag+size */
        if (length < 8)
            return 0;

        /* make sure the whole declared chunk is present in the buffer */
        if (length > p->buf_size - i)
            return 0;

        /* skip the 8-byte chunk header */
        i += 8;