#ifdef MRB_USE_BIGINT
  /* If either operand is a BigInt, use the BigInt comparison routine. */
  if (mrb_bigint_p(v1) || mrb_bigint_p(value)) {
    return mrb_bint_cmp(mrb, v1, value);
  }
#endif

/* Choose working numeric type depending on float support. */
#ifndef MRB_NO_FLOAT
  mrb_float x, y;
#else
  mrb_int x, y;
#endif

/* Convert the first value (v1) into the working numeric type. */
  switch (mrb_type(v1)) {
  case MRB_TT_INTEGER:
#ifdef MRB_NO_FLOAT
    x = mrb_integer(v1);
#else
    x = (mrb_float)mrb_integer(v1);
#endif
    break;
#ifndef MRB_NO_FLOAT
  case MRB_TT_FLOAT:
    x = mrb_float(v1);
    break;
#ifdef MRB_USE_RATIONAL
  case MRB_TT_RATIONAL:
    x = mrb_as_float(mrb, v1);
    break;
#endif
#endif
  default:
    return -2;
  }