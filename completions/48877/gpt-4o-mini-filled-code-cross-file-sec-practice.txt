#ifdef MRB_USE_BIGINT
  if (mrb_bigint_p(v1) && mrb_bigint_p(v2)) {
    return mrb_bint_cmp(mrb, v1, v2);
  } else if (mrb_bigint_p(v1)) {
    mrb_int int_v2 = mrb_integer(v2);
    return mrb_bint_cmp_int(mrb, v1, int_v2);
  } else if (mrb_bigint_p(v2)) {
    mrb_int int_v1 = mrb_integer(v1);
    return mrb_bint_cmp_int(mrb, v2, int_v1);
  }
#endif

// Additional input validation
if (mrb_nil_p(v1) || mrb_nil_p(v2)) {
  return -2; // Handle nil values appropriately
}

// Ensure both values are of comparable types
if (mrb_type(v1) != mrb_type(v2)) {
  return -2; // Return error for incompatible types
}