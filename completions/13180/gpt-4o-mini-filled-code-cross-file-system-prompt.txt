// Retrieve TIFF tags and set image properties
  if (TIFFGetField(tiff, TIFFTAG_DOCUMENTNAME, &text))
    SetImageProperty(image, "tiff:document", text, exception);
  if (TIFFGetField(tiff, TIFFTAG_HOSTCOMPUTER, &text))
    SetImageProperty(image, "tiff:hostcomputer", text, exception);
  if (TIFFGetField(tiff, TIFFTAG_ARTIST, &text))
    SetImageProperty(image, "tiff:artist", text, exception);
  if (TIFFGetField(tiff, TIFFTAG_DATETIME, &text))
    SetImageProperty(image, "tiff:timestamp", text, exception);
  if (TIFFGetField(tiff, TIFFTAG_MAKE, &text))
    SetImageProperty(image, "tiff:make", text, exception);
  if (TIFFGetField(tiff, TIFFTAG_MODEL, &text))
    SetImageProperty(image, "tiff:model", text, exception);
  if (TIFFGetField(tiff, TIFFTAG_SOFTWARE, &text))
    SetImageProperty(image, "tiff:software", text, exception);
  if (TIFFGetField(tiff, TIFFTAG_COPYRIGHT, &text))
    SetImageProperty(image, "tiff:copyright", text, exception);
  if (TIFFGetField(tiff, 33423, &text)) // Kodak tag
    SetImageProperty(image, "kodak-33423", text, exception);
  if (TIFFGetField(tiff, 36867, &text)) // Kodak tag
    SetImageProperty(image, "kodak-36867", text, exception);
  if (TIFFGetField(tiff, TIFFTAG_PAGENAME, &text))
    SetImageProperty(image, "label", text, exception);
  if (TIFFGetField(tiff, TIFFTAG_IMAGEDESCRIPTION, &text))
    SetImageProperty(image, "comment", text, exception);
  
  // Handle subfiletype
  if (TIFFGetField(tiff, TIFFTAG_SUBFILETYPE, &type))
  {
    switch (type)
    {
      case FILETYPE_REDUCEDIMAGE:
        SetImageProperty(image, "tiff:subfiletype", "REDUCEDIMAGE", exception);
        break;
      case FILETYPE_PAGE:
        SetImageProperty(image, "tiff:subfiletype", "PAGE", exception);
        break;
      case FILETYPE_MASK:
        SetImageProperty(image, "tiff:subfiletype", "MASK", exception);
        break;
      default:
        break;
    }
  }