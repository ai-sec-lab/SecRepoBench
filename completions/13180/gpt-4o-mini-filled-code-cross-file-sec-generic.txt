// Initialize the TIFF directory
  uint32 directory;
  for (directory = 0; directory < TIFFNumberOfDirectories(tiff); directory++)
  {
    TIFFSetDirectory(tiff, directory);

    // Retrieve and set various TIFF tags as image properties
    const char *value;

    // Document name
    value = GetImageArtifact(image, "tiff:document");
    if (value != (const char *) NULL)
      (void) SetImageProperty(image, "tiff:document", value, exception);

    // Host computer
    value = GetImageArtifact(image, "tiff:hostcomputer");
    if (value != (const char *) NULL)
      (void) SetImageProperty(image, "tiff:hostcomputer", value, exception);

    // Artist
    value = GetImageArtifact(image, "tiff:artist");
    if (value != (const char *) NULL)
      (void) SetImageProperty(image, "tiff:artist", value, exception);

    // Timestamp
    value = GetImageArtifact(image, "tiff:timestamp");
    if (value != (const char *) NULL)
      (void) SetImageProperty(image, "tiff:timestamp", value, exception);

    // Make
    value = GetImageArtifact(image, "tiff:make");
    if (value != (const char *) NULL)
      (void) SetImageProperty(image, "tiff:make", value, exception);

    // Model
    value = GetImageArtifact(image, "tiff:model");
    if (value != (const char *) NULL)
      (void) SetImageProperty(image, "tiff:model", value, exception);

    // Software
    value = GetImageArtifact(image, "tiff:software");
    if (value != (const char *) NULL)
      (void) SetImageProperty(image, "tiff:software", value, exception);

    // Copyright
    value = GetImageArtifact(image, "tiff:copyright");
    if (value != (const char *) NULL)
      (void) SetImageProperty(image, "tiff:copyright", value, exception);

    // Handle subfiletype
    value = GetImageArtifact(image, "tiff:subfiletype");
    if (value != (const char *) NULL)
    {
      if (LocaleCompare(value, "REDUCEDIMAGE") == 0)
        (void) TIFFSetField(tiff, TIFFTAG_SUBFILETYPE, FILETYPE_REDUCEDIMAGE);
      else if (LocaleCompare(value, "PAGE") == 0)
        (void) TIFFSetField(tiff, TIFFTAG_SUBFILETYPE, FILETYPE_PAGE);
      else if (LocaleCompare(value, "MASK") == 0)
        (void) TIFFSetField(tiff, TIFFTAG_SUBFILETYPE, FILETYPE_MASK);
    }
    else
    {
      uint16 page = (uint16) image->scene;
      uint16 pages = (uint16) GetImageListLength(image);
      if (pages > 1)
        (void) TIFFSetField(tiff, TIFFTAG_SUBFILETYPE, FILETYPE_PAGE);
      (void) TIFFSetField(tiff, TIFFTAG_PAGENUMBER, page, pages);
    }
  }