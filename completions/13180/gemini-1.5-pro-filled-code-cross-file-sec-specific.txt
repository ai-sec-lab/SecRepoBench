if (TIFFGetField(tiff,TIFFTAG_ARTIST,&text) != 0)
    (void) SetImageProperty(image,"tiff:artist",text,exception);
  if (TIFFGetField(tiff,TIFFTAG_COPYRIGHT,&text) != 0)
    (void) SetImageProperty(image,"tiff:copyright",text,exception);
  if (TIFFGetField(tiff,TIFFTAG_DATETIME,&text) != 0)
    (void) SetImageProperty(image,"tiff:timestamp",text,exception);
  if (TIFFGetField(tiff,TIFFTAG_DOCUMENTNAME,&text) != 0)
    (void) SetImageProperty(image,"tiff:document",text,exception);
  if (TIFFGetField(tiff,TIFFTAG_HOSTCOMPUTER,&text) != 0)
    (void) SetImageProperty(image,"tiff:hostcomputer",text,exception);
  if (TIFFGetField(tiff,TIFFTAG_IMAGEDESCRIPTION,&text) != 0)
    (void) SetImageProperty(image,"comment",text,exception);
  if (TIFFGetField(tiff,TIFFTAG_MAKE,&text) != 0)
    (void) SetImageProperty(image,"tiff:make",text,exception);
  if (TIFFGetField(tiff,TIFFTAG_MODEL,&text) != 0)
    (void) SetImageProperty(image,"tiff:model",text,exception);
  if (TIFFGetField(tiff,TIFFTAG_OPIIMAGEID,&count,&text) != 0)
    {
      if (count > 1) // Ensure count does not lead to out-of-bounds access
        {
          if (text != NULL) // Ensure text is not NULL before accessing
            {
              char *message = (char *) AcquireQuantumMemory(MagickPathExtent, sizeof(*message));
              if (message != NULL)
                {
                  (void) CopyMagickString(message,text,MagickPathExtent);
                  (void) SetImageProperty(image,"tiff:OPIimageID",message,exception);
                  message=DestroyString(message);
                }
              else
                {
                  // Handle memory allocation failure
                  (void) ThrowMagickException(exception, GetMagickModule(), ResourceLimitError, "MemoryAllocationFailed", "`%s'", image->filename);
                  return;
                }
            }
        }
    }
  if (TIFFGetField(tiff,TIFFTAG_PAGENAME,&text) != 0)
    (void) SetImageProperty(image,"label",text,exception);
  if (TIFFGetField(tiff,TIFFTAG_SOFTWARE,&text) != 0)
    (void) SetImageProperty(image,"tiff:software",text,exception);
  if (TIFFGetField(tiff,TIFFTAG_SUBFILETYPE,&type) != 0)
    {
      switch (type)
      {
        case FILETYPE_REDUCEDIMAGE:
        {
          (void) SetImageProperty(image,"tiff:subfiletype","REDUCEDIMAGE",
            exception);
          break;
        }
        case FILETYPE_PAGE:
        {
          (void) SetImageProperty(image,"tiff:subfiletype","PAGE",exception);
          break;
        }
        case FILETYPE_MASK:
        {
          (void) SetImageProperty(image,"tiff:subfiletype","MASK",exception);
          break;
        }
      }
    }