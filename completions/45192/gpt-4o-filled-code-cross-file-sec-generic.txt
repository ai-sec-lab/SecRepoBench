mrb_int shift = 0;
  i = 0;
  while (i < srclen) {
    unsigned char byte = src[i++];
    if (shift >= (sizeof(mrb_int) * 8)) {
      mrb_raise(mrb, E_RANGE_ERROR, "BER integer overflow");
    }
    n |= (mrb_int)(byte & 0x7F) << shift;
    if ((byte & 0x80) == 0) {
      break;
    }
    shift += 7;
  }
  if (i == srclen && (src[i-1] & 0x80) != 0) {
    mrb_raise(mrb, E_RANGE_ERROR, "BER integer incomplete");
  }