/* decode BER-compressed integer */
  i = 0;
  while (1) {
    unsigned char c;

    /* need another byte */
    if (i >= srclen) {
      mrb_raise(mrb, E_ARGUMENT_ERROR, "malformed BER compressed integer");
    }

    c = sourcedata[i++];

    /* check for overflow before shifting */
    if (n > (MRB_INT_MAX >> 7)) {
      mrb_raise(mrb, E_ARGUMENT_ERROR, "BER compressed integer too large");
    }

    n = (n << 7) | (c & 0x7f);

    /* high bit clear => last byte */
    if ((c & 0x80) == 0) {
      break;
    }
  }