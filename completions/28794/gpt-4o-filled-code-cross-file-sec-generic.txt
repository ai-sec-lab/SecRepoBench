// Check if the base constructor has a single scalar argument.
                if (base.arguments().size() == 1) {
                    // If so, we can optimize by reducing the swizzle size.
                    replacement = construct(&componentType, base.arguments()[0]->clone());
                } else {
                    // Map the arguments of the constructor.
                    std::vector<int> argUsage(base.arguments().size(), 0);
                    for (int c : s.components()) {
                        ++argUsage[c];
                    }

                    // Count the number of times each argument is used in the swizzle.
                    int nonTrivialCount = 0;
                    for (size_t i = 0; i < base.arguments().size(); ++i) {
                        if (argUsage[i] > 1 && base.arguments()[i]->hasSideEffects()) {
                            // If a non-trivial expression is repeated, we can't optimize.
                            nonTrivialCount++;
                        }
                    }

                    // If we have non-trivial expressions that are repeated, we can't optimize.
                    if (nonTrivialCount == 0) {
                        // Reorder and simplify the arguments.
                        ExpressionArray reorderedArgs;
                        reorderedArgs.reserve_back(swizzleSize);
                        for (int c : s.components()) {
                            reorderedArgs.push_back(base.arguments()[c]->clone());
                        }
                        replacement = std::make_unique<Constructor>(base.fOffset, &componentType, std::move(reorderedArgs));
                    }
                }

                if (replacement) {
                    optimizationContext->fUpdated = true;
                    if (!try_replace_expression(&b, iter, &replacement)) {
                        optimizationContext->fNeedsRescan = true;
                        return;
                    }
                    SkASSERT((*iter)->isExpression());
                    break;
                }