if (swizzleSize > 1) {
                    // Check if the swizzle can be optimized by ensuring that the base constructor
                    // has no side effects and can be safely flattened.
                    bool canOptimize = true;
                    for (const std::unique_ptr<Expression>& arg : base.arguments()) {
                        if (arg->hasSideEffects()) {
                            canOptimize = false;
                            break;
                        }
                    }

                    if (canOptimize) {
                        ExpressionArray optimizedArgs;
                        for (int c : s.components()) {
                            optimizedArgs.push_back(base.arguments()[c]->clone());
                        }
                        replacement = std::make_unique<Constructor>(c.fOffset, &componentType, std::move(optimizedArgs));
                    }
                }

                if (replacement) {
                    optimizationContext->fUpdated = true;
                    if (!try_replace_expression(&b, iter, &replacement)) {
                        optimizationContext->fNeedsRescan = true;
                        return;
                    }
                    SkASSERT((*iter)->isExpression());
                }