if ((*InputFmt == 0u) && (*OutputFormat == 0u)) {

            // The client did not specify buffer formats.  Defer the decision
            // until cmsChangeBuffersFormat() is called.  At this point we just
            // leave the formatter function pointers set to NULL and mark the
            // transform as able to change its formatters later on.
            p->FromInput  = NULL;
            p->ToOutput   = NULL;

            // Let the outside world know that formatters can be changed on this
            // transform at any moment (at least 16-bit precision will be used).
            *dwFlags |= cmsFLAGS_CAN_CHANGE_FORMATTER;
        }
        else {

            // Both input and output formats must be supplied.
            if ((*InputFmt == 0u) || (*OutputFormat == 0u)) {
                cmsSignalError(ContextID, cmsERROR_NOT_SUITABLE,
                               "Both input and output formats must be specified");
                cmsDeleteTransform(p);
                return NULL;
            }

            // Retrieve the formatter functions for 16-bit packing.
            p->FromInput = _cmsGetFormatter(ContextID, *InputFmt,
                                            cmsFormatterInput,
                                            CMS_PACK_FLAGS_16BITS).Fmt16;
            p->ToOutput  = _cmsGetFormatter(ContextID, *OutputFormat,
                                            cmsFormatterOutput,
                                            CMS_PACK_FLAGS_16BITS).Fmt16;

            // If any of the required formatters is missing, bail out.
            if (p->FromInput == NULL || p->ToOutput == NULL) {

                cmsSignalError(ContextID, cmsERROR_UNKNOWN_EXTENSION,
                               "Unsupported raster format");
                cmsDeleteTransform(p);
                return NULL;
            }

            // Using 16-bit precision allows buffers to be safely exchanged, so
            // enable the flag that makes the transform “re-formattable”.
            *dwFlags |= cmsFLAGS_CAN_CHANGE_FORMATTER;
        }