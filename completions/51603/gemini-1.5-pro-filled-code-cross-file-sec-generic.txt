char *op;
	uint32_t factor;

	if (me->mp == NULL) {
		file_magerror(ms, "No current entry for STRENGTH type");
		return -1;
	}
	if (me->mp[0].factor_op != FILE_FACTOR_OP_NONE) {
		file_magwarn(ms, "STRENGTH type already defined");
		return -1;
	}
        if (me->mp[0].type == FILE_NAME) {
                file_magwarn(ms, "STRENGTH not supported for NAME");
                return -1;
        }


	EATAB;
	if (*line == '\0') {
		me->mp[0].factor_op = FILE_FACTOR_OP_NONE;
		me->mp[0].factor = 0;
		return 0;
	}
	op = CCAST(char *, strchr(line, '*'));
	if (op) {
		me->mp[0].factor_op = FILE_FACTOR_OP_TIMES;
		*op++ = '\0';
	} else {
		op = CCAST(char *, strchr(line, '/'));
		if (op) {
			me->mp[0].factor_op = FILE_FACTOR_OP_DIV;
			*op++ = '\0';
		} else {
			op = CCAST(char *, strchr(line, '+'));
			if (op) {
				me->mp[0].factor_op = FILE_FACTOR_OP_PLUS;
				*op++ = '\0';
			} else {
				op = CCAST(char *, strchr(line, '-'));
				if (op) {
					me->mp[0].factor_op = FILE_FACTOR_OP_MINUS;
					*op++ = '\0';
				} else {
					op = CCAST(char *, line);
					me->mp[0].factor_op = FILE_FACTOR_OP_NONE;
				}
			}
		}
	}
	EATAB;
	errno = 0;
	factor = CAST(uint32_t, strtoul(op, &op, 0));
	EATAB;
	if (op == line || *op) {
		file_magwarn(ms, "Invalid factor `%s'", line);
		me->mp[0].factor_op = FILE_FACTOR_OP_NONE;
		me->mp[0].factor = 0;
		return -1;
	}
	if (factor > 255) {
		file_magwarn(ms, "Too large factor `%s'", line);
		me->mp[0].factor_op = FILE_FACTOR_OP_NONE;
		me->mp[0].factor = 0;
		return -1;
	}
	if (me->mp[0].factor_op == FILE_FACTOR_OP_DIV && factor == 0) {
		file_magwarn(ms, "Cannot have factor of 0 for / op");
		me->mp[0].factor_op = FILE_FACTOR_OP_NONE;
		me->mp[0].factor = 0;
		return -1;
	}
	me->mp[0].factor = factor;
	return 0;