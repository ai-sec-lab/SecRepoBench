if (m->factor_op != FILE_FACTOR_OP_NONE) {
        file_magwarn(ms, "Strength settings are not supported for FILE_NAME type");
        m->factor_op = FILE_FACTOR_OP_NONE; // Reset to default
        m->factor = 0; // Reset factor to default
        return -1;
    }

    // Read the operation type
    switch (*line) {
        case '+':
            m->factor_op = FILE_FACTOR_OP_PLUS;
            break;
        case '-':
            m->factor_op = FILE_FACTOR_OP_MINUS;
            break;
        case '*':
            m->factor_op = FILE_FACTOR_OP_TIMES;
            break;
        case '/':
            m->factor_op = FILE_FACTOR_OP_DIV;
            break;
        default:
            file_magwarn(ms, "Invalid strength operation `%c'", *line);
            return -1;
    }

    // Move past the operation character
    line++;

    // Read the factor value
    errno = 0; // Reset errno before strtol
    m->factor = strtol(line, &t, 10);
    if (errno != 0 || line == t) {
        file_magwarn(ms, "Invalid strength factor value");
        m->factor_op = FILE_FACTOR_OP_NONE; // Reset to default
        return -1;
    }

    // Check for division by zero
    if (m->factor_op == FILE_FACTOR_OP_DIV && m->factor == 0) {
        file_magwarn(ms, "Division by zero in strength factor");
        m->factor_op = FILE_FACTOR_OP_NONE; // Reset to default
        return -1;
    }

    return 0; // Successfully parsed strength annotation