char *op;
	uint32_t factor = 0;

	if (me->mp == NULL) {
		file_magerror(ms, "No current entry for STRENGTH type");
		return -1;
	}
	if (me->mp->type == FILE_NAME) {
		file_magwarn(ms, "STRENGTH annotation not supported for NAME");
		return -1;
	}


	if (me->cont_count == 0) {
		m = &me->mp[0];
	} else {
		m = &me->mp[me->cont_count - 1];
	}

	if (m->factor_op != FILE_FACTOR_OP_NONE) {
		file_magwarn(ms, "STRENGTH type already defined");
		return -1;
	}

	EATAB;
	op = CCAST(char *, strchr(line, '='));
	if (op) {
		*op++ = '\0';
		EATAB;
		factor = CAST(uint32_t, strtoul(op, &op, 0));
		EATAB;
	}
	if (factor > 99) {
		file_magwarn(ms, "STRENGTH factor %u is invalid, must be "
		    "between 0 and 99", factor);
		goto out;
	}
	if (0 == factor && *line == '/') {
		file_magwarn(ms, "STRENGTH factor is 0, will be ignored");
		goto out;
	}

	switch (*line) {
	case '+':
		m->factor_op = FILE_FACTOR_OP_PLUS;
		break;
	case '-':
		m->factor_op = FILE_FACTOR_OP_MINUS;
		break;
	case '*':
		m->factor_op = FILE_FACTOR_OP_TIMES;
		break;
	case '/':
		m->factor_op = FILE_FACTOR_OP_DIV;
		break;
	default:
		file_magwarn(ms, "STRENGTH operation is invalid, must be "
		    "'+', '-', '*' or '/'");
		goto out;
	}
	m->factor = factor;
	return 0;
out:
	m->factor_op = FILE_FACTOR_OP_NONE;
	m->factor = 0;
	return -1;