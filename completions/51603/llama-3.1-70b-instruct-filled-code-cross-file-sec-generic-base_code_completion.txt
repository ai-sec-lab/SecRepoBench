// This function parses a strength annotation line from a magic file
// and sets the corresponding factor operation and value in the magic
// entry.
private int
parse_strength(struct magic_set *ms, struct magic_entry *me, const char *line,
    size_t len __attribute__((__unused__)))
{
    const char *l = line;
    int op;
    uint64_t val;

    // Check if a strength type is already defined
    if (me->mp->factor_op!= FILE_FACTOR_OP_NONE) {
        file_magwarn(ms, "Strength type already defined");
        return -1;
    }

    // Check if the entry is of type FILE_NAME
    if (me->mp->type == FILE_NAME) {
        file_magwarn(ms, "Strength settings are not supported for FILE_NAME type");
        return -1;
    }

    // Read the operation type
    op = get_op(*l);
    if (op == -1) {
        file_magwarn(ms, "Invalid operation type `%c'", *l);
        return -1;
    }

    // Read the factor value
    l++;
    val = CAST(uint64_t, strtoull(l, &l, 0));
    if (errno!= 0) {
        file_magwarn(ms, "Invalid factor value `%s'", l);
        return -1;
    }

    // Check if the factor is within valid limits
    if (val < 1 || val > 100) {
        file_magwarn(ms, "Factor value `%llu' is out of range", val);
        return -1;
    }

    // Check if the factor is combined with a division operation when zero
    if (op == FILE_FACTOR_OP_DIV && val == 0) {
        file_magwarn(ms, "Cannot divide by zero");
        return -1;
    }

    // Set the factor operation and value
    me->mp->factor_op = op;
    me->mp->factor = CAST(uint32_t, val);

    return 0;
}