if (me->mp == NULL) {
		file_magerror(ms, "No current entry for strength");
		return -1;
	}

	if (me->mp->type == FILE_NAME) {
		file_magwarn(ms, "Strength settings are not supported for 'name' entries");
		return -1;
	}

	if (me->mp->factor_op != FILE_FACTOR_OP_NONE) {
		file_magwarn(ms, "Strength type already set");
		return -1;
	}

	const char *l = line;
	EATAB;

	switch (*l) {
	case '+':
		me->mp->factor_op = FILE_FACTOR_OP_PLUS;
		break;
	case '-':
		me->mp->factor_op = FILE_FACTOR_OP_MINUS;
		break;
	case '*':
		me->mp->factor_op = FILE_FACTOR_OP_TIMES;
		break;
	case '/':
		me->mp->factor_op = FILE_FACTOR_OP_DIV;
		break;
	default:
		file_magwarn(ms, "Unknown factor operation `%c'", *l);
		return -1;
	}

	l++;
	EATAB;

	if (!isdigit(CAST(unsigned char, *l))) {
		file_magwarn(ms, "Missing factor value");
		me->mp->factor_op = FILE_FACTOR_OP_NONE;
		return -1;
	}

	me->mp->factor = CAST(uint32_t, strtoul(l, &t, 0));
	if (me->mp->factor == 0 && me->mp->factor_op == FILE_FACTOR_OP_DIV) {
		file_magwarn(ms, "Cannot have zero divisor");
		me->mp->factor_op = FILE_FACTOR_OP_NONE;
		return -1;
	}

	if (me->mp->factor > 100) {
		file_magwarn(ms, "Factor value %u too large", me->mp->factor);
		me->mp->factor_op = FILE_FACTOR_OP_NONE;
		return -1;
	}

	return 0;