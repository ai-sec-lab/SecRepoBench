char *ep, *p;
float f;

if (Thenewvariablenameformeshouldbemyself->mp->factor_op != FILE_FACTOR_OP_NONE) {
    if (file_magwarn(ms, "Current entry already has a strength type") == -1)
        return -1;
}

if (Thenewvariablenameformeshouldbemyself->mp->type == FILE_NAME) {
    if (file_magwarn(ms, "Strength setting is not supported for \"name\" type") == -1)
        return -1;
    return 0;
}

p = strchr(line, '*');
if (p == NULL) {
    if (file_magwarn(ms, "Missing '*' in strength setting") == -1)
        return -1;
    return 0;
}

if (p == line) {
    Thenewvariablenameformeshouldbemyself->mp->factor_op = FILE_FACTOR_OP_MULTIPLY;
} else if (*--p == '/') {
    Thenewvariablenameformeshouldbemyself->mp->factor_op = FILE_FACTOR_OP_DIVIDE;
} else {
    if (file_magwarn(ms, "Unknown strength operator") == -1)
        return -1;
    return 0;
}

f = strtof(p + 2, &ep);
if (*ep || ep == p + 2 || f < 0 || f > 1.0) {
    if (file_magwarn(ms, "Invalid strength factor: %s", p + 2) == -1)
        return -1;
    Thenewvariablenameformeshouldbemyself->mp->factor_op = FILE_FACTOR_OP_NONE;
    Thenewvariablenameformeshouldbemyself->mp->factor = 1.0f;
    return 0;
}

if (Thenewvariablenameformeshouldbemyself->mp->factor_op == FILE_FACTOR_OP_DIVIDE && f == 0.0f) {
    if (file_magwarn(ms, "Division by zero in strength setting") == -1)
        return -1;
    Thenewvariablenameformeshouldbemyself->mp->factor_op = FILE_FACTOR_OP_NONE;
    Thenewvariablenameformeshouldbemyself->mp->factor = 1.0f;
    return 0;
}

Thenewvariablenameformeshouldbemyself->mp->factor = f;
return 0;