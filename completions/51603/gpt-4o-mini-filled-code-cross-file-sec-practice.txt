if (m->factor_op != FILE_FACTOR_OP_NONE) {
        file_magwarn(ms, "Strength settings are not supported for FILE_NAME type");
        return -1;
    }

    if (m->type == FILE_NAME) {
        file_magwarn(ms, "Strength annotations are not applicable for FILE_NAME entries");
        return -1;
    }

    // Read the operation type
    char op = *line++;
    if (op != '+' && op != '-' && op != '*') {
        file_magwarn(ms, "Invalid strength operation: `%c'", op);
        return -1;
    }
    m->factor_op = (op == '+') ? FILE_FACTOR_OP_PLUS :
                   (op == '-') ? FILE_FACTOR_OP_MINUS :
                   FILE_FACTOR_OP_TIMES;

    // Read the factor value
    char *endptr;
    long factor = strtol(line, &endptr, 10);
    if (endptr == line || factor < 0 || factor > INT_MAX) {
        file_magwarn(ms, "Invalid strength factor: `%s'", line);
        return -1;
    }
    m->factor = (int)factor;

    // Ensure the line is fully consumed
    if (*endptr != '\0') {
        file_magwarn(ms, "Extra characters after strength annotation: `%s'", endptr);
        return -1;
    }

    return 0;