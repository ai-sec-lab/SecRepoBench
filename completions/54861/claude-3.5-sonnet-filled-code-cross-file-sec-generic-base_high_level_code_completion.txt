if (s->codec_id == AV_CODEC_ID_H264 || s->codec_id == AV_CODEC_ID_VC1 ||
    s->codec_id == AV_CODEC_ID_WMV3 || s->codec_id == AV_CODEC_ID_VP5 ||
    s->codec_id == AV_CODEC_ID_VP6 || s->codec_id == AV_CODEC_ID_VP6F ||
    s->codec_id == AV_CODEC_ID_VP6A) {
    // H264 needs a minimum of 32 pixels for edge emulation
    // VC1 needs a minimum of 32 pixels for loop filtering
    // VP6 needs a minimum of 32 pixels for loop filtering
    *width = FFMAX(*width, 32);
    // Some codecs need additional height for optimized chroma motion compensation
    if (!(s->flags & AV_CODEC_FLAG_EMU_EDGE))
        *height += 2;
}

if (s->codec_id == AV_CODEC_ID_SVQ3)
    *width = FFMAX(*width, 32);