/* If the CSV header has not yet been written, write it now              */
    if(ndpi_serializer_header_string(serializer, key, strlen(key)) < 0)
      return(-1);

    /* Write the separator (comma or newline depending on state)             */
    ndpi_serialize_csv_pre(serializer);

    /* Make sure we still have enough space in the buffer for the value      */
    remainingspace = serializer->buffer.size - serializer->status.buffer.size_used;
    if(remainingspace < 16 /* plenty for an int32 and the trailing '\0' */) {
      if(ndpi_extend_serializer_buffer(&serializer->buffer, 16 - remainingspace) < 0)
        return(-1);
      remainingspace = serializer->buffer.size - serializer->status.buffer.size_used;
    }

    /* Serialize the int32 value                                             */
#ifdef NDPI_I32_FORMAT
    int rc = ndpi_snprintf((char *)&serializer->buffer.data[serializer->status.buffer.size_used],
                           remainingspace, NDPI_I32_FORMAT, (int)value);
#else
    int rc = ndpi_snprintf((char *)&serializer->buffer.data[serializer->status.buffer.size_used],
                           remainingspace, "%d", (int)value);
#endif