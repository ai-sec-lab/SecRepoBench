// Align the width and height to the specified w_align and h_align values.
    // Ensure that the width is at least 32 to provide enough temporary space for edge emulation.
    *width = (*width + w_align - 1) & ~(w_align - 1);
    *height = (*height + h_align - 1) & ~(h_align - 1);

    // Special handling for H.264 and certain VP codecs
    if (s->codec_id == AV_CODEC_ID_H264 || s->codec_id == AV_CODEC_ID_VP8 || s->codec_id == AV_CODEC_ID_VP9) {
        if (*height % 2 != 0) {
            *height += 2; // Adjust height by 2 for motion compensation edge cases
        }
    }

    // Ensure minimum width
    if (*width < 32) {
        *width = 32;
    }