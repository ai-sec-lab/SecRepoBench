int          val = -1;
    long         num  = 0;
    int          mult = 1;
    size_t       len;
    char         last;
    char         tmp[64];        /* enough for most numeric strings */

    if (!timestr) {
        return -1;
    }

    len = strlen(timestr);
    if (len == 0) {
        return -1;
    }

    last = timestr[len - 1];

    /* Detect optional time unit suffix */
    if (isalpha((unsigned char) last)) {
        switch (last) {
        case 'd':
        case 'D':
            mult = 60 * 60 * 24;   /* days to seconds   */
            break;
        case 'h':
        case 'H':
            mult = 60 * 60;        /* hours to seconds  */
            break;
        case 'm':
        case 'M':
            mult = 60;             /* minutes to seconds*/
            break;
        default:                   /* unsupported suffix */
            return -1;
        }

        /* Copy only the numeric part */
        if (len - 1 >= sizeof(tmp)) {
            /* numeric string too long */
            return -1;
        }
        memcpy(tmp, timestr, len - 1);
        tmp[len - 1] = '\0';
        num = strtol(tmp, NULL, 10);
    }
    else {
        /* No suffix => assume the value is already in seconds */
        num = strtol(timestr, NULL, 10);
    }

    if (num < 0) {
        return -1;
    }

    val = (int) (num * mult);