/* ------------------------------------------------------------------
     * Determine the structure field names
     * ------------------------------------------------------------------ */
    if ( H5Aexists_by_name(dset_id,".","MATLAB_fields",H5P_DEFAULT) ) {
        /* Field names are stored in attribute "MATLAB_fields" */
        err = Mat_H5ReadFieldNames(matvariable, dset_id, &nfields);
        if ( err ) {
            return err;
        }
    } else {
        /* Field names are the links of the current group */
        struct ReadGroupInfoIterData group_data;
        herr_t herr;

        /* ------------------------------------------------------------------
         * First pass : count number of valid links (= fields)
         * ------------------------------------------------------------------ */
        group_data.matvar  = NULL;  /* do not store names, only count them  */
        group_data.nfields = 0;
        herr = H5Literate(dset_id, H5_INDEX_NAME, H5_ITER_INC, NULL,
                          Mat_H5ReadGroupInfoIterate, &group_data);
        if ( herr < 0 ) {
            return MATIO_E_GENERIC_READ_ERROR;
        }
        nfields = group_data.nfields;

        /* ------------------------------------------------------------------
         * Second pass : allocate and fill the field name list
         * ------------------------------------------------------------------ */
        if ( nfields > 0 ) {
            matvariable->internal->fieldnames =
                (char**)calloc((size_t)nfields, sizeof(char*));
            if ( NULL == matvariable->internal->fieldnames ) {
                return MATIO_E_OUT_OF_MEMORY;
            }

            group_data.matvar  = matvariable; /* now store the names        */
            group_data.nfields = 0;
            herr = H5Literate(dset_id, H5_INDEX_NAME, H5_ITER_INC, NULL,
                              Mat_H5ReadGroupInfoIterate, &group_data);
            if ( herr < 0 ) {
                return MATIO_E_GENERIC_READ_ERROR;
            }
        }
    }

    /* Save the number of fields found (may be zero) */
    matvariable->internal->num_fields = (size_t)nfields;