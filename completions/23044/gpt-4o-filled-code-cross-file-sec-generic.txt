const unsigned char *a = (const unsigned char *)s1;
	const unsigned char *b = (const unsigned char *)s2;
	const unsigned char *eb = b + len;

	if (flags & (STRING_COMPACT_WHITESPACE | STRING_COMPACT_OPTIONAL_WHITESPACE)) {
		while (len-- > 0 && b < eb) {
			if (isspace(*b)) {
				if (flags & STRING_COMPACT_WHITESPACE) {
					while (b < eb && isspace(*b))
						b++;
				} else {
					b++;
				}
			} else {
				break;
			}
		}
	}