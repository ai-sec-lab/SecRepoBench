case VALUE_UNISTR: {
      size_t sz;

      /* Need at least 4 bytes to read the size */
      if(payload_len < 4)
        return 0;

      sz = ntohl(get_u_int32_t(databuffer, 0));

      /* Sanity checks */
      if(sz == 0 || sz > (payload_len - 4))
        return 0;

      /* Pointer to the data right after the size field */
      v->value.ptr.value_str = (char const *)(databuffer + 4);

      /* For VALUE_DATA the size returned by SoftEther includes the '\0'
       * at the end of the ASCII string: ignore it when exposing the
       * value to the caller. */
      v->value_size = sz;
      if(t == VALUE_DATA && v->value_size > 0)
        v->value_size--;

      ret = 4 + sz;         /* 4 bytes for size + actual data */
      break;
    }