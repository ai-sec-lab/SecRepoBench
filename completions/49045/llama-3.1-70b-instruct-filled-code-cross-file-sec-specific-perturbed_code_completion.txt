mrb_int base;
mrb_value str;

mrb_get_args(state, "i|o", &base, &str);

if (mrb_nil_p(str)) {
  str = mrb_str_new(state, NULL, 0);
}

if (base < 2 || base > 36) {
  base = 10;
}

mrb_str_resize(state, str, 0);
mrb_sprintf(state, str, "%i", mrb_integer(self));

if (base!= 10) {
  mrb_str_resize(state, str, 0);
  mrb_sprintf(state, str, "%i", mrb_integer(self));
  mrb_to_s_with_base(state, str, base);
}

return str;