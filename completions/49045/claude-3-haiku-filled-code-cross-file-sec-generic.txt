char *base_digits = "0123456789abcdefghijklmnopqrstuvwxyz";
mrb_int base;
char *str;
mrb_int len, i;

mrb_get_args(mrb, "|i", &base);
if (base == 0) {
  base = 10;
}
else if (base < 2 || base > 36) {
  mrb_raise(mrb, E_ARGUMENT_ERROR, "invalid radix");
}

len = mrb_int_to_str(NULL, self, base);
str = (char *)mrb_malloc(mrb, len + 1);
mrb_int_to_str(str, self, base);
str[len] = '\0';

return mrb_str_new(mrb, str, len);