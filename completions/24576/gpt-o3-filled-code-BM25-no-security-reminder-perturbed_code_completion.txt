/* Cisco PPP in HDLC-like framing - 50 */
#ifdef DLT_PPP_SERIAL
  case DLT_PPP_SERIAL:      /* PPP (HDLC-like framing) */
#endif
#ifdef DLT_C_HDLC
  case DLT_C_HDLC:          /* Cisco HDLC */
#endif
    /*
     * Generic layout (HDLC-like framing):
     *   +--------+---------+-----------+
     *   | Addr   | Control | Protocol  |
     *   | 1 byte | 1 byte  |  2 bytes  |
     *   +--------+---------+-----------+
     */
    if(header->caplen < eth_offset + sizeof(struct ndpi_chdlc))
      return(nproto); /* Too short */

    chdlc = (struct ndpi_chdlc *) &packet[eth_offset];
    ip_offset = eth_offset + (u_int16_t)sizeof(struct ndpi_chdlc);

    /* Map PPP/HDLC protocol field to Ethernetâ€style ethertype */
    switch(ntohs(chdlc->protocol)) {
    case 0x0021:                  /* PPP_IP  (IPv4)  */
      ethertype = ETH_P_IP;
      break;

    case 0x0057:                  /* PPP_IPV6 */
      ethertype = ETH_P_IPV6;
      break;

    default:                      /* Unsupported payload */
      goto v4_warning;
    }
    break;