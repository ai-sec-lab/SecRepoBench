/* `cframe` already lives in memory, so just compute the address where the
       (compressed) offsets chunk starts.  For regular frames the offsets come
       after the compressed data (`cbytes`).  For super-frames (`sframe`) the
       compressed data is not stored inside the frame, so the offsets start
       right after the header. */
    uint8_t *off_start;
    if (container->sframe) {
      off_start = container->cframe + header_len + 0;
    }
    else {
      off_start = container->cframe + header_len + (size_t)cbytes;
    }

    /* Cache the pointer so that subsequent calls are faster. */
    container->coffsets = off_start;

    /* Return the compressed size of the offsets chunk when requested.  This is
       stored inside the Blosc2 chunk header at position BLOSC2_CHUNK_CBYTES. */
    if (off_cbytes != NULL) {
      *off_cbytes = *(int32_t *)(off_start + BLOSC2_CHUNK_CBYTES);
    }