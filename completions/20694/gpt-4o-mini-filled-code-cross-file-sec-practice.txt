#ifdef LARGE_POS
        // Extract 64-bit reference sequence start and span
        cp += safe_ltf8_get((char *)cp, (char *)cp_end, &hdr->ref_seq_start);
        cp += safe_ltf8_get((char *)cp, (char *)cp_end, &hdr->ref_seq_span);
#else
        // Extract 32-bit reference sequence start and span
        cp += safe_itf8_get((char *)cp, (char *)cp_end, &hdr->ref_seq_start);
        cp += safe_itf8_get((char *)cp, (char *)cp_end, &hdr->ref_seq_span);
#endif

// Ensure that the extracted values are valid
if (hdr->ref_seq_start < 0 || hdr->ref_seq_span < 0) {
    free(hdr->block_content_ids);
    free(hdr);
    return NULL;
}