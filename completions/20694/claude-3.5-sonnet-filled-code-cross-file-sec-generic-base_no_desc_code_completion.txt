cp += safe_itf8_get((char *)cp, (char *)cp_end, &hdr->ref_seq_id);
cp += safe_itf8_get((char *)cp, (char *)cp_end, &hdr->ref_seq_start);
cp += safe_itf8_get((char *)cp, (char *)cp_end, &hdr->ref_seq_span);

hdr->flags = 0;
if (CRAM_MAJOR_VERS(fd->version) >= 3) {
    int32_t i32;
    cp += safe_itf8_get((char *)cp, (char *)cp_end, &i32);
    hdr->flags = i32;
}

if (hdr->ref_seq_id == -2) {
    hdr->ref_seq_id = -1;
    hdr->ref_seq_start = 0;
    hdr->ref_seq_span = 0;
}