// If parameters are invalid or the requested index is negative,
  // return NULL immediately.
  if (str_table_base == NULL || str_table_limit == NULL || entry_index < 0)
    return NULL;

  const char* p = str_table_base;

  // Walk the table until the desired entry is found.
  for (int i = 0;; i++)
  {
    // Reached (or went beyond) the limit before finding the entry.
    if (p >= str_table_limit)
      return NULL;

    // The current position corresponds to the requested entry.
    if (i == entry_index)
      return p;

    // Skip over the current NUL-terminated string.
    while (p < str_table_limit && *p != '\0')
      p++;

    // If we reached the limit without finding a NUL terminator,
    // the table is malformed.
    if (p >= str_table_limit)
      return NULL;

    // Move past the NUL terminator to the start of the next string.
    p++;
  }