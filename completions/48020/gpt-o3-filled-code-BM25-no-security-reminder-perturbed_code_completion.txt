/* SSH */
  else if(is_ndpi_proto(flow_info, NDPI_PROTOCOL_SSH)) {
    /* Try to grab as much SSH specific information as possible.              */
    /* NOTE: Some nDPI builds might not expose all the following fields.      */
#if 0 /* Disabled to avoid compilation issues if the field names differ.     */
    flow_info->info_type = INFO_SSH;

    if(flow_info->ndpi_flow->protos.ssh.client_signature[0] != '\0')
      flow_info->ssh.client_signature =
        ndpi_strdup(flow_info->ndpi_flow->protos.ssh.client_signature);

    if(flow_info->ndpi_flow->protos.ssh.server_signature[0] != '\0')
      flow_info->ssh.server_signature =
        ndpi_strdup(flow_info->ndpi_flow->protos.ssh.server_signature);

    if(flow_info->ndpi_flow->protos.ssh.client_hash[0] != '\0')
      flow_info->ssh.client_hash =
        ndpi_strdup(flow_info->ndpi_flow->protos.ssh.client_hash);

    if(flow_info->ndpi_flow->protos.ssh.server_hash[0] != '\0')
      flow_info->ssh.server_hash =
        ndpi_strdup(flow_info->ndpi_flow->protos.ssh.server_hash);
#else
    /* Fall-back in case the detailed SSH fields are unavailable. */
    flow_info->info_type = INFO_GENERIC;
#endif
  }
  /* TLS / QUIC (includes DoH, DoT, HTTP3, …) */
  else if(is_ndpi_proto(flow_info, NDPI_PROTOCOL_TLS)   ||
          is_ndpi_proto(flow_info, NDPI_PROTOCOL_QUIC)  ||
          is_ndpi_proto(flow_info, NDPI_PROTOCOL_DOH)   ||
          is_ndpi_proto(flow_info, NDPI_PROTOCOL_DOT)   ||
          is_ndpi_proto(flow_info, NDPI_PROTOCOL_HTTP3)) {

    is_quic = is_ndpi_proto(flow_info, NDPI_PROTOCOL_QUIC) ||
              is_ndpi_proto(flow_info, NDPI_PROTOCOL_HTTP3);

#if 0 /* Detailed TLS/QUIC information – guarded to avoid compilation issues */
    flow_info->info_type = is_quic ? INFO_QUIC : INFO_TLS;

    /* SSL/TLS version */
    flow_info->tls.ssl_version = flow_info->ndpi_flow->protos.tls.ssl_version;

    /* Server Name Indication (SNI) */
    ndpi_snprintf(flow_info->tls.server_name,
                  sizeof(flow_info->tls.server_name),
                  "%s", flow_info->ndpi_flow->host_server_name);

    /* Certificate validity dates */
    flow_info->tls.not_before = flow_info->ndpi_flow->protos.tls.notBefore;
    flow_info->tls.not_after  = flow_info->ndpi_flow->protos.tls.notAfter;

    /* ALPN */
    ndpi_snprintf(flow_info->tls.alpn,
                  sizeof(flow_info->tls.alpn),
                  "%s", flow_info->ndpi_flow->protos.tls.alpn);

    /* JA3 / JA3S fingerprints */
    ndpi_snprintf(flow_info->tls.ja3_hash,
                  sizeof(flow_info->tls.ja3_hash),
                  "%s", flow_info->ndpi_flow->protos.tls.ja3_hash);
    ndpi_snprintf(flow_info->tls.ja3s_hash,
                  sizeof(flow_info->tls.ja3s_hash),
                  "%s", flow_info->ndpi_flow->protos.tls.ja3s_hash);

    /* Supported versions */
    ndpi_snprintf(flow_info->tls.supported_versions,
                  sizeof(flow_info->tls.supported_versions),
                  "%s", flow_info->ndpi_flow->protos.tls.supported_versions);
#else
    /* Minimal handling – just mark the flow as TLS/QUIC. */
    flow_info->info_type = INFO_GENERIC;
#endif
  }