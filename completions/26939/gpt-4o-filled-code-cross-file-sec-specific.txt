if (LocaleCompare(name, "xmp") == 0)
  {
    // Find the xpacket end marker
    const char *xpacket_end = "<?xpacket end=\"w\"?>";
    unsigned char *marker = (unsigned char *) strstr((const char *) profile->datum, xpacket_end);
    if (marker != NULL)
    {
      // Truncate the profile data at the end marker
      profile->length = (size_t) (marker - profile->datum) + strlen(xpacket_end);
    }
  }
  else if (LocaleCompare(name, "exif") == 0)
  {
    // Check if the profile starts with a byte order marker
    const unsigned char exif_header[] = { 0x45, 0x78, 0x69, 0x66, 0x00, 0x00 };
    if (profile->length >= 6 && memcmp(profile->datum, exif_header, 6) != 0)
    {
      // Prepend the "Exif" header to the profile data
      size_t new_length = profile->length + sizeof(exif_header);
      unsigned char *new_datum = (unsigned char *) AcquireQuantumMemory(new_length, sizeof(*new_datum));
      if (new_datum == NULL)
        return; // Handle memory allocation failure
      memcpy(new_datum, exif_header, sizeof(exif_header));
      memcpy(new_datum + sizeof(exif_header), profile->datum, profile->length);
      RelinquishMagickMemory(profile->datum);
      profile->datum = new_datum;
      profile->length = new_length;
    }
  }