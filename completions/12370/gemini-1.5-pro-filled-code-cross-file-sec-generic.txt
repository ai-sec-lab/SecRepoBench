if (avctx->codec_id == AV_CODEC_ID_HYMT) {
        slices_info_offset = buf_size - 4 * AV_RL32(buf + buf_size - 4);
        nb_slices = AV_RL32(buf + slices_info_offset);
        if (nb_slices > (unsigned)INT_MAX / 8 ||
            nb_slices > (unsigned)(buf_size - slices_info_offset - 4) / 8 ||
            slices_info_offset > (unsigned)buf_size - 4 - 8 * nb_slices)
            return AVERROR_INVALIDDATA;

        slice_height = height / nb_slices;

        if (!slice_height || (height % nb_slices))
            return AVERROR_INVALIDDATA;
    } else {
        nb_slices = 1;
        slice_height = height;
    }