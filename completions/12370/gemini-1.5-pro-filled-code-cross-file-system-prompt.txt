if (avctx->codec_id == AV_CODEC_ID_HYMT) {
        slices_info_offset = AV_RL32(avpkt->data + buf_size - 4);
        if (slices_info_offset > buf_size - 4)
            return AVERROR_INVALIDDATA;

        nb_slices = AV_RL32(avpkt->data + slices_info_offset);
        if (nb_slices > (unsigned)(buf_size - slices_info_offset - 4) / 8 || !nb_slices)
            return AVERROR_INVALIDDATA;

        slice_height = height / nb_slices;
        if (slice_height <= 0 || nb_slices * slice_height > height)
            return AVERROR_INVALIDDATA;

    } else {
        nb_slices = 1;
        slice_height = height;
    }