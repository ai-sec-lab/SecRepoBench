if (avctx->codec_id == AV_CODEC_ID_HYMT) {
        // Validate the buffer size and ensure it is sufficient for the expected data
        if (buf_size < sizeof(int) * 2) {
            return AVERROR_INVALIDDATA;
        }

        // Read the number of slices and slice height from the end of the packet data
        nb_slices = AV_RL32(avpkt->data + buf_size - sizeof(int) * 2);
        slice_height = AV_RL32(avpkt->data + buf_size - sizeof(int));

        // Ensure that the number of slices is positive and does not exceed the height
        if (nb_slices <= 0 || slice_height <= 0 || nb_slices * slice_height > height) {
            return AVERROR_INVALIDDATA;
        }

        // Calculate the offset for slice information
        slices_info_offset = buf_size - (nb_slices * sizeof(int) * 2);
    } else {
        // Default to a single slice covering the full height
        nb_slices = 1;
        slice_height = height;
        slices_info_offset = buf_size; // No additional slice info
    }