protected int
file_regexec(file_regex_t *rx, const char *str, size_t nmatch,
    regmatch_t* pmatch, int eflags)
{
    // Validate inputs to prevent buffer overflows and ensure proper usage
    if (rx == NULL || str == NULL || pmatch == NULL || nmatch == 0) {
        return REG_BADPAT; // Return an error code for invalid parameters
    }

    // Execute the compiled regular expression against the given string
    int result = regexec(&rx->rx, str, nmatch, pmatch, eflags);

    // Handle the result of the regexec function call
    if (result == 0) {
        // Match found
        return 0; // Success
    } else if (result == REG_NOMATCH) {
        // No match found
        return REG_NOMATCH; // Indicate no match
    } else {
        // An error occurred during execution
        return result; // Return the error code
    }
}