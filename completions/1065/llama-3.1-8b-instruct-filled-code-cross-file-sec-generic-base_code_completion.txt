protected int
file_regexec(file_regex_t *rx, const char *str, size_t nmatch,
    regmatch_t* pmatch, int eflags)
{
    // Execute the compiled regular expression against the given string.
    // Ensure that the regex compilation was successful with an assertion.
    // The result is stored in pmatch, up to nmatch entries, with execution flags
    // specified by eflags. Return the result of regexec function call.
    int result = regexec(&rx->rx, str, nmatch, pmatch, eflags);
    if (result == REG_NOMATCH) {
        // If the regular expression does not match, return the result.
        return result;
    } else if (result == REG_ESPACE) {
        // If there is an error due to lack of memory, free the regex object and return the result.
        file_regfree(rx);
        return result;
    } else if (result == REG_BADPAT) {
        // If there is an error in the regular expression, free the regex object and return the result.
        file_regfree(rx);
        return result;
    } else {
        // If the regular expression matches, return the result.
        return result;
    }
}