// return the decrypted string
    xmlXPathReturnString(ctxt, ret);

    // Clean up the allocated memory for the decrypted string
    if (ret != NULL) {
        xmlFree(ret);
    }