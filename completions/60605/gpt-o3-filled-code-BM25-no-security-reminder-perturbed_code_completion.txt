if(packet->content_disposition_line.ptr[attachment_len] == '\"') {
	    /* The filename starts with a quote */
	    if(packet->content_disposition_line.ptr[packet->content_disposition_line.len-1] != '\"') {
	      /* format: filename="file_name            (no trailing quote) */
	      u_int16_t filename_len = attachment_filename_len - 1; /* skip the leading quote */

	      if(filename_len > 0) {
		flow->http.filename = ndpi_malloc(filename_len + 1);
		if(flow->http.filename != NULL) {
		  strncpy(flow->http.filename,
			  (char*)packet->content_disposition_line.ptr + attachment_len + 1,
			  filename_len);
		  flow->http.filename[filename_len] = '\0';
		}
	      }
	    } else if(attachment_filename_len > 2) {
	      /* format: filename="file_name"          (leading and trailing quote) */
	      u_int16_t filename_len = attachment_filename_len - 2; /* skip both quotes */

	      flow->http.filename = ndpi_malloc(filename_len + 1);
	      if(flow->http.filename != NULL) {
		strncpy(flow->http.filename,
			(char*)packet->content_disposition_line.ptr + attachment_len + 1,
			filename_len);
		flow->http.filename[filename_len] = '\0';
	      }
	    }
	  } else {