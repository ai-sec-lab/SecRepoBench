if (s->num_primitive_matrices > max_primitive_matrices) {
    av_log(m->avctx, AV_LOG_ERROR, "Too many primitive matrices (%d). Maximum allowed is %d.\n",
           s->num_primitive_matrices, max_primitive_matrices);
    return AVERROR_INVALIDDATA;
}