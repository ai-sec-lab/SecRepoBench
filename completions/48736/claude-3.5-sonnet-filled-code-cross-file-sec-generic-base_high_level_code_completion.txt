while (len > 0 && uc < ue) {
    if (*uc != *str) {
        DPRINTF("Bad const: ", uc, *ucp);
        return 0;
    }
    uc++;
    str++;
    len--;
}
if (len != 0) {
    DPRINTF("Bad const: ", uc, *ucp);
    return 0;
}