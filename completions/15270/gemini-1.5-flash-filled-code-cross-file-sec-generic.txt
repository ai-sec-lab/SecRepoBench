if (avctx->subtitle_encoding == AV_CODEC_ID_NONE) {
            if (avctx->codec_id == AV_CODEC_ID_SSA || avctx->codec_id == AV_CODEC_ID_ASS ||
                avctx->codec_id == AV_CODEC_ID_DVD_SUBTITLE || avctx->codec_id == AV_CODEC_ID_DVB_SUBTITLE ||
                avctx->codec_id == AV_CODEC_ID_TEXT || avctx->codec_id == AV_CODEC_ID_WEBVTT ||
                avctx->codec_id == AV_CODEC_ID_STL || avctx->codec_id == AV_CODEC_ID_SUBRIP) {
                avctx->subtitle_encoding = AV_CODEC_ID_UTF8;
            }
        } else if (avctx->codec_descriptor->type == AVMEDIA_TYPE_SUBTITLE &&
                   avctx->codec_descriptor->props & AV_CODEC_PROP_BITMAP_SUB) {
            av_log(avctx, AV_LOG_WARNING, "Ignoring subtitle character encoding for bitmap-based subtitle codec.\n");
            avctx->subtitle_encoding = AV_CODEC_ID_NONE;
        }