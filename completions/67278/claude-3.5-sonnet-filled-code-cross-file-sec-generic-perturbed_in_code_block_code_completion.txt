u32 hdr, size;
u32 nb_frames = 0;
while (gf_bs_available(bs)) {
    hdr = gf_bs_read_u32(bs);
    if ((hdr & 0xFFF00000) != 0x56E00000) {
        gf_bs_seek(bs, 1 + gf_bs_get_position(bs));
        nb_skip++;
        continue;
    }
    size = ((hdr >> 13) & 0x1FFF) + 3;
    if (size > gf_bs_available(bs))
        break;
    
    memset(&acfg, 0, sizeof(GF_M4ADecSpecInfo));
    gf_bs_seek(bs, 3 + gf_bs_get_position(bs));
    gf_m4a_parse_config(bs, &acfg, 0);
    if (acfg.base_sr_index != 15) {
        nb_frames++;
        if (nb_frames >= 2)
            break;
    }
    gf_bs_seek(bs, size + gf_bs_get_position(bs) - 3);
}
numframes = nb_frames;