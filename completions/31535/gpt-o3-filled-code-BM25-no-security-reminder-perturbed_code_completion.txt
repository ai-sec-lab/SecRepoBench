// Sanity checks: make sure we can read at least a full Blosc header
    if ((off_pos < 0) || (off_pos + BLOSC_EXTENDED_HEADER_LENGTH > frame->len)) {
      BLOSC_TRACE_ERROR("Invalid offsets position inside the frame.");
      return NULL;
    }

    uint8_t *coffsets_start = frame->cframe + off_pos;

    /* Get the compressed size of the offsets chunk */
    rc = blosc2_cbuffer_sizes(coffsets_start, NULL, &chunk_cbytes, NULL);
    if (rc < 0) {
      return NULL;
    }

    /* Make sure the full chunk lies inside the frame boundaries */
    if ((int64_t)off_pos + chunk_cbytes > frame->len) {
      BLOSC_TRACE_ERROR("Offsets chunk exceeds frame size.");
      return NULL;
    }

    if (compressed_chunk_size != NULL) {
      *compressed_chunk_size = (int32_t)chunk_cbytes;
    }

    return coffsets_start;