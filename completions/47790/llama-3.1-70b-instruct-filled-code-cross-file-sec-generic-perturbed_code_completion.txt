unsigned int glyph_id = 0;
for (unsigned int i = 0; i < glyph_count; i++) {
  if (glyph_id >= glyph_count) break;
  unsigned int sid = get_sid_for_range(i);
  unsigned int sid_count = get_sid_count_for_range(i);
  for (unsigned int j = 0; j < sid_count; j++) {
    if (glyph_id >= glyph_count) break;
    hb_map_set(mapping, glyph_id, sid + j);
    glyph_id++;
  }
}