if (TIFFGetFieldDefaulted(tiff,TIFFTAG_RESOLUTIONUNIT,&units) == 1)
{
  if (units == RESUNIT_INCH)
    image->units=PixelsPerInchResolution;
  if (units == RESUNIT_CENTIMETER)
    image->units=PixelsPerCentimeterResolution;
}
if ((TIFFGetFieldDefaulted(tiff,TIFFTAG_XRESOLUTION,&x_resolution) == 1) &&
    (TIFFGetFieldDefaulted(tiff,TIFFTAG_YRESOLUTION,&y_resolution) == 1))
{
  image->resolution.x=x_resolution;
  image->resolution.y=y_resolution;
}
if (TIFFGetFieldDefaulted(tiff,TIFFTAG_XPOSITION,&x_position) == 1)
  image->page.x=(ssize_t) ceil(x_position*image->resolution.x-0.5);
if (TIFFGetFieldDefaulted(tiff,TIFFTAG_YPOSITION,&y_position) == 1)
  image->page.y=(ssize_t) ceil(y_position*image->resolution.y-0.5);
if (TIFFGetField(tiff,TIFFTAG_EXIFIFD,&value) == 1)
{
  TIFF
    *exif;

  exif=TIFFClientOpen("exif",NULL,(thandle_t) image,TIFFReadBlob,
    TIFFWriteBlob,TIFFSeekBlob,TIFFCloseBlob,TIFFGetBlobSize,TIFFMapBlob,
    TIFFUnmapBlob);
  if (exif!= (TIFF *) NULL)
  {
    TIFFSetSubDirectory(exif,value);
    TIFFGetEXIFProperties(exif,image,exception);
    TIFFClose(exif);
  }
}