/*
    Handle parenthesized sub-expressions.
  */
  if (*expression == '(')
    {
      /*
        Guard against excessively deep parenthesis recursion.
      */
      if (*recursion_depth >= FxMaxParenthesisDepth)
        {
          (void) ThrowMagickException(exception,GetMagickModule(),OptionError,
            "ParenthesisDepthExceeded","`%s'",expression);
          FxResult(0.0);
        }

      /*
        Locate the matching right parenthesis.
      */
      p=FxSubexpression(expression,exception);
      if (p == (const char *) NULL)
        {
          (void) ThrowMagickException(exception,GetMagickModule(),OptionError,
            "UnableToParseExpression","`%s'",expression);
          FxResult(0.0);
        }

      /*
        Evaluate the expression inside the parentheses.
      */
      (*recursion_depth)++;
      (void) CopyMagickString(subexpression,expression+1,(size_t)
        (p-expression));
      subexpression[p-expression-1]='\0';
      alpha=FxEvaluateSubexpression(fx_info,channel,x,y,subexpression,
        recursion_depth,beta,exception);
      (*recursion_depth)--;

      /*
        If nothing follows the closing parenthesis return the result,
        otherwise evaluate the remainder of the expression.
      */
      p++;  /* step past the ')' */
      while (isspace((int) ((unsigned char) *p)) != 0)
        p++;
      if (*p == '\0')
        FxResult(alpha);

      gamma=FxEvaluateSubexpression(fx_info,channel,x,y,p,recursion_depth,
        beta,exception);
      FxResult(gamma);
    }