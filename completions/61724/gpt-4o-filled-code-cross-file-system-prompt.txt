hb_map_t new_gid_to_var_data;
    hb_map_init(&new_gid_to_var_data);

    for (unsigned int i = 0; i < c->plan->num_glyphs(); i++)
    {
      hb_codepoint_t new_gid = c->plan->new_gid_for_old_gid(i);
      if (new_gid != HB_MAP_VALUE_INVALID)
      {
        glyph_variation_data_t var_data;
        if (!c->get_glyph_variation_data(i, var_data))
        {
          hb_map_fini(&new_gid_to_var_data);
          return false;
        }
        hb_map_set(&new_gid_to_var_data, new_gid, var_data);
      }
    }

    if (c->plan->first_gid_is_zero() && !c->plan->notdef_outline())
    {
      glyph_variation_data_t empty_data;
      hb_map_set(&new_gid_to_var_data, 0, empty_data);
    }

    if (hb_map_get_population(&new_gid_to_var_data) == 0)
    {
      hb_map_fini(&new_gid_to_var_data);
      return false;
    }

    bool result = glyph_vars.create(c->plan->axis_count(),
                                    c->plan->shared_tuples(),
                                    c->plan,
                                    new_gid_to_var_data);

    hb_map_fini(&new_gid_to_var_data);
    return result;