unsigned int axis_count = font->get_axis_count ();
    const hb_array_t<const hb_variation_axis_t> axes = font->get_axes ();

    glyph_id_map_t::const_iterator it = this->glyph_id_map.begin ();
    glyph_id_map_t::const_iterator end = this->glyph_id_map.end ();

    bool has_default_zero_id = false;

    /* populate variations data for new glyph ids */
    hb_hashmap_t<hb_codepoint_t, glyph_variations_data_t> glyph_variations_data;
    for (; it != end; ++it)
    {
      hb_codepoint_t new_gid = it->first;
      hb_codepoint_t old_gid = it->second;

      if (unlikely (!new_gid && !(c->flags & HB_SUBSET_FLAGS_NOTDEF_OUTLINE)))
      {
        has_default_zero_id = true;
        continue;
      }

      glyph_variations_data_t data = get_glyph_var_data (old_gid);
      if (!data.has_data ()) continue;

      glyph_variations_data.set (new_gid, data);
    }

    if (has_default_zero_id)
    {
      glyph_variations_data_t data;
      data.init_default (axes.length);
      glyph_variations_data.set (0, data);
    }

    if (glyph_variations_data.in_error ())
      return false;

    return glyph_vars.create (axis_count,
                              font->get_shared_tuples (),
                              &c->plan,
                              glyph_variations_data);