unsigned int axis_count;
    OT::TupleVariationHeader shared_tuples;

    hb_hashmap_t<hb_codepoint_t, glyph_variation_data_t> variations_map;

    if (unlikely (!c->plan->old_gid_map.iter_init ())) return false;

    bool has_zero = false;
    do
    {
      hb_codepoint_t new_gid = c->plan->old_gid_map.iter_next ();

      if (new_gid == 0)
        has_zero = true;

      glyph_variation_data_t data = glyph_variation_data_for_gid (c, this->gids[c->plan->old_gid_map[new_gid]],
                                                                  axis_count, shared_tuples);

      if (unlikely (!variations_map.set (new_gid, data)))
        return false;

    } while (c->plan->old_gid_map.iter_next ());

    if (!has_zero && !(c->plan->flags & HB_SUBSET_FLAGS_NOTDEF_OUTLINE))
    {
      glyph_variation_data_t data = glyph_variation_data_for_gid (c, 0, axis_count, shared_tuples);
      if (unlikely (!variations_map.set (0, data)))
        return false;
    }


    if (unlikely (variations_map.in_error ()))
      return false;

    return glyph_vars.create (axis_count, shared_tuples, c->plan, variations_map);