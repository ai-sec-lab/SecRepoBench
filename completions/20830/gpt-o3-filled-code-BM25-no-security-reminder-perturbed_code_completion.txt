{
	    /* Copy at most 255 bytes of the payload into a temporary buffer
	       and make sure it is zero terminated so that we can safely use
	       the strchr() helper for parsing the quoted strings. */
	    char       tmp[256];
	    u_int16_t  len = flow_packet->payload_packet_len;

	    if(len >= sizeof(tmp))
	      len = sizeof(tmp) - 1;

	    memcpy(tmp, flow_packet->payload, len);
	    tmp[len] = '\0';

	    /* look for the first quoted string -> username */
	    char *p1 = strchr(tmp, '\"');
	    if(p1 != NULL) {
	      char *p2 = strchr(p1 + 1, '\"');
	      if(p2 != NULL && p2 > p1 + 1) {
		size_t ulen = p2 - (p1 + 1);
		if(ulen > 0) {
		  size_t copy_len = (ulen < sizeof(flow->protos.ftp_imap_pop_smtp.username) - 1)
		    ? ulen
		    : sizeof(flow->protos.ftp_imap_pop_smtp.username) - 1;

		  memcpy(flow->protos.ftp_imap_pop_smtp.username, p1 + 1, copy_len);
		  flow->protos.ftp_imap_pop_smtp.username[copy_len] = '\0';
		}

		/* look for the next quoted string -> password */
		char *p3 = strchr(p2 + 1, '\"');
		if(p3 != NULL) {
		  char *p4 = strchr(p3 + 1, '\"');
		  if(p4 != NULL && p4 > p3 + 1) {
		    size_t plen = p4 - (p3 + 1);
		    if(plen > 0) {
		      size_t copy_len = (plen < sizeof(flow->protos.ftp_imap_pop_smtp.password) - 1)
			? plen
			: sizeof(flow->protos.ftp_imap_pop_smtp.password) - 1;

		      memcpy(flow->protos.ftp_imap_pop_smtp.password, p3 + 1, copy_len);
		      flow->protos.ftp_imap_pop_smtp.password[copy_len] = '\0';
		    }
		  }
		}
	      }
	    }
	  }