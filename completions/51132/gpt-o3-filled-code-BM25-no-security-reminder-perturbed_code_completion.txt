/* type */
        flb_sds_t type_str;

        type_str = get_parser_key(config, cf, s, "type");
        if (!type_str) {
            flb_error("[multiline_parser] no 'type' defined for parser '%s' "
                      "in file '%s'", name ? name : "(unknown)", cfg);
            goto fconf_error;
        }

        if (strcasecmp(type_str, "regex") == 0) {
            type = FLB_ML_REGEX;
        }
        else if (strcasecmp(type_str, "endswith") == 0) {
            type = FLB_ML_ENDSWITH;
        }
#ifdef FLB_ML_REGEX_CONDENSED
        else if (strcasecmp(type_str, "regex_condensed") == 0) {
            type = FLB_ML_REGEX_CONDENSED;
        }
#endif
#ifdef FLB_ML_ENDSWITH_CONDENSED
        else if (strcasecmp(type_str, "endswith_condensed") == 0) {
            type = FLB_ML_ENDSWITH_CONDENSED;
        }
#endif
        else {
            flb_error("[multiline_parser] invalid 'type' (%s) for parser '%s' "
                      "in file '%s'", type_str, name, cfg);
            flb_sds_destroy(type_str);
            goto fconf_error;
        }
        flb_sds_destroy(type_str);