for (i = 0; i < TagCount; i++) {
        cmsUInt32Number size;
        cmsUInt32Number offset;

        if (!_cmsReadUInt32Number(io, &offset) ||
            !_cmsReadUInt32Number(io, &size)) {
            return FALSE;
        }

        if (offset + size > HeaderSize) {
            cmsSignalError(Icc->ContextID, cmsERROR_RANGE, "Tag offset out of range");
            return FALSE;
        }

        if (!_cmsReadTagSignature(io, &Tag.sig)) return FALSE;

        if (Icc->TagCount >= MAX_TABLE_TAG) {
            cmsSignalError(Icc->ContextID, cmsERROR_RANGE, "Too many tags");
            return FALSE;
        }

        Icc->TagOffsets[Icc->TagCount] = offset;
        Icc->TagSizes[Icc->TagCount] = size;
        Icc->TagSignatures[Icc->TagCount] = Tag.sig;
        Icc->TagLinked[Icc->TagCount] = 0;
        Icc->TagCount++;
    }

    // Set links between tags
    if (!SetLinks(Icc)) return FALSE;

    return TRUE;