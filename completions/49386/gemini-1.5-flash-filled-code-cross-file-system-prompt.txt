for (i = 0; i < TagCount; i++) {
        if (!_cmsReadTagEntry(io, &Tag)) return FALSE;

        // Check if the tag is within the profile bounds
        if (Tag.Offset + Tag.Size > HeaderSize) {
            cmsSignalError(Icc ->ContextID, cmsERROR_RANGE, "Tag %d out of bounds", i);
            return FALSE;
        }

        // Check for duplicate tags
        for (j = 0; j < Icc ->TagCount; j++) {
            if (Icc ->TagSignatures[j] == Tag.Signature) {
                cmsSignalError(Icc ->ContextID, cmsERROR_DUPLICATE_TAG, "Duplicate tag %d", i);
                return FALSE;
            }
        }

        // Record the tag information
        Icc ->TagSignatures[Icc ->TagCount] = Tag.Signature;
        Icc ->TagOffsets[Icc ->TagCount] = Tag.Offset;
        Icc ->TagSizes[Icc ->TagCount] = Tag.Size;
        Icc ->TagLinked[Icc ->TagCount] = 0;
        Icc ->TagCount++;
    }

    // Set links between tags
    if (!SetLinks(Icc)) return FALSE;

    return TRUE;