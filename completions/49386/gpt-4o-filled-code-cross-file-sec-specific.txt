for (i = 0; i < TagCount; i++) {
        if (!_cmsReadUInt32Number(io, &Tag.sig) ||
            !_cmsReadUInt32Number(io, &Tag.offset) ||
            !_cmsReadUInt32Number(io, &Tag.size)) {
            return FALSE;
        }

        // Adjust endianness
        Tag.sig = _cmsAdjustEndianess32(Tag.sig);
        Tag.offset = _cmsAdjustEndianess32(Tag.offset);
        Tag.size = _cmsAdjustEndianess32(Tag.size);

        // Check if the tag is within the bounds of the file
        if (Tag.offset + Tag.size > HeaderSize) {
            cmsSignalError(Icc->ContextID, cmsERROR_RANGE, "Tag out of bounds");
            return FALSE;
        }

        // Record the tag
        Icc->TagNames[i] = Tag.sig;
        Icc->TagOffsets[i] = Tag.offset;
        Icc->TagSizes[i] = Tag.size;

        // Check for linked tags
        for (j = 0; j < i; j++) {
            if (Icc->TagOffsets[j] == Tag.offset && Icc->TagSizes[j] == Tag.size) {
                Icc->TagLinked[i] = Icc->TagNames[j];
                break;
            }
        }

        Icc->TagCount++;
    }

    // Set links between tags
    if (!SetLinks(Icc)) {
        return FALSE;
    }

    return TRUE;