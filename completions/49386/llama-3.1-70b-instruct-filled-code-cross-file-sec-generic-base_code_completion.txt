for (i = 0; i < TagCount; i++) {
    if (!_cmsReadTagEntry(io, &Tag)) return FALSE;

    // Validate tag signature
    if (!_cmsIsValidTagSignature(Tag.tag)) {
        cmsSignalError(Icc ->ContextID, cmsERROR_RANGE, "Invalid tag signature 0x%08x", Tag.tag);
        return FALSE;
    }

    // Validate tag offset and size
    if (Tag.offset + Tag.size > HeaderSize) {
        cmsSignalError(Icc ->ContextID, cmsERROR_RANGE, "Tag offset or size out of range");
        return FALSE;
    }

    // Record tag signature, offset, and size
    Icc ->TagSignatures[i] = Tag.tag;
    Icc ->TagOffsets[i]    = Tag.offset;
    Icc ->TagSizes[i]      = Tag.size;

    // Search for linked tags
    Icc ->TagLinked[i] = _cmsSearchTag(Icc, Tag.tag, TRUE);

    // Increment tag count
    Icc -> TagCount++;
}