for (i = 0; i < TagCount; i++) {

        if (!io -> Read(io, &Tag, sizeof(cmsTagEntry), 1)) return FALSE;

        Icc -> TagSignatures[Icc -> TagCount] = _cmsAdjustEndianess32(Tag.sig);
        Icc -> TagOffsets[Icc -> TagCount]   = _cmsAdjustEndianess32(Tag.offset);
        Icc -> TagSizes[Icc -> TagCount]     = _cmsAdjustEndianess32(Tag.size);

        // Basic sanity check
        if (Icc ->TagOffsets[Icc -> TagCount] + Icc -> TagSizes[Icc -> TagCount] > HeaderSize ||
            Icc ->TagOffsets[Icc -> TagCount] < sizeof(cmsICCHeader) + sizeof(cmsUInt32Number) + TagCount * sizeof(cmsTagEntry)) {

            char String[5];
            _cmsTagSignature2String(String, Icc -> TagSignatures[Icc -> TagCount]);
            cmsSignalError(Icc ->ContextID, cmsERROR_BAD_TAG, "Tag '%s' inconsistent offset/size", String);
            return FALSE;
        }

        // Check for duplicated tags. Some buggy profiles do embed same tag more than once.
        for (j=0; j < Icc -> TagCount; j++) {

            if (Icc -> TagOffsets[j] == Icc -> TagOffsets[Icc -> TagCount] &&
                Icc -> TagSizes[j]   == Icc -> TagSizes[Icc -> TagCount]) {

                    Icc ->TagLinked[Icc -> TagCount] = Icc -> TagSignatures[j];
                    break;
            }
        }

        Icc -> TagCount++;
    }

    return TRUE;