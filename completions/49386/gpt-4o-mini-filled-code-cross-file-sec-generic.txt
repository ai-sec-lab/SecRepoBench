for (i = 0; i < TagCount; i++) {
        cmsTagEntry* currentTag = &Tag; // Pointer to the current tag entry
        cmsTagSignature tagSig;
        cmsUInt32Number tagOffset, tagSize;

        // Read the tag signature
        if (!_cmsReadUInt32Number(io, &tagSig)) {
            cmsSignalError(Icc->ContextID, cmsERROR_READ, "Failed to read tag signature");
            return FALSE;
        }

        // Read the tag offset
        if (!_cmsReadUInt32Number(io, &tagOffset)) {
            cmsSignalError(Icc->ContextID, cmsERROR_READ, "Failed to read tag offset");
            return FALSE;
        }

        // Read the tag size
        if (!_cmsReadUInt32Number(io, &tagSize)) {
            cmsSignalError(Icc->ContextID, cmsERROR_READ, "Failed to read tag size");
            return FALSE;
        }

        // Sanity checks for tag offset and size
        if (tagOffset + tagSize > Icc->IOhandler->ReportedSize) {
            cmsSignalError(Icc->ContextID, cmsERROR_RANGE, "Tag offset and size exceed profile size");
            return FALSE;
        }

        // Store the tag information in the Icc structure
        Icc->TagSignatures[Icc->TagCount] = tagSig;
        Icc->TagOffsets[Icc->TagCount] = tagOffset;
        Icc->TagSizes[Icc->TagCount] = tagSize;

        // Check for linked tags
        if (tagSig == cmsLinkTagSignature) {
            Icc->TagLinked[Icc->TagCount] = tagSig; // Store linked tag signature
        } else {
            Icc->TagLinked[Icc->TagCount] = 0; // No link
        }

        Icc->TagCount++; // Increment the tag count
    }

    // Set links for the tags
    if (!SetLinks(Icc)) {
        cmsSignalError(Icc->ContextID, cmsERROR_INTERNAL, "Failed to set tag links");
        return FALSE;
    }

    return TRUE; // Successfully read and processed all tags