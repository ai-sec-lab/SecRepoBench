for (i = 0; i < TagCount; i++) {
    if (!_cmsReadUInt32Number(io, &Tag.sig)) return FALSE;
    if (!_cmsReadUInt32Number(io, &Tag.offset)) return FALSE;
    if (!_cmsReadUInt32Number(io, &Tag.size)) return FALSE;

    // Perform sanity checks
    if (Tag.offset >= HeaderSize || (Tag.offset + Tag.size) > HeaderSize) {
        cmsSignalError(Icc->ContextID, cmsERROR_CORRUPTION, "Tag %d is outside profile bounds", i);
        continue;
    }

    if (Tag.size < 8) {
        cmsSignalError(Icc->ContextID, cmsERROR_CORRUPTION, "Tag %d is too small", i);
        continue;
    }

    // Check for links
    for (j = 0; j < i; j++) {
        if ((Icc->TagOffsets[j] == Tag.offset) && (Icc->TagSizes[j] == Tag.size)) {
            Icc->TagLinked[i] = Icc->TagNames[j];
            break;
        }
    }

    // Record the tag
    Icc->TagNames[Icc->TagCount] = Tag.sig;
    Icc->TagOffsets[Icc->TagCount] = Tag.offset;
    Icc->TagSizes[Icc->TagCount] = Tag.size;
    Icc->TagCount++;
}

return TRUE;