for (i = 0; i < TagCount; i++) {
    if (!_cmsReadUInt32Number(io, &TagEntry.sig)) return FALSE;
    if (!_cmsReadUInt32Number(io, &TagEntry.offset)) return FALSE;
    if (!_cmsReadUInt32Number(io, &TagEntry.size)) return FALSE;

    // Validate tag offset and size
    if (TagEntry.offset >= HeaderSize || TagEntry.size > (HeaderSize - TagEntry.offset)) {
        cmsSignalError(Icc->ContextID, cmsERROR_CORRUPTION, "Invalid tag offset or size");
        return FALSE;
    }

    // Check for duplicate tags
    for (j = 0; j < Icc->TagCount; j++) {
        if (Icc->TagNames[j] == TagEntry.sig) {
            cmsSignalError(Icc->ContextID, cmsERROR_CORRUPTION, "Duplicate tag found");
            return FALSE;
        }
    }

    // Add the tag to the profile
    Icc->TagNames[Icc->TagCount] = TagEntry.sig;
    Icc->TagOffsets[Icc->TagCount] = TagEntry.offset;
    Icc->TagSizes[Icc->TagCount] = TagEntry.size;
    Icc->TagCount++;

    if (Icc->TagCount >= MAX_TABLE_TAG) {
        cmsSignalError(Icc->ContextID, cmsERROR_RANGE, "Too many tags");
        return FALSE;
    }
}

return TRUE;