for (i = 0; i < TagCount; i++) {
        cmsTagEntry* tag = &Icc->Tags[Icc->TagCount];

        // Read the tag signature
        if (!_cmsReadUInt32Number(io, &tag->Signature)) return FALSE;

        // Read the tag offset
        if (!_cmsReadUInt32Number(io, &tag->Offset)) return FALSE;

        // Read the tag size
        if (!_cmsReadUInt32Number(io, &tag->Size)) return FALSE;

        // Sanity check: ensure the tag offset and size are within the profile bounds
        if (tag->Offset + tag->Size > Icc->IOhandler->ReportedSize) {
            cmsSignalError(Icc->ContextID, cmsERROR_RANGE, "Tag %d exceeds profile size", i);
            return FALSE;
        }

        // Record the tag entry
        Icc->TagCount++;

        // Check for linked tags (if any)
        if (tag->Signature == cmsLinkTag) {
            Icc->TagLinked[Icc->TagCount - 1] = tag->Signature;
        } else {
            Icc->TagLinked[Icc->TagCount - 1] = 0; // No link
        }
    }

    // Set links for the tags
    SetLinks(Icc);

    return TRUE;