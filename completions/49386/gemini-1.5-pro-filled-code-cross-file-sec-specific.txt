for (i = 0; i < TagCount; i++) {

        if (io -> Read(io, &Tag, sizeof(cmsTagEntry), 1) != 1) return FALSE;

        Icc -> TagNames[Icc -> TagCount] = _cmsAdjustEndianess32(Tag.sig);
        Icc -> TagOffsets[Icc -> TagCount] = _cmsAdjustEndianess32(Tag.offset);
        Icc -> TagSizes[Icc -> TagCount] = _cmsAdjustEndianess32(Tag.size);
        Icc ->TagLinked[Icc->TagCount] = (cmsTagSignature) 0;

        // Basic sanity check
        if (Icc -> TagOffsets[Icc -> TagCount] + Icc -> TagSizes[Icc -> TagCount] > HeaderSize ||
            Icc -> TagOffsets[Icc -> TagCount] < sizeof(cmsICCHeader) ||
            Icc -> TagSizes[Icc -> TagCount] == 0) {

            char String[5];
            _cmsTagSignature2String(String, Icc -> TagNames[Icc -> TagCount]);
            cmsSignalError(Icc ->ContextID, cmsERROR_BAD_TAG, "Tag '%s' inconsistent information. Bad offset/size", String);
            return FALSE;
        }

        // Check for duplicated tags.
        for (j = 0; j < Icc -> TagCount; j++) {
            if (Icc -> TagOffsets[j] == Icc -> TagOffsets[Icc -> TagCount] &&
                Icc -> TagSizes[j] == Icc -> TagSizes[Icc -> TagCount] &&
                Icc -> TagNames[j] != Icc -> TagNames[Icc -> TagCount])
            {
                Icc ->TagLinked[Icc->TagCount] = Icc -> TagNames[j];
            }
        }

        Icc -> TagCount++;
    }

    return TRUE;