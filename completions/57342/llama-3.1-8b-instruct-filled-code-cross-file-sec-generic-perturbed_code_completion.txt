// <MASK>
if (has_avar) {
  seg_maps = fontface->table.avar->get_segment_maps ();
  for (unsigned axis_index = 0; axis_index < axes.length; axis_index++) {
    const OT::AxisRecord &axis = axes[axis_index];
    if (plan->user_axes_location.has (axis.tag)) {
      float value = plan->user_axes_location.get (axis.tag);
      float remapped_value = seg_maps->remap (axis, value);
      plan->normalized_coords[axis_index] = remapped_value;
    } else {
      plan->normalized_coords[axis_index] = axis.get_default ();
      if (axis.is_pinned ()) {
        axis_not_pinned = false;
      }
    }
  }
} else {
  for (unsigned axis_index = 0; axis_index < axes.length; axis_index++) {
    const OT::AxisRecord &axis = axes[axis_index];
    if (plan->user_axes_location.has (axis.tag)) {
      float value = plan->user_axes_location.get (axis.tag);
      plan->normalized_coords[axis_index] = value;
    } else {
      plan->normalized_coords[axis_index] = axis.get_default ();
      if (axis.is_pinned ()) {
        axis_not_pinned = false;
      }
    }
  }
}
plan->all_axes_pinned =!axis_not_pinned;