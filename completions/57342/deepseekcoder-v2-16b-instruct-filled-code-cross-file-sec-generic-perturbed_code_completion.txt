for (unsigned axis_index = 0; axis_index < coords_length; axis_index++) {
    if (axes[axis_index].axisTag == tag) {
      float normalized_value = (design_coords[axis_index] - axes[axis_index].get_min()) /
                               (axes[axis_index].get_max() - axes[axis_index].get_min());
      if (has_avar) {
        const OT::SegmentMaps *seg_maps = fontface->table.avar->get_segment_maps();
        if (seg_maps) {
          plan->normalized_coords[axis_index] = seg_maps->map_value(normalized_value);
        } else {
          plan->normalized_coords[axis_index] = normalized_value;
        }
      } else {
        plan->normalized_coords[axis_index] = normalized_value;
      }
      if (plan->normalized_coords[axis_index] != 0) {
        plan->all_axes_pinned = false;
      }
    }
  }