n = mrb_get_argc(mrb);
  if (n == 0) {
    n = 1;
    if (len == 0) return mrb_nil_value();
  L_SHIFT:
    val = ARY_PTR(a)[0];
    ary_shift_n(mrb, a, n);
  }
  else {
    mrb_get_args(mrb, "i", &n);
    if (n < 0) {
      mrb_raisef(mrb, E_ARGUMENT_ERROR, "negative array size (or size too big)");
    }
    if (len < n) {
      val = mrb_ary_new_capa(mrb, 0);
      ARY_SET_LEN(a, 0);
    }
    else {
      val = ary_subseq(mrb, a, 0, n);
      ary_shift_n(mrb, a, n);
    }
  }