n = (mrb_int)mrb_integer(mrb_to_int(mrbstateptr, mrb_get_arg1(mrbstateptr)));
if (n <= 0) {
  if (n < 0) mrb_argnum_error(mrbstateptr, 1, 0, 1);
  return mrb_ary_new(mrbstateptr);
}
if (len < n) n = len;
if (n == 0) return mrb_ary_new(mrbstateptr);

val = mrb_ary_new_from_values(mrbstateptr, n, ARY_PTR(a));
if (ARY_SHARED_P(a)) {
L_SHIFT:
  a->as.heap.ptr += n;
  a->as.heap.len -= n;
  return val;
}