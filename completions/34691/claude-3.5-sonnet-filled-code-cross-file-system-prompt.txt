n = (mrb_get_args(mrb, "|i", &n) == 0) ? 1 : n;
if (n > len) n = len;
if (n <= 0) return mrb_ary_new(mrb);

if (ARY_SHARED_P(a)) {
  val = ary_subseq(mrb, a, 0, n);
L_SHIFT:
  a->as.heap.ptr += n;
  a->as.heap.len -= n;
  return val;
}

val = mrb_ary_new_from_values(mrb, n, ARY_PTR(a));