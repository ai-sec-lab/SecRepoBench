n = 1; // Default to shifting one element
  mrb_get_args(mrb, "|i", &n); // Get the number of elements to shift
  if (n < 0) {
    mrb_raise(mrb, E_ARGUMENT_ERROR, "negative array size");
  }
  if (n > len) {
    n = len; // If n is greater than the length, shift all elements
  }
  val = ARY_PTR(a)[0]; // Get the first element to return
  if (ARY_SHARED_P(a)) {
    ary_make_shared(mrb, a);
    goto L_SHIFT;
  }