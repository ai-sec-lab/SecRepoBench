n = (mrb_int)mrb_integer(mrb_to_int(mrb, mrb_get_arg1(mrb)));
if (n <= 0) {
  if (n < 0) mrb_raise(mrb, E_ARGUMENT_ERROR, "negative array size");
  return mrb_ary_new(mrb);
}
if (n > len) n = len;

if (ARY_SHARED_P(a)) {
  val = ary_subseq(mrb, a, 0, n);
L_SHIFT:
  a->as.heap.ptr += n;
  a->as.heap.len -= n;
  return val;
}

val = mrb_ary_new_from_values(mrb, n, ARY_PTR(a));