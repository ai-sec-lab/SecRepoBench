// Check if the object size is valid
                if (obj->size != (dat->byte - oldpos) && dat->version < R_11) {
                    LOG_WARN("Object size mismatch: expected %u, got %u",
                             obj->size, (unsigned)(dat->byte - oldpos));
                    // Adjust the size to prevent buffer overflow
                    obj->size = (dat->byte - oldpos);
                }

                // Handle unknown data if the size exceeds the expected size
                if (dat->byte > oldpos + size) {
                    size_t unknown_size = dat->byte - (oldpos + size);
                    LOG_WARN("Unknown data detected: size %zu exceeds expected size %u",
                             unknown_size, size);
                    // Read the unknown bits and store them
                    error |= dwg_decode_unknown_bits(dat, obj);
                }

                // Perform CRC check if applicable
                if (dat->version >= R_11) {
                    uint16_t crc = calculate_crc16(dat->byte, obj->size);
                    if (crc != expected_crc) {
                        LOG_ERROR("CRC check failed for object at offset 0x%zx: expected 0x%04x, got 0x%04x",
                                  dat->byte, expected_crc, crc);
                        return DWG_ERR_CRCERROR;
                    }
                }