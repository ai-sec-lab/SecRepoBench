if (obj->size > size) {
                    LOG_ERROR("Object size %u exceeds expected size %u", obj->size, size);
                    return DWG_ERR_INVALIDDWG;
                }

                // Check for potential buffer overflow
                if (dat->byte + obj->size > dat->size) {
                    LOG_ERROR("Buffer overflow detected: %zu + %u > %zu", dat->byte, obj->size, dat->size);
                    return DWG_ERR_INVALIDDWG;
                }

                // Read the object data
                if (obj->size > 0) {
                    obj->data = malloc(obj->size);
                    if (!obj->data) {
                        LOG_ERROR("Out of memory while allocating object data");
                        return DWG_ERR_OUTOFMEM;
                    }
                    memcpy(obj->data, &dat->buffer[dat->byte], obj->size);
                    dat->byte += obj->size;
                }