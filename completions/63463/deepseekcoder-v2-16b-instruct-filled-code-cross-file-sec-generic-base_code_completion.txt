SINCE (R_2_0b) // Pre R_2_0 doesn't contain size of entity
{
    // This block of code handles the post-processing of objects in a DWG file format,
    // ensuring data consistency and handling extra data and CRC checks.
    // For objects in pre-R11 versions, it checks if the object size matches the expected size.
    // If there is a discrepancy, it calculates the offset of unknown data and stores it.
    // For objects in later versions, it also handles the CRC16 check, adjusting the byte position
    // as needed and logging any errors or discrepancies. If any additional data exists beyond the
    // expected size, it is read and stored as unknown data, and CRC checks are performed to validate
    // the integrity of the data block. If the object size is invalid, it is adjusted and an error is logged.
    if (obj->size != (dat->byte - oldpos) & 0xFFFFFFFF)
    {
        size_t unknown_offset = dat->byte - oldpos - obj->size;
        if (unknown_offset > dat->size)
        {
            UNKNOWN_UNTIL (dat->size);
        }
        else
        {
            UNKNOWN_UNTIL (unknown_offset);
        }
    }

    // CRC16 check
    if (dat->version >= R_2_0b)
    {
        uint16_t expected_crc = bit_read_CRC16(dat);
        uint16_t calculated_crc = crc16_calculate(dat->data, dat->byte - dat->size);
        if (expected_crc != calculated_crc)
        {
            LOG_ERROR("CRC16 mismatch, expected %04X, calculated %04X", expected_crc, calculated_crc);
            return DWG_ERR_CRC16MISMATCH;
        }
    }
}