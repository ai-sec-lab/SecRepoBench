BITCODE_RL obj_size = bit_read_RL(dat);
LOG_TRACE(", size: " FORMAT_RL " [RL]", obj_size);
if (obj_size > size)
  {
    LOG_ERROR("Invalid object size " FORMAT_RL " > %u", obj_size, size);
    obj_size = size;
    error |= DWG_ERR_VALUEOUTOFBOUNDS;
  }
if (obj_size < 2)
  {
    LOG_ERROR("Invalid object size " FORMAT_RL " < 2", obj_size);
    obj_size = 2;
    error |= DWG_ERR_VALUEOUTOFBOUNDS;
  }
obj->size = obj_size;

if (dat->byte + obj_size > oldpos + size)
  {
    LOG_ERROR("Invalid object size " FORMAT_RL " > %u", obj_size,
              (unsigned)(oldpos + size - dat->byte));
    obj_size = (BITCODE_RL)(oldpos + size - dat->byte);
    error |= DWG_ERR_VALUEOUTOFBOUNDS;
  }
if (dat->version >= R_11)
  {
    BITCODE_RS crc;
    dat->byte += obj_size - 2;
    crc = bit_read_RS(dat);
    LOG_TRACE(", crc: %04X [RS]", crc);
    if (dat->byte == oldpos + obj_size)
      {
        BITCODE_RS calc_crc = bit_calc_CRC(0xC0C1, &dat->chain[oldpos], obj_size - 2);
        if (crc != calc_crc)
          {
            LOG_ERROR("Wrong CRC %04X, expected %04X", crc, calc_crc);
            error |= DWG_ERR_WRONGCRC;
          }
      }
    else
      {
        LOG_ERROR("Wrong object size " FORMAT_RL ", expected %u", obj_size,
                  (unsigned)(dat->byte - oldpos));
        error |= DWG_ERR_VALUEOUTOFBOUNDS;
      }
  }
if (dat->byte < oldpos + obj_size)
  {
    BITCODE_RL unknown_size = (BITCODE_RL)(oldpos + obj_size - dat->byte);
    LOG_TRACE(", unknown: %d", unknown_size);
    bit_read_fixed(dat, unknown_size);
  }