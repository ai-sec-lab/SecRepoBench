BITCODE_RL obj_size = bit_read_RL(dat);
if (obj_size != obj->size)
  {
    BITCODE_RL offset = obj_size - obj->size;
    LOG_WARN("Object size mismatch: %d != %d", obj_size, obj->size);
    if (offset > 0)
      {
        obj->unknown_bits = bit_read_TF(dat, offset);
        LOG_TRACE("unknown_bits: %d [TF]\n", offset);
      }
    else
      {
        LOG_ERROR("Negative object size difference");
        error |= DWG_ERR_VALUEOUTOFBOUNDS;
      }
  }

SINCE(R_11)
{
  BITCODE_RS crc;
  crc = bit_calc_CRC(0xC0C1, dat->chain + obj->address, obj_size);
  BITCODE_RS crc_read = bit_read_RS(dat);
  if (crc != crc_read)
    {
      LOG_ERROR("Object CRC mismatch: calculated %04X != read %04X", crc, crc_read);
      error |= DWG_ERR_WRONGCRC;
    }
}

if (dat->byte - oldpos != obj_size)
  {
    BITCODE_RL offset = obj_size - (dat->byte - oldpos);
    if (offset > 0)
      {
        obj->unknown_bits = bit_read_TF(dat, offset);
        LOG_TRACE("unknown_bits: %d [TF]\n", offset);
      }
    else
      {
        LOG_ERROR("Invalid object size");
        error |= DWG_ERR_VALUEOUTOFBOUNDS;
      }
  }

if (obj->size <= 0 || obj->size > 0x1000000) // 16MB
  {
    LOG_ERROR("Invalid object size %d", obj->size);
    obj->size = 0;
    error |= DWG_ERR_VALUEOUTOFBOUNDS;
  }