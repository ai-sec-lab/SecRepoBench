BITCODE_RL obj_size = bit_read_RL(dat);
obj->size = obj_size;
LOG_TRACE(" obj_size: " FORMAT_RL "\n", obj_size);

if (obj_size > size)
  {
    LOG_ERROR("Invalid object size " FORMAT_RL " > %u", obj_size, size);
    obj->size = size;
    error |= DWG_ERR_VALUEOUTOFBOUNDS;
  }
else if (obj_size + 2 < size) // 2 bytes for the CRC
  {
    BITCODE_RS crc;
    long off = size - obj_size - 2;
    long pos = dat->byte;
    dat->byte += off;
    LOG_TRACE("skip %ld unknown bytes to CRC\n", off);
    bit_read_fixed(dat, &obj->unknown_rest, off);
    crc = bit_read_RS(dat);
    LOG_TRACE("crc: %04X [RS]\n", crc);
    if (dat->byte == oldpos + size)
      {
        BITCODE_RS calc_crc = 0;
        dat->byte = pos;
        calc_crc = bit_calc_CRC(0xC0C1, dat, off);
        if (calc_crc != crc)
          {
            LOG_ERROR("Wrong CRC %04X, expected %04X", calc_crc, crc);
            error |= DWG_ERR_WRONGCRC;
          }
      }
    dat->byte = pos;
  }
else if (obj_size > 0 && obj_size < size)
  {
    LOG_ERROR("Invalid object size " FORMAT_RL " < %u", obj_size, size);
    obj->size = size;
    error |= DWG_ERR_VALUEOUTOFBOUNDS;
  }