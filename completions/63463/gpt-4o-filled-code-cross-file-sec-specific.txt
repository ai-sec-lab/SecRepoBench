{
  if (obj->size != (dat->byte - oldpos))
  {
    LOG_ERROR("Object size mismatch: expected %u, got %zu", obj->size, dat->byte - oldpos);
    obj->size = (dat->byte - oldpos) & 0xFFFFFFFF;
    error |= DWG_ERR_INVALIDDWG;
  }

  if (dat->byte < oldpos + obj->size)
  {
    size_t unknown_size = oldpos + obj->size - dat->byte;
    LOG_TRACE("Reading unknown data of size %zu", unknown_size);
    obj->unknown_bits = bit_read_bits(dat, unknown_size * 8);
    if (!obj->unknown_bits)
    {
      LOG_ERROR("Failed to read unknown bits");
      return DWG_ERR_OUTOFMEM;
    }
  }

  if (dat->byte < oldpos + obj->size)
  {
    LOG_ERROR("Object size is invalid, adjusting");
    dat->byte = oldpos + obj->size;
    error |= DWG_ERR_INVALIDDWG;
  }

  if (dat->byte < oldpos + obj->size)
  {
    LOG_ERROR("CRC16 check failed");
    error |= DWG_ERR_CRC;
  }
}