if (obj->supertype == DWG_SUPERTYPE_ENTITY
                    && dwg->version < R_11)
                  {
                    if (obj->size != (dat->byte - oldpos))
                      {
                        size_t unknown_offset = obj->size - (dat->byte - oldpos);
                        if (unknown_offset > 0)
                          {
                            LOG_DEBUG ("Unknown data at end of object\n");
                            obj->unknown_data_at_end_size = unknown_offset;
                            obj->unknown_data_at_end
                                = bit_read_n_bytes (dat, unknown_offset);
                          }
                        else
                          {
                            LOG_ERROR ("Invalid object size\n");
                            obj->size = dat->byte - oldpos;
                          }
                      }
                  }
                else if (obj->supertype == DWG_SUPERTYPE_ENTITY)
                  {
                    if (obj->crc16 != bit_read_CRC16 (dat))
                      {
                        LOG_ERROR ("Invalid CRC16\n");
                        dat->byte -= 2;
                      }
                    if (obj->size != (dat->byte - oldpos))
                      {
                        size_t unknown_offset = obj->size - (dat->byte - oldpos);
                        if (unknown_offset > 0)
                          {
                            LOG_DEBUG ("Unknown data at end of object\n");
                            obj->unknown_data_at_end_size = unknown_offset;
                            obj->unknown_data_at_end
                                = bit_read_n_bytes (dat, unknown_offset);
                            if (obj->crc16_at_end
                                != bit_read_CRC16_at_end (dat,
                                                          unknown_offset))
                              {
                                LOG_ERROR ("Invalid CRC16 at end\n");
                                dat->byte -= 2;
                              }
                          }
                        else
                          {
                            LOG_ERROR ("Invalid object size\n");
                            obj->size = dat->byte - oldpos;
                          }
                      }
                  }