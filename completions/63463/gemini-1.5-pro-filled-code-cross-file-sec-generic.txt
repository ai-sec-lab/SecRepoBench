if (obj->supertype == DWG_SUPERTYPE_ENTITY
                    && dwg->version < R_11)
                  {
                    if (obj->size != (dat->byte - oldpos))
                      {
                        size_t unknown_offset = 0;
                        if (obj->size > (dat->byte - oldpos))
                          {
                            unknown_offset = dat->byte;
                            UNKNOWN_UNTIL (oldpos + obj->size);
                          }
                        LOG_ERROR ("Invalid size of object %" PRIuSIZE
                                   " != %" PRIuSIZE " at 0x%zx\n",
                                   obj->size, dat->byte - oldpos,
                                   dat->byte - obj->size);
                        if (unknown_offset)
                          LOG_ERROR ("unknown data at 0x%zx size %" PRIuSIZE
                                     "\n",
                                     unknown_offset,
                                     (oldpos + obj->size) - unknown_offset);
                        obj->size = (dat->byte - oldpos);
                      }
                  }
                else if (obj->supertype == DWG_SUPERTYPE_ENTITY)
                  {
                    unsigned short crc16 = 0, crcval;
                    size_t crc_pos = dat->byte;
                    if (obj->size > (dat->byte - oldpos))
                      {
                        UNKNOWN_UNTIL (oldpos + obj->size);
                      }
                    else if (obj->size < (dat->byte - oldpos))
                      {
                        LOG_ERROR ("Invalid size of object %" PRIuSIZE
                                   " != %" PRIuSIZE " at 0x%zx\n",
                                   obj->size, dat->byte - oldpos,
                                   dat->byte - obj->size);
                        dat->byte = oldpos + obj->size;
                      }
                    crcval = bit_read_CRC16 (dat);
                    if (crcval != 0)
                      {
                        crc16 = compute_CRC16 (0, (unsigned char *)&dwg->object[num],
                                              sizeof (Dwg_Object));
                        crc16 = compute_CRC16 (crc16, (unsigned char *)obj->tio.object,
                                              obj->size);
                        if (crcval != crc16)
                          LOG_ERROR ("CRC16 mismatch 0x%x != 0x%x\n", crcval,
                                     crc16);
                      }
                    dat->byte = crc_pos + 2;
                  }