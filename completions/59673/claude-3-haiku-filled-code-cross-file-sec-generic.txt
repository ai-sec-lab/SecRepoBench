// FIXME h261 lowres loop filter
int lowres_edge_pos = FFMIN(h_edge_pos, v_edge_pos);
int block_size = block_s;

// Apply loop filtering to the edges of the motion-compensated blocks
for (int y = 0; y < h; y += block_size) {
    for (int x = 0; x < block_size; x++) {
        // Perform edge filtering on the luma plane
        if (motion_x + x < lowres_edge_pos) {
            s->vdsp.h261_loop_filter(dest_y + x, s->linesize, 1);
        }
        if (motion_y + y < lowres_edge_pos) {
            s->vdsp.h261_loop_filter(dest_y + x * s->linesize, s->linesize, 0);
        }
    }

    // Perform edge filtering on the chroma planes
    if (motion_x + (x >> s->chroma_x_shift) < (lowres_edge_pos >> s->chroma_x_shift)) {
        s->vdsp.h261_loop_filter(dest_cb + (x >> s->chroma_x_shift), s->uvlinesize, 1);
        s->vdsp.h261_loop_filter(dest_cr + (x >> s->chroma_x_shift), s->uvlinesize, 1);
    }
    if (motion_y + (y >> s->chroma_y_shift) < (lowres_edge_pos >> s->chroma_y_shift)) {
        s->vdsp.h261_loop_filter(dest_cb + (x >> s->chroma_x_shift) * s->uvlinesize, s->uvlinesize, 0);
        s->vdsp.h261_loop_filter(dest_cr + (x >> s->chroma_x_shift) * s->uvlinesize, s->uvlinesize, 0);
    }
}