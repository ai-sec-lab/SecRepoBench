if (!vpar) {
        av_log(NULL, AV_LOG_ERROR, "Invalid AVCodecParameters pointer\n");
        return false; // Input validation
    }

    // Check if codec ID and codec tag are not set
    if (flv_codecid == 0 && vpar->codec_tag == 0) {
        return true;
    }

    // Validate the codec ID against known values
    switch (flv_codecid) {
        case AV_CODEC_ID_HEVC:
        case AV_CODEC_ID_AV1:
        case AV_CODEC_ID_VP9:
        case AV_CODEC_ID_FLV1:
        case AV_CODEC_ID_FLASHSV:
        case AV_CODEC_ID_FLASHSV2:
        case AV_CODEC_ID_VP6F:
        case AV_CODEC_ID_VP6A:
        case AV_CODEC_ID_H264:
            return (vpar->codec_id == flv_codecid);
        default:
            av_log(NULL, AV_LOG_WARNING, "Unknown FLV codec ID: %x\n", flv_codecid);
            return false; // Default case for unknown codec IDs
    }