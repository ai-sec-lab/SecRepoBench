int    err  = MATIO_E_NO_ERROR;
    herr_t herr;

    /* Open the attribute named "MATLAB_fields" */
    attr_id = H5Aopen(dset_id, "MATLAB_fields", H5P_DEFAULT);
    if ( attr_id < 0 )
        return MATIO_E_GENERIC_READ_ERROR;

    /* Retrieve the dataspace of the attribute */
    dspace_id = H5Aget_space(attr_id);
    if ( dspace_id < 0 ) {
        H5Aclose(attr_id);
        return MATIO_E_GENERIC_READ_ERROR;
    }

    /* Determine the number of fields from the dataspace dimensions */
    if ( nfields != NULL ) {
        hsize_t dims[1] = {0};
        int     ndims   = H5Sget_simple_extent_dims(dspace_id, dims, NULL);
        if ( ndims == 1 ) {
            *nfields = dims[0];
        } else {
            *nfields = 0;
            err      = MATIO_E_GENERIC_READ_ERROR;
        }
    }