/* The packet must be long enough to contain both the UDP and VXLAN
   * headers (8 bytes each) after the IP header. */
  if(header->caplen < (iphdroffset + ip_len + sizeof(struct udphdr) + 8))
    return false;

  /* VXLAN is carried over the well-known UDP port 4789. */
  const u_int16_t vxlan_dst_port = htons(4789);

  /* UDP header starts right after the IP header. */
  struct udphdr *udp = (struct udphdr *)(packet + iphdroffset + ip_len);

  /* Offset where the VXLAN header begins (immediately after the UDP header). */
  u_int32_t offset = iphdroffset + ip_len + sizeof(struct udphdr);