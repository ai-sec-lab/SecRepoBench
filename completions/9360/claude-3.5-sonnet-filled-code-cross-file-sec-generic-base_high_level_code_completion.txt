end=q;
for (n=0; (*end != '\0') && (n >= 0); )
{
  GetNextToken(end,&end,extent,token);
  if (*token == '\0')
    break;
  if (LocaleCompare(token,"push") == 0)
    n++;
  else if (LocaleCompare(token,"pop") == 0)
    n--;
}
if ((*end != '\0') && (n < 0))
{
  for (p=start; p < end; p++)
    if (*p == '\n')
      name[strlen(name)] = ' ';
    else
      name[strlen(name)] = *p;
  name[strlen(name)] = '\0';
  (void) AddValueToSplayTree(macros,ConstantString(name),
    ConstantString(start));
}