n=0;
            end=start;
            while ((*q != '\0') && (n >= 0))
            {
              if (*q == '"')
                n--;
              if (*q == '#')
                {
                  /*
                    Skip comment.
                  */
                  while ((*q != '\n') && (*q != '\0'))
                    q++;
                  continue;
                }
              if (*q == '\\')
                {
                  q++;
                  if (*q == '\0')
                    break;
                }
              q++;
              if (*q == '"')
                {
                  n++;
                  if (n == 0)
                    end=q+1;
                }
            }
            if (end > start)
              (void) AddValueToSplayTree(macros,AcquireString(token),
                CloneString(start,end-start-1));
            continue;