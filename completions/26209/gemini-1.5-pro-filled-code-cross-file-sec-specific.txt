int i, j, class_index, ret;
    const static uint8_t dc_luminance_bits[12] = {
        0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11
    };
    const static uint8_t dc_luminance_val[12] = {
        0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11
    };
    const static uint8_t ac_luminance_bits[162] = {
        0, 2, 1, 3, 3, 2, 4, 3, 5, 5, 4, 4, 0, 0, 1, 0x7d
    };
    const static uint8_t ac_luminance_val[162] = {
        0x01, 0x02, 0x03, 0x00, 0x04, 0x11, 0x05, 0x12,
        0x21, 0x31, 0x41, 0x06, 0x13, 0x51, 0x61, 0x07,
    };

    static const HuffmanTable ht[] = {
        { 0, 0, dc_luminance_bits,  sizeof(dc_luminance_bits),  dc_luminance_val,  sizeof(dc_luminance_val) },
        { 1, 0, ac_luminance_bits,  sizeof(ac_luminance_bits),  ac_luminance_val,  sizeof(ac_luminance_val) },
    };

    for (i = 0; i < FF_ARRAY_ELEMS(ht); i++) {
        if (ht[i].class_index < 2) {
            if (ht[i].bits_size > 32 * 8 * sizeof(uint16_t) * 2)
                return AVERROR_INVALIDDATA;

            ret = build_vlc(&s->vlcs[ht[i].class_index][ht[i].index],
                           ht[i].bits, ht[i].bits_size,
                           ht[i].values, ht[i].values_size,
                           8, 2, 0, 0, INIT_VLC_USE_NEW_STATIC);
            if (ret < 0)
                return ret;
        }


        if (ht[i].class_index < 2) {
            int size = 1 << 9;
            s->raw_huffman_lengths[ht[i].class_index][ht[i].index] = av_malloc(size);
            s->raw_huffman_values[ht[i].class_index][ht[i].index] = av_malloc(size * sizeof(uint16_t));
            if (!s->raw_huffman_lengths[ht[i].class_index][ht[i].index] || !s->raw_huffman_values[ht[i].class_index][ht[i].index])
                return AVERROR(ENOMEM);

            for (j=0; j<size; j++){
                s->raw_huffman_lengths[ht[i].class_index][ht[i].index][j] = 0;
            }
            for (j = 0; j < ht[i].bits_size; j++) {
                s->raw_huffman_lengths[ht[i].class_index][ht[i].index][ht[i].values[j]] = ht[i].bits[j];
                s->raw_huffman_values [ht[i].class_index][ht[i].index][ht[i].values[j]] = ht[i].values[j];
            }
        }
    }