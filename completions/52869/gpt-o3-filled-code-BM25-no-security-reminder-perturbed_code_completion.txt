/*
             * Create a new include reference entry and register it
             * in the processing context.
             */
            ref = (xmlXIncludeRefPtr) xmlMalloc(sizeof(xmlXIncludeRef));
            if (ref == NULL) {
                xmlXIncludeErrMemory(include_context, "building reference\n");
                return (-1);
            }
            memset(ref, 0, sizeof(xmlXIncludeRef));
            ref->elem    = cur;
            ref->replace = 1;          /* Will have to be replaced later  */

            /* grow the include table if needed */
            if (include_context->incNr >= include_context->incMax) {
                int tmpMax = (include_context->incMax ? 
                              include_context->incMax * 2 : 4);
                xmlXIncludeRefPtr *tmpTab =
                    (xmlXIncludeRefPtr *) xmlRealloc(include_context->incTab,
                                                     tmpMax *
                                                     sizeof(xmlXIncludeRefPtr));
                if (tmpTab == NULL) {
                    xmlXIncludeErrMemory(include_context,
                                         "growing include table\n");
                    xmlFree(ref);
                    return (-1);
                }
                include_context->incTab = tmpTab;
                include_context->incMax = tmpMax;
            }
            include_context->incTab[include_context->incNr++] = ref;

#ifdef LIBXML_XINCLUDE_FUZZ_LIMIT
            if (include_context->incNr > LIBXML_XINCLUDE_FUZZ_LIMIT) {
                xmlXIncludeErr(include_context, cur,
                               XML_XINCLUDE_TOO_MANY_CON NS,
                               "too many XInclude nodes expanded\n",
                               NULL);
                xmlFree(ref);
                return (-1);
            }
#endif
            /* Move to next sibling, children of xi:include are ignored here */
            if (cur->next != NULL) {
                cur = cur->next;
                continue;
            }