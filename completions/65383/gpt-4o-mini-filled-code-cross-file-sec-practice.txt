case 'H': {
            // Handle hexadecimal string type 'H'
            size_t hex_len = strlen(aux + 3);
            if (aux_end - aux < 3 + hex_len + 1) // +1 for null terminator
                goto err;

            if (!tm->blk) {
                if (!(tm->blk = cram_new_block(EXTERNAL, key)))
                    goto err;
                codec->u.e_byte_array_len.val_codec->out = tm->blk;
            }

            aux += 3; // Move past 'H' type identifier
            BLOCK_APPEND(tm->blk, aux, hex_len);
            BLOCK_APPEND_CHAR(tm->blk, '\0'); // Null-terminate the string
            aux += hex_len; // Move past the hex string
            break;
        }

        case 'B': {
            // Handle byte array type 'B'
            int subtype = aux[3]; // Get the subtype
            int count = bam_aux2i_end((uint8_t *)aux + 4, (uint8_t *)aux_end);
            if (count < 0 || aux_end - aux < 4 + count * (subtype == 'c' ? 1 : (subtype == 's' ? 2 : 4)))
                goto err;

            if (!tm->blk) {
                if (!(tm->blk = cram_new_block(EXTERNAL, key)))
                    goto err;
                codec->u.e_byte_array_len.val_codec->out = tm->blk;
            }

            aux += 4; // Move past 'B' type identifier and count
            BLOCK_APPEND(tm->blk, aux, count * (subtype == 'c' ? 1 : (subtype == 's' ? 2 : 4)));
            aux += count * (subtype == 'c' ? 1 : (subtype == 's' ? 2 : 4)); // Move past the byte array
            break;
        }