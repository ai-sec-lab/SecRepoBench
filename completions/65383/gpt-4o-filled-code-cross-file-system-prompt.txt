case 'H': {
                // Hexadecimal string
                if (!tm->blk) {
                    if (!(tm->blk = cram_new_block(EXTERNAL, key)))
                        goto err;
                    codec->u.e_byte_array_len.val_codec->out = tm->blk;
                }

                aux += 3;
                while (aux < aux_end && *aux != '\0') {
                    if (aux_end - aux < 2)
                        goto err;
                    BLOCK_APPEND_CHAR(tm->blk, *aux++);
                }
                aux++; // skip the null terminator
                break;
            }

            case 'B': {
                // Byte array
                if (aux_end - aux < 3 + 5)
                    goto err;

                if (!tm->blk) {
                    if (!(tm->blk = cram_new_block(EXTERNAL, key)))
                        goto err;
                    codec->u.e_byte_array_len.val_codec->out = tm->blk;
                }

                aux += 3;
                int sub_type = *aux++;
                int count = le_to_u32(aux);
                aux += 4;

                int len;
                switch (sub_type) {
                case 'c': case 'C': len = 1; break;
                case 's': case 'S': len = 2; break;
                case 'i': case 'I': case 'f': len = 4; break;
                default:
                    hts_log_error("Unknown sub-type '%c' in aux type 'B'", sub_type);
                    goto err;
                }

                if (aux_end - aux < count * len)
                    goto err;

                BLOCK_APPEND_CHAR(tm->blk, sub_type);
                BLOCK_APPEND(tm->blk, &count, 4);
                BLOCK_APPEND(tm->blk, aux, count * len);
                aux += count * len;
                break;
            }