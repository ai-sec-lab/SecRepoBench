if (!tm->blk) {
                if (!(tm->blk = cram_new_block(EXTERNAL, key)))
                    goto err;
                codec->u.e_byte_array_len.val_codec->out = tm->blk;
            }

            // Handle 'H' type (hexadecimal string)
            if (aux[2] == 'H') {
                size_t hex_len = strlen(aux + 3);
                BLOCK_APPEND(tm->blk, aux, 3); // Append the tag
                BLOCK_APPEND(tm->blk, aux + 3, hex_len); // Append the hex string
                BLOCK_APPEND_CHAR(tm->blk, '\0'); // Null-terminate
                aux += 3 + hex_len + 1; // Move past the tag and data
                continue;
            }

            // Handle 'B' type (byte array)
            if (aux[2] == 'B') {
                int count = bam_aux2i_end((uint8_t *)aux + 3, (uint8_t *)aux_end);
                if (count < 0) goto err; // Error in count
                size_t byte_array_size = count * sizeof(uint8_t); // Calculate size
                if (aux_end - aux < 3 + byte_array_size) goto err; // Check buffer size

                BLOCK_APPEND(tm->blk, aux, 3); // Append the tag
                BLOCK_APPEND(tm->blk, aux + 3, byte_array_size); // Append the byte array
                aux += 3 + byte_array_size; // Move past the tag and data
                continue;
            }