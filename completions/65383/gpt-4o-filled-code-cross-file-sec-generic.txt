case 'H': {
            // Hexadecimal string
            if (!tm->blk) {
                if (!(tm->blk = cram_new_block(EXTERNAL, key)))
                    goto err;
                codec->u.e_byte_array_len.val_codec->out = tm->blk;
            }

            aux += 3;
            while (aux < aux_end && *aux != '\0') {
                if (aux_end - aux < 2)
                    goto err;
                BLOCK_APPEND_CHAR(tm->blk, *aux++);
            }
            aux++;
            break;
        }

        case 'B': {
            // Byte array
            if (aux_end - aux < 3 + 5)
                goto err;

            if (!tm->blk) {
                if (!(tm->blk = cram_new_block(EXTERNAL, key)))
                    goto err;
                codec->u.e_byte_array_len.val_codec->out = tm->blk;
            }

            int sub_type = aux[3];
            int count = bam_aux2i_end((uint8_t *)aux + 4, (uint8_t *)aux_end);
            int len = 0;

            switch (sub_type) {
            case 'c': case 'C': len = 1; break;
            case 's': case 'S': len = 2; break;
            case 'i': case 'I': case 'f': len = 4; break;
            default:
                hts_log_error("Unknown sub-type '%c' in 'B' aux field", sub_type);
                goto err;
            }

            if (aux_end - aux < 3 + 5 + count * len)
                goto err;

            aux += 3;
            BLOCK_APPEND(tm->blk, aux, 5 + count * len);
            aux += 5 + count * len;
            break;
        }