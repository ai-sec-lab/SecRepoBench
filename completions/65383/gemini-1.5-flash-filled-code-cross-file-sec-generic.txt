case 'Z':
            if (aux_end - aux < 3 + 1)
                goto err;

            if (!tm->blk) {
                if (!(tm->blk = cram_new_block(EXTERNAL, key)))
                    goto err;
                codec->u.e_byte_array_len.val_codec->out = tm->blk;
            }

            aux += 3;
            //codec->encode(s, codec, aux, strlen(aux));
            BLOCK_APPEND(tm->blk, aux, strlen(aux) + 1);
            aux += strlen(aux) + 1;
            break;
        case 'H':
            if (aux_end - aux < 3 + 1)
                goto err;

            if (!tm->blk) {
                if (!(tm->blk = cram_new_block(EXTERNAL, key)))
                    goto err;
                codec->u.e_byte_array_len.val_codec->out = tm->blk;
            }

            aux += 3;
            //codec->encode(s, codec, aux, strlen(aux));
            BLOCK_APPEND(tm->blk, aux, strlen(aux) + 1);
            aux += strlen(aux) + 1;
            break;
        case 'B': {
            int len = bam_aux2i((uint8_t *)aux + 3);
            if (aux_end - aux < 3 + 4 + len)
                goto err;

            if (!tm->blk) {
                if (!(tm->blk = cram_new_block(EXTERNAL, key)))
                    goto err;
                codec->u.e_byte_array_len.val_codec->out = tm->blk;
            }

            aux += 3;
            //codec->encode(s, codec, aux, len);
            BLOCK_APPEND(tm->blk, aux, len);
            aux += len;
            break;
        }