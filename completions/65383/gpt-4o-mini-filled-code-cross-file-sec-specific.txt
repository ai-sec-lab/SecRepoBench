case 'H': {
            size_t len = 0;
            while (aux < aux_end && *aux++) len++;
            if (len == 0) goto err;

            if (!tm->blk) {
                if (!(tm->blk = cram_new_block(EXTERNAL, key)))
                    goto err;
                codec->u.e_byte_array_len.val_codec->out = tm->blk;
            }

            aux -= len + 1; // Move back to the start of the data
            BLOCK_APPEND(tm->blk, aux, len);
            aux += len;
            break;
        }

        case 'B': {
            // Handle byte array of variable size
            int subtype = aux[3]; // Get the subtype
            int count = bam_aux2i_end((uint8_t *)aux + 4, (uint8_t *)aux_end);
            size_t total_size = count * (subtype == 'c' ? 1 : (subtype == 'C' ? 1 : (subtype == 's' ? 2 : (subtype == 'S' ? 2 : (subtype == 'i' ? 4 : (subtype == 'I' ? 4 : (subtype == 'f' ? 4 : 0)))))));

            if (aux_end - aux < total_size + 4) goto err; // Ensure enough data

            if (!tm->blk) {
                if (!(tm->blk = cram_new_block(EXTERNAL, key)))
                    goto err;
                codec->u.e_byte_array_len.val_codec->out = tm->blk;
            }

            aux += 4; // Move past the count and subtype
            BLOCK_APPEND(tm->blk, aux, total_size);
            aux += total_size;
            break;
        }