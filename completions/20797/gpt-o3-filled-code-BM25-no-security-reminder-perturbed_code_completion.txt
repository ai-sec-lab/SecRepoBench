{
    /* ------------------------------------------------------------------
     * Very light-weight parsing: we simply distinguish between
     * ClientHello (0x01) and ServerHello (0x02).  For a ClientHello we
     * also enable the “extra packet processing” logic so that the
     * forthcoming Certificate message can be inspected by the TLS
     * dissector later on.
     *
     * A complete JA3/JA3S implementation would have to walk through the
     * cipher-suite list, the extension list, etc.  That is outside the
     * scope necessary for compilation and basic protocol detection
     * here, therefore only the groundwork is provided.
     * ------------------------------------------------------------------ */
    if(handshake_type == 0x02) { /* Server Hello */
#ifdef DEBUG_TLS
      printf("[TLS] ServerHello detected (version 0x%04x)\n", tls_version);
#endif
      return 2;                  /* Indicate ServerHello handled          */
    } else if(handshake_type == 0x01) { /* Client Hello */
#ifdef DEBUG_TLS
      printf("[TLS] ClientHello detected (version 0x%04x)\n", tls_version);
#endif
      /* Ask the engine to keep looking at a few more packets so that the
       * Certificate message (and possibly others) can be analysed.
       */
      if(flow->extra_packets_func == NULL)
        tlsInitExtraPacketProcessing(flow);

      return 1;                  /* Indicate ClientHello handled          */
    } else {
      /* Unknown / unsupported handshake message type                    */
      return 0;
    }
  }