// Seek to the tag's location in the IO handler. Check if the tag is supported 
// by retrieving the tag descriptor for the given signature. If the tag descriptor 
// is not found, log an error and exit. Read the base type of the tag and verify 
// if it is supported by the tag descriptor. If the type is unsupported, exit. 
// Deduct 8 bytes from the tag size to account for the tag's base type header.
if (!Icc->IOhandler->Seek(Icc->IOhandler, Offset)) goto Error;
TagSize -= 8; // Deduct 8 bytes for the tag's base type header

// Get tag descriptor
TagDescriptor = _cmsGetTagDescriptor(Icc->ContextID, sig);
if (TagDescriptor == NULL) {
    cmsSignalError(Icc->ContextID, cmsERROR_CORRUPTION_DETECTED, "Tag descriptor not found for tag '%s'", _cmsTagSignature2String(NULL, sig));
    goto Error;
}

// Check if the tag type is supported
BaseType = Icc->TagTypeHandlers[n]->Signature;
if (!IsTypeSupported(TagDescriptor, BaseType)) {
    cmsSignalError(Icc->ContextID, cmsERROR_CORRUPTION_DETECTED, "Unsupported tag type for tag '%s'", _cmsTagSignature2String(NULL, sig));
    goto Error;
}