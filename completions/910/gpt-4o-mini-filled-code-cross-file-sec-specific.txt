if (TagSize < 8) goto Error; // Ensure the tag size is valid

    TagSize -= 8; // Deduct 8 bytes for the tag's base type header

    // Allocate memory for the tag data
    Icc->TagPtrs[n] = _cmsDupMem(Icc->ContextID, NULL, TagSize);
    if (Icc->TagPtrs[n] == NULL) goto Error; // Check for allocation failure

    // Seek to the tag's location in the IO handler
    if (!io->Seek(io, Offset)) goto Error;

    // Read the tag data into the allocated memory
    if (!io->Read(io, Icc->TagPtrs[n], 1, TagSize)) goto Error;