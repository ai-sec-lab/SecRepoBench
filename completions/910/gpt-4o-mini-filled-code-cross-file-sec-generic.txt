// Check if the IO handler can seek to the specified offset
    if (!io->Seek(io, Offset)) goto Error;

    // Read the tag data into a temporary buffer
    void* buffer = _cmsAlloc(Icc->ContextID, TagSize);
    if (buffer == NULL) goto Error; // Ensure memory allocation was successful

    // Read the tag data from the IO handler
    if (!io->Read(io, buffer, 1, TagSize)) {
        _cmsFree(Icc->ContextID, buffer); // Free the buffer on error
        goto Error;
    }

    // Process the read data using the type handler
    LocalTypeHandler.ContextID = Icc->ContextID;
    LocalTypeHandler.ICCVersion = Icc->Version;

    // Call the appropriate read function from the type handler
    Icc->TagPtrs[n] = LocalTypeHandler.ReadPtr(&LocalTypeHandler, buffer, &ElemCount, TagSize - 8); // Deduct 8 bytes for the header

    // Free the temporary buffer after processing
    _cmsFree(Icc->ContextID, buffer);