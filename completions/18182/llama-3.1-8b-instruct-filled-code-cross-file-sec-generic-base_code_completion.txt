#if defined(TIFFTAG_XMLPACKET)
  if ((TIFFGetField(tiff,TIFFTAG_XMLPACKET,&length,&profile) == 1) &&
      (profile!= (unsigned char *) NULL))
    {
      // The block reads the XMP profile from a TIFF image, checking if the profile contains the string 
      // "dc:format=\"image/dng\"". If the string is found, it sets the image's format to "DNG".
      const char *xmp_string = (const char *) profile;
      size_t xmp_length = length;
      const char *dc_format = "dc:format=\"image/dng\"";
      size_t dc_format_length = strlen(dc_format);
      if (xmp_length >= dc_format_length && 
          memcmp(xmp_string, dc_format, dc_format_length) == 0) {
        (void) SetImageProperty(image, "format", "DNG", exception);
      }
    }
#endif