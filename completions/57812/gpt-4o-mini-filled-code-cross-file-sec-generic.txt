pps->ref_loc_offset_flag = get_bits1(gb);
    if (pps->ref_loc_offset_flag) {
        for (int i = 0; i < pps->num_ref_loc_offsets; i++) {
            pps->ref_layer_id[i] = get_bits(gb, 6); // Read layer ID
            pps->scaled_ref_layer_offset[i] = get_se_golomb_long(gb); // Read scaled reference layer offset
            pps->ref_region_offset[i] = get_se_golomb_long(gb); // Read reference region offset
            
            // Check for valid offsets
            if (pps->scaled_ref_layer_offset[i] < -128 || pps->scaled_ref_layer_offset[i] > 127) {
                av_log(avctx, AV_LOG_ERROR, "Scaled reference layer offset out of range [-128, 127].\n");
                return AVERROR_INVALIDDATA;
            }
            if (pps->ref_region_offset[i] < -128 || pps->ref_region_offset[i] > 127) {
                av_log(avctx, AV_LOG_ERROR, "Reference region offset out of range [-128, 127].\n");
                return AVERROR_INVALIDDATA;
            }
        }
    }

    // Handle resample phases if specified
    if (pps->resample_phase_set_present_flag = get_bits1(gb)) {
        for (int i = 0; i < pps->num_ref_loc_offsets; i++) {
            pps->luma_resample_phase[i] = get_bits(gb, 4); // Read luma resample phase
            pps->chroma_resample_phase[i] = get_bits(gb, 4); // Read chroma resample phase
        }
    }