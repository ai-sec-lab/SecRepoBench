if (x++ < (ssize_t) number_pixels)
{
    SetPixelGray(image,ScaleAnyToQuantum((pixel >> 12) & 0x3ff,range),q);
    q+=GetPixelChannels(image);
}