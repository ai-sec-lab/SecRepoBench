// Determine the short_offset based on the indexToLocFormat from the 'head' table.
short_offset = (indexToLocFormat == 0)? 0 : (indexToLocFormat == 1)? 2 : 4;

// Reference the 'loca' and 'glyf' tables from the face using a sanitize context.
hb_blob_t *loca_blob = hb_face_get_table(faceptr, HB_TAG('l', 'o', 'c', 'a'));
hb_blob_t *glyf_blob = hb_face_get_table(faceptr, HB_TAG('g', 'l', 'y', 'f'));

// Calculate num_glyphs using the length of the loca_table, adjusting for offset format.
num_glyphs = (loca_table->length + (short_offset == 4) - 1) / (short_offset == 4? 4 : 2);