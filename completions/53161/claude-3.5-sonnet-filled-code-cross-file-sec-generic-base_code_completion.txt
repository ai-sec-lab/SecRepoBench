mrb_int value;
mrb_bool overflow;

value = mrb_int_read(mrb, tptr + tmpl->idx, tlen - tmpl->idx, &overflow);
if (overflow) {
  mrb_raise(mrb, E_RUNTIME_ERROR, "template length too large");
}
count = (int)value;
while (tmpl->idx < tlen && ISDIGIT(tptr[tmpl->idx])) {
  tmpl->idx++;
}