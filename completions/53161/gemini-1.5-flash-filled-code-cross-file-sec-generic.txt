long long num = 0;
      char *endp;
      num = strtoll(tptr + tmpl->idx, &endp, 10);
      if (endp == tptr + tmpl->idx) {
        mrb_raisef(mrb, E_RUNTIME_ERROR, "invalid template string");
      }
      tmpl->idx += (endp - (tptr + tmpl->idx));
      if (tmpl->idx > tlen) {
        mrb_raisef(mrb, E_RUNTIME_ERROR, "template length is too large");
      }
      count = (int)num;