int ch, value = 0;
while (ISDIGIT(ch = tptr[tmpl->idx])) {
  value = value * 10 + (ch - '0');
  tmpl->idx++;
}
if (tmpl->idx == tlen) {
  mrb_raisef(mrb, E_RUNTIME_ERROR, "template length too large");
}
count = value;