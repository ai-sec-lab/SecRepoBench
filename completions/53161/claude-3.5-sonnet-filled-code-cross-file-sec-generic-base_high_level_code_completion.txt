mrb_int num;
const char *p = tptr + tmpl->idx;
char *e;
num = mrb_int_read(p, &e);
if (e == p) {
  mrb_raise(mrb, E_RUNTIME_ERROR, "invalid template");
}
if (num < 0) {
  mrb_raise(mrb, E_RUNTIME_ERROR, "negative count");
}
count = (int)num;
tmpl->idx += (int)(e - p);