if (tmpl->idx + 1 >= tlen) {
        mrb_raisef(mrb, E_RUNTIME_ERROR, "template length is too large");
      }
      tmpl->idx++;
      int num = 0;
      while (tmpl->idx < tlen && ISDIGIT(tptr[tmpl->idx])) {
        num = num * 10 + (tptr[tmpl->idx] - '0');
        tmpl->idx++;
      }
      count = num;