/*  Experimental twoâ€“level line tables set up:
        After the standard header fields and the old-style
        directory/file tables (both of which we just
        processed) there must be two ULEB encoded offsets
        giving  (1) the offset from the start of the
        prologue to the logicals table and
        (2) the offset from the start of the prologue to
        the actuals table.
        In addition, as a simple sanity check, there is
        a single zero byte just before those two offsets.
        The sequence therefore is
           0x00 <uleb logicals_offset> <uleb actuals_offset>
        We verify those bytes here and record the offsets.
     */
    if (version == EXPERIMENTAL_LINE_TABLES_VERSION) {
        int lres = 0;
        Dwarf_Unsigned utmp = 0;

        /*  The spec says a single 0 byte MUST appear here.
            It makes the experimental table clearly different
            from other versions.  */
        if (line_cursor >= line_ptr_end) {
            _dwarf_error(dbg, err, DW_DLE_LINE_NUMBER_HEADER_ERROR);
            return DW_DLV_ERROR;
        }
        if (*line_cursor != 0) {
            _dwarf_error_string(dbg, err,
                DW_DLE_LINE_NUMBER_HEADER_ERROR,
                "DW_DLE_LINE_NUMBER_HEADER_ERROR: "
                "Expected 0 byte marker not present in "
                "experimental line table header");
            return DW_DLV_ERROR;
        }
        /* Skip the marker byte. */
        ++line_cursor;

        /*  Read logicals_table_offset (uleb). */
        lres = read_uword_de(&line_cursor,&utmp,
            dbg,err,line_ptr_end);
        if (lres != DW_DLV_OK) {
            return lres;
        }
        line_context->lc_logicals_table_offset = utmp;

        /*  Read actuals_table_offset (uleb). */
        lres = read_uword_de(&line_cursor,&utmp,
            dbg,err,line_ptr_end);
        if (lres != DW_DLV_OK) {
            return lres;
        }
        line_context->lc_actuals_table_offset = utmp;

        /*  Sanity: offsets must be inside the line table length. */
        if (line_context->lc_logicals_table_offset > total_length ||
            line_context->lc_actuals_table_offset > total_length) {
            _dwarf_error(dbg, err, DW_DLE_DEBUG_LINE_LENGTH_BAD);
            return DW_DLV_ERROR;
        }

        /*  Ensure we have not walked past end of header area. */
        if (line_cursor > line_ptr_end) {
            _dwarf_error(dbg, err, DW_DLE_LINE_OFFSET_BAD);
            return DW_DLV_ERROR;
        }
    } else {
        /*  Non-experimental tables: zero the values so later
            code can use them to tell a single-level table. */
        line_context->lc_logicals_table_offset = 0;
        line_context->lc_actuals_table_offset = 0;
    }