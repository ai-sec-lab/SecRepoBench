for(i = 0; (i + 1) < cipher_length &&
                 (cipher_offset + i + 1) < packet->payload_packet_len; i += 2) {
        u_int8_t b1 = packet->payload[cipher_offset + i];
        u_int8_t b2 = packet->payload[cipher_offset + i + 1];

        /* Skip GREASE values: first and second byte identical, low nibble 0x0a */
        if((b1 == b2) && ((b1 & 0x0f) == 0x0a))
          continue;

        /* Convert from network to host order */
        u_int16_t cipher_id = ntohs(*((u_int16_t *)&packet->payload[cipher_offset + i]));

        /* Store cipher for JA3 */
        if(ja3.client.num_cipher < MAX_NUM_JA3) {
          ja3.client.cipher[ja3.client.num_cipher++] = cipher_id;
        } else {
          invalid_ja3 = 1;
#ifdef DEBUG_TLS
          printf("Client TLS Invalid num ciphers %u\n", ja3.client.num_cipher);
#endif
        }

        /* Heuristics ********************************************************/

        /* Count ciphers (Safari generally advertises 12, Chrome 13) */
        safari_ciphers++;
        chrome_ciphers++;

        /* Detect ciphers unlikely in Safari (best-effort list) */
        switch(cipher_id) {
        case 0x1301: case 0x1302: case 0x1303: /* TLS 1.3 ciphers            */
        case 0xC02F: case 0xC02B: case 0xC030: case 0xC02C:
        case 0xC013: case 0xC014:
        case 0x009C: case 0x009D:
        case 0x002F:
          /* Typical Safari cipher â€“ keep counting */
          break;

        default:
          this_is_not_safari = 1;
          break;
        }

        /* Additional hint for recent Safari (Big Sur) */
        if(cipher_id == 0x1301 || cipher_id == 0x1302 || cipher_id == 0x1303)
          looks_like_safari_on_big_sur = 1;
      }