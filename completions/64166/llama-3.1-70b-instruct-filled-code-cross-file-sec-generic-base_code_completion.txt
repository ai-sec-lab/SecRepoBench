if (DeviceLink == NULL) {
    cmsDeleteTransform(xform);
    return 0;
}

// Force the use of a CLUT
cmsPipelineSetFlags(DeviceLink, cmsFLAGS_FORCE_CLUT);

// Optimize the pipeline for color rendering
_cmsOptimizePipeline(DeviceLink);