if (DeviceLink == NULL) {
        cmsDeleteTransform(xform);
        return 0;
    }

    DeviceLink = cmsPipelineAlloc(v ->ContextID);
    if (DeviceLink == NULL) {
        cmsDeleteTransform(xform);
        return 0;
    }
    cmsPipelineInsertStage(DeviceLink, cmsAT_BEGIN, cmsDupStage(v->Lut));
    cmsPipelineSetSaveAs8bits(DeviceLink, TRUE);
    cmsPipelineSetForceCLUT(DeviceLink, TRUE);
    _cmsOptimizePipeline(DeviceLink);