elementInstanceTag = BitBufferReadSmall (bits, 4) ;

switch (tag)
{
    case ID_SCE:
    case ID_LFE:
        status = DecodeMonoChannel (p, bits, sampleBuffer, numSamples, &chanBits, channelIndex) ;
        RequireNoErr (status, goto Exit ;) ;
        channelIndex++ ;
        break ;
    case ID_CPE:
        status = DecodeStereoChannel (p, bits, sampleBuffer, numSamples, &chanBits, channelIndex) ;
        RequireNoErr (status, goto Exit ;) ;
        channelIndex += 2 ;
        break ;
    case ID_END:
        goto NoMoreChannels ;
    default:
        goto Exit ;
}

p->mActiveElements |= (1u << elementInstanceTag) ;