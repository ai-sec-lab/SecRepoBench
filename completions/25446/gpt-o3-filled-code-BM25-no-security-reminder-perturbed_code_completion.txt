/* Save CNAME and compute the offset of the realm that follows it */
		    realm_offset = name_offset + 1 + cname_len; /* Skip length byte and CNAME */

		    /* Distinguish between hostname (ending with '$') and username */
		    if(cname_len) {
		      if(cname_str[cname_len-1] == '$') {
			/* Hostnames usually end with a '$' which we strip */
			cname_str[cname_len-1] = '\0';
			snprintf(flow->protos.kerberos.hostname,
				 sizeof(flow->protos.kerberos.hostname), "%s", cname_str);
		      } else {
			snprintf(flow->protos.kerberos.username,
				 sizeof(flow->protos.kerberos.username), "%s", cname_str);
		      }
		    }

		    /* Move forward until we meet the ASN.1 STRING identifier (0x1b)
		     * that starts the realm field, but do not overrun the packet */
		    for(i = 0;
			(i < 20) && (realm_offset < flow_packet->payload_packet_len);
			i++) {
		      if(flow_packet->payload[realm_offset] == 0x1b)
			break;
		      realm_offset++;
		    }