if (org_fmt == 'g') {
        prec += (e - 1);
      }
      if (prec + (e > 0 ? e + 1 : 0) > buf_remaining) {
        if (org_fmt == 'g') {
          prec = buf_remaining - (e > 0 ? e + 1 : 0);
        }
        else {
          prec = buf_remaining - 1;
        }
      }