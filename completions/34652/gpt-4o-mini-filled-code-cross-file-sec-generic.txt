// Adjust precision to prevent buffer overflow
      if (prec > (buf_remaining - 1)) {
        prec = buf_remaining - 1; // Leave space for null terminator
      }
      num_digits = prec + 1; // Include the leading digit
      *s++ = first_dig; // Write the first digit

      // Fill in the remaining digits
      while (num_digits > 1) {
        *s++ = '0'; // Fill with zeros
        num_digits--;
      }