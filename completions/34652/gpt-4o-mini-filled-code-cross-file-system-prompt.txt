if (num_digits + dec > buf_remaining) {
        num_digits = buf_remaining - dec;
      }
      for (int i = 0; i < num_digits; ++i) {
        int8_t d = f;
        *s++ = '0' + d;
        f -= (mrb_float)d;
        f *= 10.0;
      }