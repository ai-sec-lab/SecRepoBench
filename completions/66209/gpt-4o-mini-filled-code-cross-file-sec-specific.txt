if (m <= 0 || n <= 0) {
    return -1; // Invalid lengths
  }

  long i, j;
  bitint mask = 0;
  bitint first_char_mask = 0;
  bitint last_char_mask = 0;

  // Create masks for the first and last characters of the substring
  for (i = 0; i < m; i++) {
    if (i == 0) {
      first_char_mask |= (bitint)(1ULL << (xs[i] % 64));
    }
    if (i == m - 1) {
      last_char_mask |= (bitint)(1ULL << (xs[i] % 64));
    }
  }

  // Iterate through the search string in chunks
  for (i = 0; i <= n - m; i += sizeof(bitint)) {
    mask = 0;
    for (j = 0; j < sizeof(bitint) && (i + j) < n; j++) {
      mask |= (bitint)(1ULL << (ys[i + j] % 64));
    }

    // Check if the first and last characters match
    if ((mask & first_char_mask) && (mask & last_char_mask)) {
      // Further checks can be added here if needed
      return i; // Found the substring
    }
  }