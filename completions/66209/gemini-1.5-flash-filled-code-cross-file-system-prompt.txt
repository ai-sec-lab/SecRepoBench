long i, j;
  bitint a, b, c;
  long n1 = n - 1;

  if (m > n) return -1;
  if (m == 0) return 0;

  for (i = 0; i <= n1 - m + 1; i++) {
    a = *(bitint *)(ys + i);
    b = *(bitint *)(xs);
    c = a ^ b;
    c |= (c >> 1);
    c |= (c >> 2);
    c |= (c >> 4);
    c |= (c >> 8);
    c |= (c >> 16);
#ifdef MRB_64BIT
    c |= (c >> 32);
#endif
    if ((c & MASK1) == 0) {
      if (xs[m - 1] == ys[i + m - 1]) {
        for (j = 1; j < m - 1; j++) {
          if (xs[j] != ys[i + j]) break;
        }
        if (j == m - 1) return i;
      }
    }
  }