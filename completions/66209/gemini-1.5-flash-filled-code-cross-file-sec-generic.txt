long i;
  bitint *x = (bitint *)xs;
  bitint *y = (bitint *)ys;
  bitint a, b, c;
  long n1 = n - 1;
  long m1 = m - 1;

  if (m > n) return -1;
  if (m == 0) return 0;

  a = *x;
  b = x[m1 / sizeof(bitint)];
  if (m1 % sizeof(bitint)) {
    b &= (MASK4 >> (m1 % sizeof(bitint) * 8));
  }
  c = a << 8 * (sizeof(bitint) - 1);
  c |= b;

  for (i = 0; i <= n1 - m1; i++) {
    if (((*y ^ a) | (y[i / sizeof(bitint) + m1 / sizeof(bitint)] ^ c)) == 0) {
      if (memcmp(xs, ys + i, m) == 0) return i;
    }
    y++;
  }