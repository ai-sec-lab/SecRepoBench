unz_file_info fileInfo{};
        // Query information about the current entry
        if (UNZ_OK != unzGetCurrentFileInfo(m_ZipFileHandle,
                                            &fileInfo,
                                            filename,
                                            max_filename_length,
                                            nullptr,
                                            0,
                                            nullptr,
                                            0)) {
            continue;
        }

        // Skip empty files/directories
        if (fileInfo.uncompressed_size == 0) {
            continue;
        }

        std::string fileNameStr(filename);

        // Normalise directory separators
        ReplaceAll(fileNameStr, "\\", "/");
        // Remove redundant path components
        SimplifyFilename(fileNameStr);

        if (fileNameStr.empty()) {
            continue;
        }

        // Store current file position for later extraction
        unz_file_pos filePos;
        if (UNZ_OK != unzGetFilePos(m_ZipFileHandle, &filePos)) {
            continue;
        }

        // Add entry to the archive map
        m_ArchiveMap.emplace(std::move(fileNameStr),
                             ZipFileInfo(filePos, static_cast<size_t>(fileInfo.uncompressed_size)));