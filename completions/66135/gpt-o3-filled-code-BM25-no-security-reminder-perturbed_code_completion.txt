char
            buffer[MagickPathExtent];

          char
            *value;

          (void) memset(buffer,0,sizeof(buffer));
          value=(char *) NULL;
          /*
            Validate pointer bounds before we attempt to dereference it.
          */
          if ((p < exif_data) || (p > (exif_data+length-(size_t) number_bytes)))
            break;
          /*
            Insure the format is within our expected range.
          */
          if ((format == 0) || (format > EXIF_NUM_FORMATS))
            break;