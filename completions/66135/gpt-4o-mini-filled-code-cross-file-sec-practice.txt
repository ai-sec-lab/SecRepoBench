// Initialize a buffer to store formatted property values and a pointer for the value.
          char *value = NULL;
          size_t buffer_size = number_bytes + 1; // +1 for null terminator
          
          // Check if the pointer `p` is within the bounds of the EXIF data to prevent buffer overflow.
          if (p < exif || p > (exif + length - number_bytes)) {
              break; // Out of bounds, exit the loop
          }

          // If the format is not valid, break the loop.
          if (format >= sizeof(tag_bytes) / sizeof(*tag_bytes)) {
              break; // Invalid format, exit the loop
          }

          // Reset the buffer and initialize the value pointer to NULL.
          value = (char *)AcquireQuantumMemory(buffer_size, sizeof(*value));
          if (value == NULL) {
              break; // Memory allocation failed, exit the loop
          }

          // Fill the buffer with the property values
          for (i = 0; i < (ssize_t)number_bytes; i++) {
              value[i] = (isprint((int)p[i]) != 0) ? (char)p[i] : '.';
          }
          value[number_bytes] = '\0'; // Null-terminate the string

          // Ensure that the value is properly encoded to prevent XSS attacks
          char *encoded_value = EncodeForOutput(value); // Assume this function exists for output encoding

          // Use the encoded value for further processing
          // (e.g., setting the image property or logging)
          if (encoded_value != NULL) {
              // Set the image property or perform other actions with encoded_value
              // ...

              // Clean up
              encoded_value = DestroyString(encoded_value);
          }
          value = DestroyString(value); // Clean up the original value