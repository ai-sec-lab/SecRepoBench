char buffer[MagickPathExtent];
          char *value = NULL;

          if ((p < exif) || (p > (exif + length - number_bytes)))
            break;  // Ensure p is within bounds to prevent buffer overflow

          // Initialize buffer and value pointer
          memset(buffer, 0, sizeof(buffer));
          value = NULL;

          // Check if the format is valid
          if (format >= EXIF_NUM_FORMATS || format == 0)
            break;  // Invalid format, break the loop