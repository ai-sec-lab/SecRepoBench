// Validate codec ID
    if (avctx->codec_id != AV_CODEC_ID_HYMT) {
        nb_slices = 1; // Default to a single slice
        slice_height = height; // Full height for a single slice
        slices_info_offset = 0; // No offset needed
    } else {
        // Validate buffer size for slices
        if (buf_size < sizeof(int) * 8) {
            return AVERROR_INVALIDDATA; // Not enough data for slice information
        }

        // Read number of slices and slice height
        nb_slices = AV_RL32(avpkt->data + 4); // Assuming slice count is stored at offset 4
        slice_height = AV_RL32(avpkt->data + 8); // Assuming slice height is stored at offset 8

        // Validate number of slices
        if (nb_slices <= 0 || nb_slices > MAX_SLICES) {
            return AVERROR_INVALIDDATA; // Invalid number of slices
        }

        // Validate slice height
        if (slice_height <= 0 || slice_height > height) {
            return AVERROR_INVALIDDATA; // Invalid slice height
        }

        // Calculate the offset for slice information
        slices_info_offset = sizeof(int) * 2; // Adjust based on where slice info starts
    }