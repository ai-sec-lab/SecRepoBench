if (avctx->codec_id == AV_CODEC_ID_HYMT) {
        /*  Layout (little-endian):
         *  [... encoded slices data ...][slice table][nb_slices (uint32_t)]
         *  slice table : nb_slices entries, each 8 bytes
         *                uint32_t  offset
         *                uint32_t  size
         */
        if (buf_size < 12)                           /* need at least one slice */
            return AVERROR_INVALIDDATA;

        nb_slices = AV_RL32(buf + buf_size - 4);     /* read number of slices */

        /* basic sanity checks */
        if (nb_slices <= 0 || nb_slices > height || nb_slices > INT_MAX / 8)
            return AVERROR_INVALIDDATA;

        slices_info_offset = buf_size - 4 - nb_slices * 8;

        /* slice table must lie inside the packet and not overlap the
         * optional Huffman table area at the beginning */
        if (slices_info_offset < (unsigned)table_size ||
            slices_info_offset >= (unsigned)buf_size)
            return AVERROR_INVALIDDATA;

        /* ensure the slice table exactly fits in the computed area */
        if (slices_info_offset + nb_slices * 8 != buf_size - 4)
            return AVERROR_INVALIDDATA;

        /* assume equal-height slices */
        if (height % nb_slices)
            return AVERROR_INVALIDDATA;
        slice_height = height / nb_slices;

        if (slice_height <= 0)
            return AVERROR_INVALIDDATA;
    } else {
        /* no explicit slice information â€“ decode as a single slice */
        nb_slices         = 1;
        slice_height      = height;
        slices_info_offset = 0;
    }