nb_slices = AV_RL32(avpkt->data + buf_size - 12);
slice_height = AV_RL32(avpkt->data + buf_size - 8);
slices_info_offset = AV_RL32(avpkt->data + buf_size - 4);

if (nb_slices == 0 || slice_height == 0 || slices_info_offset >= buf_size ||
    slices_info_offset + 8LL * nb_slices > buf_size ||
    height % slice_height != 0 || nb_slices > INT_MAX / 8 ||
    slice_height * nb_slices != height) {
    return AVERROR_INVALIDDATA;
}