nb_slices = AV_RL32(packet->data + buf_size - 8);
slice_height = AV_RL32(packet->data + buf_size - 4);
slices_info_offset = buf_size - 16 - nb_slices * 8;

if (nb_slices <= 0 || slice_height <= 0 ||
    (int64_t)nb_slices * slice_height > height ||
    slices_info_offset + nb_slices * 8 + 16 > buf_size) {
    return AVERROR_INVALIDDATA;
}