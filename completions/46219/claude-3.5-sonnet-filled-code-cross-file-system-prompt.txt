const char
  *profile;

size_t
  length;

StringInfo
  *profile_info;

profile=GetImageProfile(image,"icc",exception);
if (profile == (const char *) NULL)
  profile=GetImageProfile(image,"icm",exception);
if (profile == (const char *) NULL)
  return((const char *) NULL);
profile_info=(StringInfo *) profile;
length=GetStringInfoLength(profile_info);
if (length < 128)
  return((const char *) NULL);
#if defined(MAGICKCORE_LCMS_DELEGATE)
{
  cmsHPROFILE
    icc_profile;

  icc_profile=cmsOpenProfileFromMem(GetStringInfoDatum(profile_info),
    (cmsUInt32Number) length);
  if (icc_profile != (cmsHPROFILE) NULL)
    {
      char
        info[MagickPathExtent];

      cmsUInt32Number
        extent;

      (void) memset(info,0,sizeof(info));
      extent=MagickPathExtent-1;
      if ((cmsGetProfileInfoASCII(icc_profile,cmsInfoDescription,
            "en","US",info,extent) != 0) && (*info != '\0'))
        (void) SetImageProperty(image,"icc:description",info,exception);
      (void) memset(info,0,sizeof(info));
      if ((cmsGetProfileInfoASCII(icc_profile,cmsInfoManufacturer,
            "en","US",info,extent) != 0) && (*info != '\0'))
        (void) SetImageProperty(image,"icc:manufacturer",info,exception);
      (void) memset(info,0,sizeof(info));
      if ((cmsGetProfileInfoASCII(icc_profile,cmsInfoModel,"en",
            "US",info,extent) != 0) && (*info != '\0'))
        (void) SetImageProperty(image,"icc:model",info,exception);
      (void) memset(info,0,sizeof(info));
      if ((cmsGetProfileInfoASCII(icc_profile,cmsInfoCopyright,
            "en","US",info,extent) != 0) && (*info != '\0'))
        (void) SetImageProperty(image,"icc:copyright",info,exception);
      cmsCloseProfile(icc_profile);
    }
}
#endif
return(GetImageProperty(image,key,exception));