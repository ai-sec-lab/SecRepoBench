const StringInfo
    *profile;

  const unsigned char
    *datum;

  profile=GetImageProfile(image,"icc");
  if (profile == (StringInfo *) NULL)
    profile=GetImageProfile(image,"icm");
  if (profile == (StringInfo *) NULL)
    return((const char *) NULL);
  if (GetStringInfoLength(profile) < 128)
    return((const char *) NULL);  /* minimum ICC profile length */
#if defined(LCMS_VERSION)
  {
    cmsHPROFILE
      icc_profile;

    icc_profile=cmsOpenProfileFromMem(GetStringInfoDatum(profile),
      (cmsUInt32Number) GetStringInfoLength(profile));
    if (icc_profile != (cmsHPROFILE *) NULL)
    {
      char
        description[MagickPathExtent],
        manufacturer[MagickPathExtent],
        model[MagickPathExtent];

      cmsInfoType
        info_type;

      info_type=cmsInfoDescription;
      (void) memset(description,0,MagickPathExtent*sizeof(*description));
      if (cmsGetProfileInfoASCII(icc_profile,info_type,cmsNoLanguage,
            cmsNoCountry,description,MagickPathExtent) != 0)
        (void) SetImageProperty(image,"icc:description",(const char *)
          description,exception);
      info_type=cmsInfoManufacturer;
      (void) memset(manufacturer,0,MagickPathExtent*sizeof(*manufacturer));
      if (cmsGetProfileInfoASCII(icc_profile,info_type,cmsNoLanguage,
            cmsNoCountry,manufacturer,MagickPathExtent) != 0)
        (void) SetImageProperty(image,"icc:manufacturer",(const char *)
          manufacturer,exception);
      info_type=cmsInfoModel;
      (void) memset(model,0,MagickPathExtent*sizeof(*model));
      if (cmsGetProfileInfoASCII(icc_profile,info_type,cmsNoLanguage,
            cmsNoCountry,model,MagickPathExtent) != 0)
        (void) SetImageProperty(image,"icc:model",(const char *) model,
          exception);
      info_type=cmsInfoCopyright;
      datum=cmsReadTag(icc_profile,info_type);
      if (datum != (const unsigned char *) NULL)
        (void) SetImageProperty(image,"icc:copyright",(const char *) datum,
          exception);
      (void) cmsCloseProfile(icc_profile);
    }
  }
#endif
  datum=(const unsigned char *) GetStringInfoDatum(profile);
  if (key != (const char *) NULL)
    return((const char *) GetImageProperty(image,key,exception));
  return((const char *) NULL);