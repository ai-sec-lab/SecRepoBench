const StringInfo
    *profile;

  const unsigned char
    *info;

  size_t
    length;

  MagickBooleanType
    status;

  // Check if the image and key are valid
  assert(image != (Image *) NULL);
  assert(key != (const char *) NULL);

  // Retrieve the ICC profile from the image
  profile=GetImageProfile(image,"icc");
  if (profile == (StringInfo *) NULL)
    profile=GetImageProfile(image,"icm");
  if (profile == (StringInfo *) NULL)
    return((const char *) NULL);

  // Get the profile length and data
  length=GetStringInfoLength(profile);
  info=GetStringInfoDatum(profile);

  // Check if the profile length is sufficient
  if (length < 132)
    return((const char *) NULL);

  // If LCMS is defined, extract the ICC profile information
#if defined(LCMS)
  cmsHPROFILE
    icc_profile;

  icc_profile=cmsOpenProfileFromMem(info,(cmsUInt32Number) length);
  if (icc_profile == (cmsHPROFILE) NULL)
    return((const char *) NULL);

  // Extract and set the ICC profile properties
  if (LocaleCompare(key,"description") == 0)
    {
      char
        description[MagickPathExtent];

      status=cmsGetProfileInfoASCII(icc_profile,cmsInfoDescription,"en","US",
        description,sizeof(description));
      cmsCloseProfile(icc_profile);
      if (status == 0)
        return((const char *) NULL);
      (void) SetImageProperty(image,"icc:description",description,exception);
      return(GetImageProperty(image,"icc:description",exception));
    }
  else if (LocaleCompare(key,"manufacturer") == 0)
    {
      char
        manufacturer[MagickPathExtent];

      status=cmsGetProfileInfoASCII(icc_profile,cmsInfoManufacturer,"en","US",
        manufacturer,sizeof(manufacturer));
      cmsCloseProfile(icc_profile);
      if (status == 0)
        return((const char *) NULL);
      (void) SetImageProperty(image,"icc:manufacturer",manufacturer,exception);
      return(GetImageProperty(image,"icc:manufacturer",exception));
    }
  else if (LocaleCompare(key,"model") == 0)
    {
      char
        model[MagickPathExtent];

      status=cmsGetProfileInfoASCII(icc_profile,cmsInfoModel,"en","US",
        model,sizeof(model));
      cmsCloseProfile(icc_profile);
      if (status == 0)
        return((const char *) NULL);
      (void) SetImageProperty(image,"icc:model",model,exception);
      return(GetImageProperty(image,"icc:model",exception));
    }
  else if (LocaleCompare(key,"copyright") == 0)
    {
      char
        copyright[MagickPathExtent];

      status=cmsGetProfileInfoASCII(icc_profile,cmsInfoCopyright,"en","US",
        copyright,sizeof(copyright));
      cmsCloseProfile(icc_profile);
      if (status == 0)
        return((const char *) NULL);
      (void) SetImageProperty(image,"icc:copyright",copyright,exception);
      return(GetImageProperty(image,"icc:copyright",exception));
    }
  cmsCloseProfile(icc_profile);
#endif

  return((const char *) NULL);