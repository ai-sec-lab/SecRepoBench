const StringInfo
    *profile;

  size_t
    length;

  cmsHICCProfile
    icc_profile;

  profile=GetImageProfile(image,"icc");
  if (profile == (StringInfo *) NULL)
    profile=GetImageProfile(image,"icm");
  if (profile == (StringInfo *) NULL)
    return((const char *) NULL);
  length=GetStringInfoLength(profile);
  if (length < 128)
    return((const char *) NULL);
#if defined(LCMS_VERSION)
  icc_profile=cmsOpenProfileFromMem(GetStringInfoDatum(profile),(cmsUInt32Number)
    length);
  if (icc_profile != (cmsHICCProfile) NULL)
    {
      char
        *description,
        **manufacturer,
        **model,
        *copyright;

      description=cmsTakeProductDesc(icc_profile);
      if (description != (char *) NULL)
        {
          (void) SetImageProperty(image,"icc:description",description,exception);
          cmsFreeString(icc_profile,description);
         }
      manufacturer=cmsTakeManufacturer(icc_profile);
      if (manufacturer != (char **) NULL)
        {
          (void) SetImageProperty(image,"icc:manufacturer",*manufacturer,
            exception);
          cmsFreeString(icc_profile,*manufacturer);
          cmsFreeString(icc_profile,manufacturer);
        }
      model=cmsTakeModel(icc_profile);
      if (model != (char **) NULL)
        {
          (void) SetImageProperty(image,"icc:model",*model,exception);
          cmsFreeString(icc_profile,*model);
          cmsFreeString(icc_profile,model);
        }
      copyright=cmsTakeCopyright(icc_profile);
      if (copyright != (char *) NULL)
        {
          (void) SetImageProperty(image,"icc:copyright",copyright,exception);
          cmsFreeString(icc_profile,copyright);
        }
      cmsCloseProfile(icc_profile);
    }
#endif
  return(GetImageProperty(image,key,exception));