const StringInfo
    *profile;

  const unsigned char
    *info;

  size_t
    length;

  profile=GetImageProfile(image,"icc");
  if (profile == (StringInfo *) NULL)
    profile=GetImageProfile(image,"icm");
  if (profile == (StringInfo *) NULL)
    return((const char *) NULL);
  length=GetStringInfoLength(profile);
  if (length < 132)
    return((const char *) NULL);
  info=GetStringInfoDatum(profile);
#if defined(MAGICKCORE_LCMS_DELEGATE)
  {
    cmsHPROFILE
      icc_profile;

    icc_profile=cmsOpenProfileFromMem(info,(cmsUInt32Number) length);
    if (icc_profile != (cmsHPROFILE) NULL)
      {
        char
          name[MaxTextExtent];

        cmsUInt32Number
          intent;

        intent=cmsGetHeaderRenderingIntent(icc_profile);
        (void) FormatLocaleString(name,MaxTextExtent,"%s",
          CommandOptionToMnemonic(MagickIntentOptions,(ssize_t) intent));
        (void) SetImageProperty(image,"icc:rendering-intent",name,exception);
        cmsCloseProfile(icc_profile);
      }
  }
#endif
  return(GetImageProperty(image,key,exception));