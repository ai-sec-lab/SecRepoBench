{
            /*
              Parse pixel reference of the form  p{expression_x,expression_y}
              or  p[expression_x,expression_y] .
            */
            char
              start_brace,
              end_brace;

            /*
              Skip over the leading 'p'.
            */
            p++;
            if ((*p == '[') || (*p == '{'))
              {
                start_brace=*p;
                end_brace=(char) (start_brace == '[' ? ']' : '}');
                /*
                  Extract and evaluate the x sub-expression.
                */
                level=0;
                q=subexpression;
                for (p++; *p != '\0'; p++)
                {
                  if (*p == start_brace)
                    level++;
                  else if (*p == end_brace)
                    {
                      if (level == 0)
                        break;
                      level--;
                    }
                  if ((*p == ',') && (level == 0))
                    break;
                  *q++=(*p);
                }
                *q='\0';
                if (*subexpression != '\0')
                  {
                    alpha=FxEvaluateSubexpression(fx_info,pixchannel,x,y,
                      subexpression,&depth,&beta,exception);
                    point.x=alpha;
                  }
                /*
                  If a comma follows, extract and evaluate the y sub-expression.
                */
                if (*p == ',')
                  {
                    q=subexpression;
                    p++;  /* skip comma */
                    level=0;
                    for ( ; *p != '\0'; p++)
                    {
                      if (*p == start_brace)
                        level++;
                      else if (*p == end_brace)
                        {
                          if (level == 0)
                            break;
                          level--;
                        }
                      *q++=(*p);
                    }
                    *q='\0';
                    if (*subexpression != '\0')
                      {
                        beta=FxEvaluateSubexpression(fx_info,pixchannel,x,y,
                          subexpression,&depth,&alpha,exception);
                        point.y=beta;
                      }
                  }
                /* skip the closing brace */
                if (*p == end_brace)
                  p++;
              }
            if (*p == '.')
              p++;
          }