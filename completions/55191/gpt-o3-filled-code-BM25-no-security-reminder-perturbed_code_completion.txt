(rv &&
   /* does this dictionary entry qualify as the first compound part? */
   (
       /* the word itself has the proper compound flag                                             */
       (compoundflag && !words && !onlycpdrule &&
        TESTAFF(rv->astr, compoundflag, rv->alen)) ||

       /* it can be used only at the beginning of compounds                                         */
       (compoundbegin && (wordnum == 0) && !onlycpdrule &&
        TESTAFF(rv->astr, compoundbegin, rv->alen)) ||

       /* it can be used in the “middle” of compounds                                               */
       (compoundmiddle && wordnum && !words && !onlycpdrule &&
        TESTAFF(rv->astr, compoundmiddle, rv->alen)) ||

       /* the COMPOUNDRULE (defcpdtable) machinery                                                  */
       (!defcpdtable.empty() && onlycpdrule &&
        (((!words && !wordnum &&
           defcpd_check(&words, wnum, rv, rwords, 0))) ||
         (words &&
          defcpd_check(&words, wnum, rv, rwords, 0))))
   ) &&

   /* obey word-count and syllable limits                                                           */
   ( ((cpdwordmax == -1) || (wordnum + 1 < cpdwordmax)) ||
     ((cpdmaxsyllable != 0) && (numsyllable <= cpdmaxsyllable)) ) &&

   /* CHECKCOMPOUNDPATTERN – reject prohibited patterns unless already inside one                  */
   ( checkcpdtable.empty() || scpd != 0 ||
     (char_index < word.size() &&
      !cpdpat_check(word, char_index, rv, NULL, affixed)) ) &&

   /* do we allow duplicate roots next to each other?                                               */
   ( !checkcompounddup || !words || (rv != words[wnum]) ) &&

   /* CHECKCOMPOUNDPATTERN extra flag condition                                                    */
   ( scpd == 0 || checkcpdtable[scpd - 1].cond == FLAG_NULL ||
     TESTAFF(rv->astr, checkcpdtable[scpd - 1].cond, rv->alen) )
)