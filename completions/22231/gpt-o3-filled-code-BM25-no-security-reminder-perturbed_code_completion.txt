/* Use the embedded reference for this slice */
            slice->ref       = (char *)b->data;
            slice->ref_start = slice->hdr->ref_seq_start;
            slice->ref_end   = slice->hdr->ref_seq_start +
                               slice->hdr->ref_seq_span - 1;

            /* Sanity-check that the embedded reference is long enough */
            if (b->uncomp_size < slice->hdr->ref_seq_span) {
                hts_log_error("Embedded reference too small "
                              "(have %"PRId64", need %"PRId64") "
                              "at #%d:%"PRId64"-%"PRId64,
                              (int64_t)b->uncomp_size,
                              (int64_t)slice->hdr->ref_seq_span,
                              ref_id,
                              slice->hdr->ref_seq_start,
                              slice->hdr->ref_seq_start +
                              slice->hdr->ref_seq_span - 1);
                return -1;
            }