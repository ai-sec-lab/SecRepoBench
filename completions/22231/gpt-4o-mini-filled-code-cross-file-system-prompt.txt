if (b->uncomp_size < s->hdr->ref_seq_span) {
                hts_log_error("Embedded reference is smaller than expected at #%d:%"PRId64"-%"PRId64,
                              ref_id, s->hdr->ref_seq_start,
                              s->hdr->ref_seq_start + s->hdr->ref_seq_span - 1);
                return -1;
            }
            s->ref = b->data; // Assign the decompressed reference sequence
            s->ref_start = s->hdr->ref_seq_start;
            s->ref_end = s->hdr->ref_seq_start + s->hdr->ref_seq_span - 1;