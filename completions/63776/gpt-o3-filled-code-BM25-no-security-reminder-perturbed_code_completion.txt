{
                  /* number of bytes we have consumed for the current
                     entity up to this point                                      */
                  BITCODE_RL consumed
                      = (BITCODE_RL)(dat->byte - previous_byte_position);

                  /* store the (measured) size                                    */
                  obj->size = consumed & 0xFFFFFFFFu;

                  /* sanity-check: do not run beyond the announced section size   */
                  if (previous_byte_position + obj->size > previous_byte_position + size
                      || previous_byte_position + obj->size > dat->size)
                    {
                      LOG_ERROR ("Entity at 0x%zx exceeds buffer/section limits "
                                 "(size=%u, end=0x%zx/0x%x)\n",
                                 previous_byte_position, obj->size, dat->size,
                                 start + size);
                      return DWG_ERR_INVALIDDWG;
                    }

                  /* In the R_2_0b-R_11 formats each entity is followed by a
                     2-byte CRC and a 2-byte size field.  We just skip over
                     them here to stay in sync with the stream.  If they are
                     missing we simply continue without failing.                  */

                  /* skip CRC16 if present                                         */
                  if (dat->byte + 2 <= previous_byte_position + size
                      && dat->byte + 2 <= dat->size)
                    dat->byte += 2;

                  /* read the recorded size (RS) if available                      */
                  if (dat->byte + 2 <= previous_byte_position + size
                      && dat->byte + 2 <= dat->size)
                    {
                      BITCODE_RS recsize = bit_read_RS (dat);

                      /* warn on mismatch but keep the measured value              */
                      if ((BITCODE_RL)recsize != obj->size)
                        {
                          LOG_WARN ("Entity size mismatch: recorded=%d "
                                    "measured=%u at 0x%zx\n",
                                    recsize, obj->size, previous_byte_position);
                        }
                    }

                  /* Make sure we are byte-aligned                                 */
                  dat->bit = 0;
                }