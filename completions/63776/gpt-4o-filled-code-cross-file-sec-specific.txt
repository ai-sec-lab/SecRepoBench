{
  obj->size = bit_read_RL(dat);
  if (obj->size > (dat->size - dat->byte)) {
    LOG_ERROR("Object size %u exceeds available data size %zu", obj->size, dat->size - dat->byte);
    return DWG_ERR_INVALIDDWG;
  }
  if (obj->size < (dat->byte - oldpos)) {
    LOG_ERROR("Object size %u is less than the data read %zu", obj->size, dat->byte - oldpos);
    return DWG_ERR_INVALIDDWG;
  }
  if (obj->size > (dat->byte - oldpos)) {
    size_t unknown_size = obj->size - (dat->byte - oldpos);
    obj->unknown_bits = (uint8_t *)malloc(unknown_size);
    if (!obj->unknown_bits) {
      LOG_ERROR("Out of memory for unknown bits");
      return DWG_ERR_OUTOFMEM;
    }
    memcpy(obj->unknown_bits, &dat->chain[dat->byte], unknown_size);
    dat->byte += unknown_size;
    LOG_TRACE("Unknown data of size %zu extracted", unknown_size);
  }
}