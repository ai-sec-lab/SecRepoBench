if (dat->version < R_11)
                  {
                    if (obj->size > (BITCODE_RL)(dat->size - dat->byte))
                      {
                        LOG_ERROR ("Invalid object size %x > %" PRIuSIZE "\n",
                                   obj->size, dat->size - dat->byte);
                        obj->size = (BITCODE_RL)(dat->size - dat->byte);
                      }
                    if (obj->size > 0 && obj->size < (BITCODE_RL)(dat->byte - oldpos))
                      {
                        LOG_ERROR ("Invalid object size %x < %" PRIuSIZE "\n",
                                   obj->size, dat->byte - oldpos);
                        obj->size = (BITCODE_RL)(dat->byte - oldpos);
                      }
                    UNKNOWN_REMAINING (obj->size);
                  }
                else
                  {
                    size_t crc_start = dat->byte;
                    BITCODE_32 crc;
                    if (obj->size > (BITCODE_RL)(dat->size - dat->byte))
                      {
                        LOG_ERROR ("Invalid object size %x > %" PRIuSIZE "\n",
                                   obj->size, dat->size - dat->byte);
                        obj->size = (BITCODE_RL)(dat->size - dat->byte);
                      }
                    dat->byte += obj->size;
                    crc = bit_read_U32 (dat);
                    if (crc16_ccitt (crc_start, obj->size) != crc)
                      {
                        LOG_ERROR ("CRC mismatch %x != %x\n",
                                   crc16_ccitt (crc_start, obj->size), crc);
                      }
                    if (dat->byte != oldpos + obj->size + 4)
                      {
                        size_t offset = (oldpos + obj->size + 4) - dat->byte;
                        if (offset > 0)
                          {
                            LOG_TRACE ("skip %" PRIuSIZE " bytes\n", offset);
                            dat->byte += offset;
                          }
                        else
                          {
                            LOG_ERROR ("Invalid object size %" PRIuSIZE
                                       " < %" PRIuSIZE "\n",
                                       dat->byte, oldpos + obj->size + 4);
                            dat->byte = oldpos + obj->size + 4;
                          }
                      }
                    if (dat->byte - oldpos - 4 != obj->size)
                      {
                        size_t trailing_unknown_size = (dat->byte - oldpos - 4) - obj->size;
                        if (trailing_unknown_size > 0) {
                          obj->trailing_unknown = (char *)malloc(trailing_unknown_size);
                          if (obj->trailing_unknown) {
                            memcpy(obj->trailing_unknown, dat->buffer + oldpos + obj->size + 4, trailing_unknown_size);
                            obj->trailing_unknown_size = trailing_unknown_size;
                          } else {
                            LOG_WARN("Failed to allocate memory for trailing unknown data\n");
                          }
                        } else {
                          LOG_ERROR("Trailing unknown size is negative\n");
                        }
                      }
                  }