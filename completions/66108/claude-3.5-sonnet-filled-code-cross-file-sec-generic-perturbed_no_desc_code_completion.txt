if (remain < size) {
    if (!is_eos) {
        return GF_OK;
    }
    size = remain;
}

if (bytes_skipped) {
    if (ctx->opid) {
        GF_LOG(GF_LOG_WARNING, GF_LOG_MEDIA, ("[MP3Dmx] Skipping %d bytes to sync\n", bytes_skipped));
    }
    if (ctx->byte_offset != GF_FILTER_NO_BO)
        ctx->byte_offset += bytes_skipped;
}

if (size < 4) {
    GF_LOG(GF_LOG_ERROR, GF_LOG_MEDIA, ("[MP3Dmx] Invalid frame size %d\n", size));
    return GF_NON_COMPLIANT_BITSTREAM;
}