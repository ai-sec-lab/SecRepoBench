if (ctx->bytes_in_header) {
    u32 bytes_to_copy = (remain < 5 - ctx->bytes_in_header) ? remain : (5 - ctx->bytes_in_header);
    memcpy(ctx->hdr_store + ctx->bytes_in_header, start, bytes_to_copy);
    ctx->bytes_in_header += bytes_to_copy;

    if (ctx->bytes_in_header == 5) {
        u32 sc = GF_4CC(ctx->hdr_store[0], ctx->hdr_store[1], ctx->hdr_store[2], ctx->hdr_store[3]);
        if (sc == 0x000001) {
            sc_type = ctx->hdr_store[4];
            current = 0;
            forced_sc_type = sc_type;
            sc_type_forced = GF_TRUE;
            hdr_offset = 5;
            bytes_from_store = 5;
        } else {
            mpgviddmx_enqueue_or_dispatch(ctx, NULL, GF_TRUE, GF_FALSE);
            ctx->bytes_in_header = 0;
        }
    } else {
        break;
    }
} else {
    current = -1;
}