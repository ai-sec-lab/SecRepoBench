/* --------------------------------------------------------------
         * Extract and store the list of supported signature algorithms
         * -------------------------------------------------------------- */
        ja.client.num_signature_algorithms = (u_int16_t)sa_size;

#ifdef NDPI_COPY_SIGNATURE_ALGORITHMS
        /* Optional copy of the raw list in network order (if requested). */
        if(sa_size > 0) {
          size_t copy_len = sa_size * 2; /* each signature is 2 bytes   */
          copy_len        = ndpi_min(copy_len,
                                     sizeof(flow->protos.tls_quic.signature_algorithms));
          memcpy(flow->protos.tls_quic.signature_algorithms,
                 &packet->payload[sessoffset],
                 copy_len);
        }
#endif /* NDPI_COPY_SIGNATURE_ALGORITHMS */

        /* Build a printable string version (comma separated) that will be
         * logged later on. The string buffer has already been zeroed.      */
        id = 0;
        for(i = 0;
            i < (u_int32_t)sa_size &&                      /* number of algos   */
            (sessoffset + (int)i*2 + 1) < packet->payload_packet_len; /* bounds */
            i++, id += 2)
        {
          u_int16_t sig_algo = ntohs(*((u_int16_t*)
                                      &packet->payload[sessoffset + id]));

          /* Append to printable buffer */
          int rc = ndpi_snprintf(&ja.client.signature_algorithms_str[i*2],
                                 sizeof(ja.client.signature_algorithms_str) -
                                   (i*2),
                                 "%s%u",
                                 (i == 0) ? "" : ",",
                                 sig_algo);

          if(rc <= 0)
            break;
        }