// Handles the pre-behavior of LightWave envelopes by inserting additional keyframes
// for pre-defined behaviors such as OffsetRepeat, Repeat, and Oscillate. This involves
// calculating the time delta between keys and adjusting keyframe values accordingly.
// The logic uses the start time, end time, and value delta to calculate new keyframe
// positions and values, adapting to the pre-behavior type.
for (std::list<LWO::Envelope>::iterator it = envelopes.begin(); it!= envelopes.end(); ++it) {
    if ((*it).keys.empty()) continue;

    const double my_first = (*it).keys.front().time;
    const double my_last = (*it).keys.back().time;

    const double delta = my_last - my_first;

    if ((*it).pre == LWO::PrePostBehaviour_OffsetRepeat) {
        // Insert additional keyframes for OffsetRepeat behavior
        double offset = (*it).keys.back().value;
        for (double t = my_first; t < my_last; t += delta / 10.0) {
            LWO::Key key;
            key.time = t;
            key.value = offset;
            (*it).keys.push_back(key);
        }
    } else if ((*it).pre == LWO::PrePostBehaviour_Repeat) {
        // Insert additional keyframes for Repeat behavior
        double repeat_value = (*it).keys.back().value;
        for (double t = my_first; t < my_last; t += delta / 10.0) {
            LWO::Key key;
            key.time = t;
            key.value = repeat_value;
            (*it).keys.push_back(key);
        }
    } else if ((*it).pre == LWO::PrePostBehaviour_Oscillate) {
        // Insert additional keyframes for Oscillate behavior
        double oscillate_value = (*it).keys.back().value;
        double oscillate_amplitude = (*it).keys.back().value * 0.1;
        for (double t = my_first; t < my_last; t += delta / 10.0) {
            LWO::Key key;
            key.time = t;
            key.value = oscillate_value + oscillate_amplitude * sin(2 * M_PI * (t - my_first) / delta);
            (*it).keys.push_back(key);
        }
    }
}