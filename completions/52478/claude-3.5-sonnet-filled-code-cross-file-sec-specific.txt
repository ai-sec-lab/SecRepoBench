switch ((*it).pre) {
    case LWO::PrePostBehaviour_OffsetRepeat:
    case LWO::PrePostBehaviour_Repeat:
    case LWO::PrePostBehaviour_Oscillate:
        {
            const double value_delta = (*it).keys.back().value - (*it).keys.front().value;
            const size_t num_keys = (*it).keys.size();
            std::vector<LWO::Key> new_keys;

            while ((*it).keys.front().time > first) {
                for (size_t i = 0; i < num_keys; ++i) {
                    LWO::Key new_key = (*it).keys[i];
                    new_key.time -= delta;

                    if ((*it).pre == LWO::PrePostBehaviour_OffsetRepeat) {
                        new_key.value -= value_delta;
                    } else if ((*it).pre == LWO::PrePostBehaviour_Oscillate && (new_keys.size() / num_keys) % 2 == 1) {
                        new_key.value = (*it).keys[num_keys - 1 - i].value;
                    }

                    if (new_key.time >= first) {
                        new_keys.push_back(new_key);
                    }
                }
            }

            (*it).keys.insert((*it).keys.begin(), new_keys.rbegin(), new_keys.rend());
            (*it).old_first = new_keys.size();
        }
        break;

    default:
        // No pre-behavior modification needed
        break;
}