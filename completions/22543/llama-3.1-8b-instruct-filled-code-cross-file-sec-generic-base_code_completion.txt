case 0:
{
  if (jp2_image->numcomps == 1)
    {
      SetPixelGray(image,ClampToQuantum(pixel),q);
      SetPixelAlpha(image,OpaqueAlpha,q);
      break;
    }
  scale = (double) (((size_t) 1UL << jp2_image->comps[0].prec)-1)/QuantumRange;
  if (jp2_image->color_space == 2)
    {
      SetPixelGray(image,ClampToQuantum(pixel),q);
      SetPixelAlpha(image,OpaqueAlpha,q);
    }
  else
    {
      SetPixelRed(image,ClampToQuantum(pixel),q);
      SetPixelGreen(image,ClampToQuantum(pixel),q);
      SetPixelBlue(image,ClampToQuantum(pixel),q);
      SetPixelAlpha(image,OpaqueAlpha,q);
    }
  break;
}
case 1:
{
  if (jp2_image->numcomps == 2)
    {
      SetPixelAlpha(image,ClampToQuantum(pixel),q);
      break;
    }
  scale = (double) (((size_t) 1UL << jp2_image->comps[1].prec)-1)/QuantumRange;
  SetPixelGreen(image,ClampToQuantum(pixel),q);
  break;
}
case 2:
{
  scale = (double) (((size_t) 1UL << jp2_image->comps[2].prec)-1)/QuantumRange;
  SetPixelBlue(image,ClampToQuantum(pixel),q);
  break;
}
case 3:
{
  scale = (double) (((size_t) 1UL << jp2_image->comps[3].prec)-1)/QuantumRange;
  SetPixelAlpha(image,ClampToQuantum(pixel),q);
  break;
}