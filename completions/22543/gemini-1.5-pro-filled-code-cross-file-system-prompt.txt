scale=(double) (QuantumRange/((size_t) 1UL << jp2_image->comps[i].prec)-1));
        pixel=scale*(jp2_image->comps[i].sgnd == 1 ?
          (double) jp2_image->comps[i].data[y*
          jp2_image->comps[i].w+x]+(1UL << (jp2_image->comps[i].prec-1)) :
          (double) jp2_image->comps[i].data[y*jp2_image->comps[i].w+x]);