/*
          Compute scale factor and convert the component sample to Quantum
          intensity.  For signed data convert the signed range to an
          unsigned range before scaling.
        */
        scale=(double) QuantumRange/((double) (((size_t) 1UL <<
          jp2_image->comps[i].prec)-1));
        {
          register int
            *p;

          p=jp2_image->comps[i].data+(y/jp2_image->comps[i].dy*
            (ssize_t) image->columns/jp2_image->comps[i].dx+
            columnindex/jp2_image->comps[i].dx);
          pixel=(double) *p;
          if (jp2_image->comps[i].sgnd != 0)
            pixel+=(double) ((unsigned long) 1UL <<
              (jp2_image->comps[i].prec-1));
          pixel*=scale;
        }