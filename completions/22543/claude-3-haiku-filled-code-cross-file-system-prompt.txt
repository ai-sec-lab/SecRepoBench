scale = (double) (((size_t) 1UL << jp2_image->comps[i].prec)-1)/QuantumRange;
if (jp2_image->comps[i].sgnd)
  pixel = scale * (GetPixelChannel(image, i, p) + (1 << (jp2_image->comps[i].prec-1)));
else
  pixel = scale * GetPixelChannel(image, i, p);