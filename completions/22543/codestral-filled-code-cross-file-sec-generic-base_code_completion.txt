double scale = (double) QuantumRange / (((size_t) 1UL << jp2_image->comps[i].prec) - 1);
double pixel = jp2_image->comps[i].data[y * jp2_image->comps[0].w + x] * scale;
if (jp2_image->comps[i].sgnd)
  pixel += (((size_t) 1UL << (jp2_image->comps[i].prec - 1)));