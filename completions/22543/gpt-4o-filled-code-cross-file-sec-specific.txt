scale = (double) QuantumRange / ((1UL << jp2_image->comps[i].prec) - 1);
pixel = (double) jp2_image->comps[i].data[y * jp2_image->comps[i].w + x];
if (jp2_image->comps[i].sgnd != 0)
  pixel += (1UL << (jp2_image->comps[i].prec - 1));
pixel *= scale;