switch (i)
{
   case 0:
   {
     scale = (double) (((size_t) 1UL << jp2_image->comps[i].prec) - 1) / QuantumRange;
     if (jp2_image->numcomps == 1)
       {
         pixel = scale * GetPixelGray(image, p);
         SetPixelGray(image, ClampToQuantum(pixel), q);
         SetPixelAlpha(image, OpaqueAlpha, q);
         break;
       }
     pixel = scale * GetPixelRed(image, p);
     SetPixelRed(image, ClampToQuantum(pixel), q);
     pixel = scale * GetPixelGreen(image, p);
     SetPixelGreen(image, ClampToQuantum(pixel), q);
     pixel = scale * GetPixelBlue(image, p);
     SetPixelBlue(image, ClampToQuantum(pixel), q);
     SetPixelAlpha(image, OpaqueAlpha, q);
     break;
   }
   case 1:
   {
     scale = (double) (((size_t) 1UL << jp2_image->comps[i].prec) - 1) / QuantumRange;
     if (jp2_image->numcomps == 2)
       {
         pixel = scale * GetPixelAlpha(image, p);
         SetPixelAlpha(image, ClampToQuantum(pixel), q);
         break;
       }
     pixel = scale * GetPixelGreen(image, p);
     SetPixelGreen(image, ClampToQuantum(pixel), q);
     break;
   }
   case 2:
   {
     scale = (double) (((size_t) 1UL << jp2_image->comps[i].prec) - 1) / QuantumRange;
     pixel = scale * GetPixelBlue(image, p);
     SetPixelBlue(image, ClampToQuantum(pixel), q);
     break;
   }
   case 3:
   {
     scale = (double) (((size_t) 1UL << jp2_image->comps[i].prec) - 1) / QuantumRange;
     pixel = scale * GetPixelAlpha(image, p);
     SetPixelAlpha(image, ClampToQuantum(pixel), q);
     break;
   }
}