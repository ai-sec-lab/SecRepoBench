scale = (double)(((size_t)1UL << jp2_image->comps[i].prec) - 1) / QuantumRange;
        pixel = (double)(GetPixelValue(image, q, i) * scale);
        if (jp2_image->comps[i].sgnd) {
            pixel -= (1 << (jp2_image->comps[i].prec - 1));
        }