scale=(double) QuantumRange/((double) ((1UL << jp2_image->comps[i].prec)-
          (jp2_image->comps[i].sgnd != 0 ? 1 : 0)));
        pixel=scale*(jp2_image->comps[i].data[y*
          jp2_image->comps[i].w+x]+(jp2_image->comps[i].sgnd != 0 ? 1 : 0));