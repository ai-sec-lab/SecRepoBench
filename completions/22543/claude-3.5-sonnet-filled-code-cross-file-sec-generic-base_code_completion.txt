scale=(double) (QuantumRange/(((size_t) 1UL << jp2_image->comps[i].prec)-1));
pixel=scale*(jp2_image->comps[i].data[y*image->columns+x]);
if (jp2_image->comps[i].sgnd)
  pixel+=scale*((size_t) 1UL << (jp2_image->comps[i].prec-1));