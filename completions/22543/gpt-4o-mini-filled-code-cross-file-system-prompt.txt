scale=(double) QuantumRange/(double)((1U << jp2_image->comps[i].prec) - 1);
        pixel=(double) jp2_image->comps[i].data[y * jp2_image->comps[i].w + x];
        if (jp2_image->comps[i].sgnd)
          pixel -= (1 << (jp2_image->comps[i].prec - 1));
        pixel *= scale;