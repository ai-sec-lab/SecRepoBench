tail = head + len;
if (arraylength < len || arraylength < tail) {
  len = arraylength - head;
  if (len < 0) len = 0;
}