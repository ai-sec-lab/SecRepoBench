tail = head + len;
  if (tail > alen) len = alen - head;
  if (tail > alen) tail = alen;