hb_buffer_t *buf = hb_serialize_context_get_buffer (c);
if (unlikely (!buf)) return false;

VarRegionList *dest = hb_buffer_alloc (buf, sizeof (VarRegionList), &c->error);
if (unlikely (!dest)) return false;

dest->axis_count = src->axis_count;
dest->region_count = regionmapping.get_size ();

if (unlikely (hb_buffer_get_remaining (buf) < sizeof (VarRegionList))) {
  c->error = HB_SERIALIZE_CONTEXT_ERROR_BUFFER_TOO_SMALL;
  return false;
}

for (unsigned int i = 0; i < regionmapping.get_size (); i++) {
  hb_codepoint_t src_region = regionmapping.get_first (i);
  hb_codepoint_t dest_region = regionmapping.get_second (i);
  dest->regions[dest_region] = src->regions[src_region];
}

return true;