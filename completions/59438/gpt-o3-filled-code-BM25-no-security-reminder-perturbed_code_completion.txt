size_t		tm = 0;		/* tapemark counter */
	uint32_t	rl1, rl2;	/* record lengths (before/after) */
	const unsigned char *p = uc;

#define	MIN_REC_HDR	8		/* two 32-bit words */

	while (p + MIN_REC_HDR <= end_pointer) {
		/* fetch first length word (little endian) */
		rl1 = (uint32_t)p[0] |
		      ((uint32_t)p[1] << 8) |
		      ((uint32_t)p[2] << 16) |
		      ((uint32_t)p[3] << 24);
		p += 4;

		/* End-of-medium marker */
		if (rl1 == 0xffffffff)
			return 1;

		/* Tapemark ? */
		if (rl1 == 0) {
			/* tapemark is encoded as 0 length followed by 0 length */
			if (p + 4 > end_pointer)
				return 0;		/* truncated */
			rl2 = (uint32_t)p[0] |
			      ((uint32_t)p[1] << 8) |
			      ((uint32_t)p[2] << 16) |
			      ((uint32_t)p[3] << 24);
			p += 4;
			if (rl2 != 0)
				return 0;		/* mismatch */
			if (++tm == SIMH_TAPEMARKS)
				return 1;		/* enough evidence */
			continue;
		}

		/* Ensure record body present */
		if (p + rl1 + 4 > end_pointer)
			return 0;

		/* Skip over data */
		p += rl1;

		/* trailing length */
		rl2 = (uint32_t)p[0] |
		      ((uint32_t)p[1] << 8) |
		      ((uint32_t)p[2] << 16) |
		      ((uint32_t)p[3] << 24);
		p += 4;

		/* Validate complement length */
		if (rl1 != rl2)
			return 0;
	}
	return 0;