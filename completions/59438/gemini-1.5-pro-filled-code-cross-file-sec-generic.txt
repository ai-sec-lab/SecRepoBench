const unsigned char *ucp = uc;
	uint32_t l, l2;
	int records = 0, tapemarks = 0;

	while (ucp < ue) {
		l = getlen(ucp, ue);
		if (l == 0)
			return 0;	// Invalid length
		if (l == 0xFFFFFFFFU)
			break;		// EOM
		ucp += 4;
		if (ucp + l > ue)
			return 0;	// Incomplete record
		ucp += l;
		l2 = getlen(ucp, ue);
		if (l2 == 0)
			return 0;	// Invalid length
		if (l != l2)
			return 0;	// Length mismatch
		ucp += 4;
		records++;
		if (l == 0) {
			tapemarks++;
			if (tapemarks == SIMH_TAPEMARKS)
				break;	// Reached tapemark limit
		}
	}
	return records > 0 ? 1 : 0;	// Valid SIMH data found