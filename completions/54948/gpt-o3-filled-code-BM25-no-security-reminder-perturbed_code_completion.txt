/* Locate terminating quote while counting escape sequences */
            size_t slen = 0;
            const char *start = ctx->pos;
            while (ctx->pos < ctx->end) {
                if (*ctx->pos == '\\') {
                    /* escape sequence â€“ skip backslash and next char */
                    num_escapes++;
                    ctx->pos++;
                    if (ctx->pos >= ctx->end) {
                        PLIST_OSTEP_ERR("Unexpected end of input in escape sequence at offset %ld\n", ctx->pos - ctx->start);
                        plist_free_data(data);
                        ctx->err++;
                        goto err_out;
                    }
                    ctx->pos++;
                    continue;
                }
                if (*ctx->pos == quote_char) {
                    break;
                }
                ctx->pos++;
            }

            /* ensure a closing quote was found */
            if (ctx->pos >= ctx->end || *ctx->pos != quote_char) {
                PLIST_OSTEP_ERR("Missing terminating quote character at offset %ld\n", ctx->pos - ctx->start);
                plist_free_data(data);
                ctx->err++;
                goto err_out;
            }

            /* determine string length and allocate buffer */
            slen = ctx->pos - start;
            char *strbuf = (char *)malloc(slen + 1);
            if (!strbuf) {
                PLIST_OSTEP_ERR("Memory allocation failure when parsing string\n");
                plist_free_data(data);
                ctx->err++;
                goto err_out;
            }

            /* move past the closing quote for subsequent parsing */
            ctx->pos++;