const char *e;
int val;

if (mrb_read_int(mrb, p, end, &val, &e) != MRB_OK) {
  return NULL;
}

*valp = val;
return e;