const char *e = p;
if (p < end && isdigit((unsigned char)*p)) {
  *valp = mrb_read_int(mrb, &p, end);
  e = p;
} else {
  return NULL;
}