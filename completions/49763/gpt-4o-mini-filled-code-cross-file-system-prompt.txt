for (i = xd; i-- > 0; ) {
    mp_dbl_limb qhat = (x.p[i] / z) + 1; // trial quotient
    mpz_t temp;
    mpz_init(mrb, &temp);
    mpz_mul_int(mrb, &temp, yy, qhat);
    while (mpz_cmp(mrb, &temp, &x) > 0) {
      qhat--;
      mpz_mul_int(mrb, &temp, yy, qhat);
    }
    mpz_sub(mrb, &x, &x, &temp); // update remainder
    q.p[i] = qhat; // update quotient
  }