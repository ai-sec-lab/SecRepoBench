for (i = 0; i < xd; i++) {
    // Calculate trial quotient (qhat)
    mp_dbl_limb qhat = (x.p[i + ns] / y.p[yd - 1]);
    mpz_t temp;

    // Initialize temporary variable for calculations
    mpz_init(mrb, &temp);
    mpz_set_int(mrb, &temp, qhat);
    
    // Multiply y by qhat and subtract from x
    mpz_t product;
    mpz_init(mrb, &product);
    mpz_mul(mrb, &product, &temp, yy);
    
    // Check if product is greater than x
    if (mpz_cmp(mrb, &product, &x) > 0) {
      qhat--;
      mpz_sub(mrb, &product, &product, yy);
    }

    // Update the quotient
    mpz_set_int(mrb, &q, qhat);
    mpz_sub(mrb, &x, &x, &product);
    
    // Store the quotient digit
    q.p[i] = qhat;

    // Clear temporary variables
    mpz_clear(mrb, &product);
    mpz_clear(mrb, &temp);
  }