// <MASK>
for (i = xd - yd; i >= 0; i--) {
  mp_dbl_limb qhat = (x.p[i + yd] * RADIX + x.p[i + yd - 1]) / z;
  mp_dbl_limb rhat = (x.p[i + yd] * RADIX + x.p[i + yd - 1]) - qhat * y.p[yd - 1];
  while (rhat < RADIX && qhat > 0) {
    qhat--;
    rhat += z;
  }
  mp_dbl_limb carry = 0;
  for (size_t j = 0; j < yd; j++) {
    mp_dbl_limb prod = qhat * y.p[j];
    mp_dbl_limb sum = x.p[i + j] - carry - (prod & RADIX_MASK);
    x.p[i + j] = sum;
    carry = (prod >> DIG_SIZE) + (sum > x.p[i + j]);
  }
  x.p[i + yd] -= carry;
  q.p[i] = qhat;
}