for (i = xd; i-- > 0;) {
    mp_dbl_limb qhat = (x.p[i] / z) + 1; // trial quotient
    mpz_t temp;
    mpz_init(mrb, &temp);
    mpz_realloc(mrb, &temp, yy->sz + 1);
    mpz_mul_int(mrb, &temp, yy, qhat);
    
    if (mpz_cmp(mrb, &temp, &x) > 0) {
      qhat--;
      mpz_sub(mrb, &temp, &temp, yy);
    }
    
    mpz_sub(mrb, &x, &x, &temp);
    mpz_set_int(mrb, &q, qhat);
  }