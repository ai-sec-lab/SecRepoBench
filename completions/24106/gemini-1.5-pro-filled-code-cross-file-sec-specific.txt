mvg_class = graphic_context[n]->id;
if (mvg_class != (char *) NULL && strlen(token) > 1) {
    if (LocaleCompare(token, mvg_class) == 0) {
        break;
    }
}

const char *class_def = (const char *)GetValueFromSplayTree(macros, token);
if (class_def != (const char *) NULL) {
    size_t new_extent = strlen(class_def) + strlen(q) + 1;
    char *new_primitive = (char *)AcquireQuantumMemory(new_extent, sizeof(char));

    if (new_primitive == (char *) NULL) {
        status = MagickFalse;
        break;
    }

    (void) memcpy(new_primitive, class_def, strlen(class_def));
    (void) memcpy(new_primitive + strlen(class_def), q, strlen(q) + 1);

    primitive=DestroyString(primitive);
    primitive = new_primitive;
    q = primitive + strlen(class_def);
}