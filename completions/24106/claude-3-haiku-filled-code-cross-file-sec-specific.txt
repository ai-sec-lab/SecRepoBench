// Check if the current token matches the graphic context ID, break if true.
if (LocaleCompare(token, graphic_context[n]->id) == 0) {
    break;
}

// Retrieve the MVG class definition from the macros using the token.
const char *mvg_class = (const char *)GetValueFromSplayTree(macros, token);

// If the class definition is found, inject the class elements into the stream at the current offset.
if (mvg_class != NULL) {
    // Concatenate the MVG class to the elements string, followed by the remaining content.
    char *new_primitive = (char *)malloc(strlen(primitive) + strlen(mvg_class) + 1);
    sprintf(new_primitive, "%s%s", mvg_class, q);
    // Free the previous primitive string and update it with the new elements.
    primitive = DestroyString(primitive);
    primitive = new_primitive;
    // Adjust the stream pointer to the new position in the modified primitive.
    q = primitive + strlen(mvg_class);
}