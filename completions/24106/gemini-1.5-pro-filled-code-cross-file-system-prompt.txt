mvg_class = GetValueFromSplayTree(macros, token);
            if (mvg_class != (const char *) NULL)
            {
                char *elements = (char *) NULL;
                const char *end = q;

                if (graphic_context[n]->id != (char *) NULL && LocaleCompare(graphic_context[n]->id, token) == 0)
                    break;

                if (depth >= MagickMaxRecursionDepth)
                {
                    status = MagickFalse;
                    break;
                }

                elements = AcquireString(mvg_class);
                if (elements == (char *) NULL)
                {
                    status = MagickFalse;
                    break;
                }

                size_t newSize = strlen(elements) + strlen(end) + 1;
                char *newPrimitive = (char *) AcquireQuantumMemory(newSize, sizeof(char));

                if (newPrimitive == (char *) NULL)
                {
                    elements = DestroyString(elements);
                    status = MagickFalse;
                    break;
                }

                strcpy(newPrimitive, elements);
                strcat(newPrimitive, end);

                elements = DestroyString(elements);
                primitive = DestroyString(primitive);
                primitive = newPrimitive;
                primitive_extent = (double) strlen(primitive);
                q = primitive + strlen(mvg_class);
            }