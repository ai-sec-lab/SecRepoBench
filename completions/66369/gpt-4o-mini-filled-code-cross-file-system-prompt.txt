if (aux[0] == 'R' && aux[1] == 'G') {
            // Handle RG:Z tag
            const char *rg = sam_hdr_line_name(fd->header, "RG", aux + 3);
            if (rg) {
                // Append RG tag to the TD block
                BLOCK_APPEND(td_b, aux, 3);
                BLOCK_APPEND(td_b, rg, strlen(rg));
                BLOCK_APPEND_CHAR(td_b, '\0');
                cr->aux_size += 3 + strlen(rg) + 1;
            } else {
                // Log warning if RG tag is missing
                hts_log_warning("Missing RG tag for read");
            }
        } else if (aux[0] == 'M' && aux[1] == 'D') {
            // Handle MD:Z tag
            BLOCK_APPEND(td_b, aux, 3);
            BLOCK_APPEND(td_b, MD->s, MD->l);
            BLOCK_APPEND_CHAR(td_b, '\0');
            cr->aux_size += 3 + MD->l + 1;
        } else if (aux[0] == 'N' && aux[1] == 'M') {
            // Handle NM:i tag
            BLOCK_APPEND(td_b, aux, 3);
            BLOCK_APPEND_INT(td_b, NM);
            cr->aux_size += 3 + 4; // 4 bytes for integer
        } else {
            // Unknown tag, log warning
            hts_log_warning("Unknown auxiliary tag: %.2s", aux);
        }