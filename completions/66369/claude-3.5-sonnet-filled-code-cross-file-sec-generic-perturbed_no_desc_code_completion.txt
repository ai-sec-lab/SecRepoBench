if (aux[0] == 'R' && aux[1] == 'G' && aux[2] == 'Z') {
    char *rg = (char *)aux + 3;
    khint_t k;
    int new;
    k = kh_put(m_s2i, c->comp_hdr->RG_hash, rg, &new);
    if (new < 0)
        goto err;
    if (new) {
        kh_val(c->comp_hdr->RG_hash, k) = c->comp_hdr->nRG;
        c->comp_hdr->nRG++;
    }
    brg = &c->comp_hdr->RG[kh_val(c->comp_hdr->RG_hash, k)];
}

if (aux[0] == 'R' && aux[1] == 'G' && aux[2] == 'Z') {
    tm = &s->aux_block[CRAM_aux_RG];
} else {
    tm = &s->aux_block[CRAM_aux];
}

r |= cram_store_tag(c, s, tm, aux, aux_end - aux);
if (r)
    goto err;

aux += 3;
while (aux[0] && aux < aux_end) {
    while (*aux && aux < aux_end)
        aux++;
    aux++;
}