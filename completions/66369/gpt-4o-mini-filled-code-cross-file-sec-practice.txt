// Process auxiliary tags
        while (aux_end - aux >= 3) {
            char tag[3];
            char type;
            int data_size = 0;

            // Read the tag
            memcpy(tag, aux, 2);
            tag[2] = '\0';
            type = aux[2];

            // Determine the size of the data based on the type
            switch (type) {
                case 'Z': // String
                case 'H': // Hex string
                    while (aux_end - aux > 0 && aux[3 + data_size] != '\0') {
                        data_size++;
                    }
                    data_size++; // Include null terminator
                    break;
                case 'i': // Integer
                case 'f': // Float
                    data_size = sizeof(int32_t);
                    break;
                case 'c': // Character
                    data_size = sizeof(char);
                    break;
                case 'B': // Array
                    data_size = *(aux + 3) * sizeof(int32_t); // Assuming int32_t for simplicity
                    break;
                default:
                    // Unknown type, skip
                    aux += 3; // Move past the tag
                    continue;
            }

            // Validate the size
            if (aux_end - aux < 3 + data_size) {
                hts_log_error("Insufficient data for tag %s", tag);
                goto err;
            }

            // Process the tag based on its type
            if (strcmp(tag, "RG") == 0) {
                // Handle RG tag
                // Assuming we have a function to process RG tags
                process_rg_tag(aux + 3, data_size);
            } else if (strcmp(tag, "MD") == 0) {
                // Handle MD tag
                // Assuming we have a function to process MD tags
                process_md_tag(aux + 3, data_size);
            } else if (strcmp(tag, "NM") == 0) {
                // Handle NM tag
                // Assuming we have a function to process NM tags
                process_nm_tag(aux + 3, data_size);
            }

            // Move to the next tag
            aux += 3 + data_size;
        }