if (aux[0] == 'R' && aux[1] == 'G' && aux[2] == 'Z') {
    if (!(brg = sam_hdr_find_rg(filedescriptor->header, (const char *)(aux+3))))
        hts_log_warning("RG:Z: '%s' not found in header", aux+3);
}

if ((r = cram_stats_add(c->stats[DS_aux], aux[0]<<16|aux[1]<<8|aux[2])) < 0)
    goto block_err;

if (r >= c->stats[DS_aux]->nvals)
    BLOCK_GROW(td_b, r-TD_blk_size+1);

cram_codec *codec = c->comp_hdr->codecs[DS_aux][r];
if (!codec) {
    codec = cram_encoder_init(cram_stats_encoding(c->stats[DS_aux]), 
                              c->stats[DS_aux], CRAM_MAJOR_VERS(filedescriptor->version));
    if (!codec)
        goto block_err;
    c->comp_hdr->codecs[DS_aux][r] = codec;
}

if (codec->store(codec, aux+3, aux_end - aux-3) < 0)
    goto block_err;

// Update slice and container metrics
s->aux_size += aux_end - aux;
c->aux_size += aux_end - aux;

aux = aux_end;