if (aux[0] == 'R' && aux[1] == 'G') {
    if (!(brg = sam_hrecs_find_rg(fd->header->hrecs, (char *)aux+3)))
        goto err;
}

if ((r = cram_stats_add(c->stats[DS_aux], aux[0]<<16|aux[1]<<8|aux[2])) < 0)
    goto block_err;

if (!(tm = map_find(c->comp_hdr->tag_encoding_map, aux, r))) {
    if (!(tm = calloc(1, sizeof(*tm))))
        goto block_err;
    tm->key = (aux[0]<<16)|(aux[1]<<8)|aux[2];

    // Add tag map for encoding
    if (map_put(c->comp_hdr->tag_encoding_map, aux, r, tm) < 0)
        goto err;

    // Add tag id to decoder
    if (cram_codec_to_id(c, aux, r) < 0)
        goto err;

    tm->codec = cram_encoder_init(cram_stats_encoding(c->stats[DS_aux]),
                                  c->stats[DS_aux], E_INT, NULL,
                                  fd->version);
    if (!tm->codec)
        goto block_err;

    if (tm->codec->store(tm->codec, aux+3, aux_size-3) < 0)
        goto err;
}

if (tm->codec->store(tm->codec, aux+3, aux_size-3) < 0)
    goto err;

// Append to aux block
BLOCK_APPEND(s->aux_blk, aux, aux_size);