for (i = 0; i < Tables->nCurves; i++) {
        if (Tables->TheCurves[i] == NULL || Tables->TheCurves[i]->nEntries == 0) {
            cmsSignalError(ContextID, cmsERROR_RANGE, "Invalid curve data");
            return FALSE;
        }

        nEntries = Tables->TheCurves[i]->nEntries;

        for (j = 0; j < nEntries; j++) {
            val = Tables->TheCurves[i]->Table16[j];

            // Ensure the value is within the valid range for 16-bit unsigned integers
            if (val > 65535) {
                cmsSignalError(ContextID, cmsERROR_RANGE, "Value out of range for 16-bit integer");
                return FALSE;
            }

            // Write the 16-bit value to the io handler
            if (!_cmsWriteUInt16Number(io, val)) {
                cmsSignalError(ContextID, cmsERROR_WRITE, "Failed to write 16-bit value");
                return FALSE;
            }
        }
    }