for (j = 0; j < Tables->nStages; j++) {
    nEntries = Tables->TheCurves[j]->nEntries;

    if (nEntries > 0xFFFF) {
        return FALSE;  // Prevent integer overflow
    }

    for (index = 0; index < nEntries; index++) {
        val = Tables->TheCurves[j]->Table16[index];
        if (!_cmsWriteUInt16Number(io, val)) {
            return FALSE;
        }
    }
}