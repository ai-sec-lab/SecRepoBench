// This code block implements a function that converts a string to a floating-point number.
// It handles parsing the string, removing underscores, and dealing with whitespace and special cases.
// It checks for invalid inputs and raises an error if the string is not a valid number when `badcheck` is true.
// The function also handles hexadecimal input prefixed with "0x" or "0X" and attempts to parse it as an integer.
// The code handles leading and trailing spaces and underscores, and ensures the resulting number is correctly formatted.