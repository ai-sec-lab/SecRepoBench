// Determine the reference pixel for current pixel based on color and motion vectors.
// For red or blue pixels, use the same color two lines up, while for green pixels,
// use the pixel from the line directly above, either top-left or top-right depending
// on its position. Adjust the reference pixel based on the slideOffset.
// Optionally, average the reference pixel with its neighbor if required by doAverage.