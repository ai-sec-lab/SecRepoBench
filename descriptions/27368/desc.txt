// Allocate a buffer for the compressed output data based on the input data size.
// Initialize a z_stream structure to manage the state of the compression process.
// Configure the stream for deflate compression and include manual handling for
// gzip formatting since the library in use does not support gzip directly.
// Add the gzip header to the output buffer, then perform the compression of
// the input data into the output buffer using a loop to manage the streaming
// nature of the deflate process. Check for completion or errors throughout the
// process. Once the compression is finished, finalize the deflate operation.
// Append a CRC32 checksum and the original data length as a footer to the output
// buffer to complete the gzip format. Set the output buffer and size for use by
// the caller and return a success status.