// The function `get_ndpi_flow_info` processes IP packets for network flow identification and statistics collection.
// It calculates the flow hash based on IP addresses and ports, searches for an existing flow, and creates a new flow if none is found.
// The function also handles both IPv4 and IPv6 packets by setting the appropriate header offsets and lengths.
// It determines the protocol type and processes TCP, UDP, and ICMP packets, extracting necessary fields like source and destination ports.
// Network flows are managed using a binary search tree to track packet counts, payload lengths, and entropy metrics.
// The function returns an existing or newly created flow record, with updated statistics and direction of the packet.